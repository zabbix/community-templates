zabbix_export:
  version: '6.0'
  date: '2021-11-21T22:07:15Z'
  groups:
    -
      uuid: a086b5c471b648ed844efc1d04c2a66d
      name: Templates/IOT
  templates:
    -
      uuid: 6b35a5790f0f40d483e1099edc8f1c80
      template: Shelly-1PM
      name: 'Shelly 1PM'
      description: |
        ## Overview
        
        Monitoring of almost all values the Shelly 1PM reports, except external sensors since I don't own one of those.
        
        
        It has a fixed update time of 60s for all values, which might not be enough for some usecases - feel free to adjust it.
        
        
        
        ## Author
        
        Leonard Winck
        
        
      groups:
        -
          name: Templates/IOT
      items:
        -
          uuid: f2c92f97ba5c403b9e7ee5cb1d32cf7a
          name: 'Status gatherer'
          type: HTTP_AGENT
          key: shelly1pm.status
          history: 30d
          trends: '0'
          value_type: TEXT
          authtype: BASIC
          username: admin
          password: '{$SHELLYPWD}'
          description: 'This gatherer gathers all the data for the different items from the Rest-API Interface of the Shelly device.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.body
          url: 'http://{HOST.IP}/status'
          follow_redirects: 'NO'
          output_format: JSON
          tags:
            -
              tag: Application
              value: Gatherer
          triggers:
            -
              uuid: cc43fbf1d68b44c086274e8620e608bc
              expression: 'nodata(/Shelly-1PM/shelly1pm.status,180s)=1'
              name: 'No data received for >3m'
        -
          uuid: 4118062a9800467ea4808363297281bd
          name: 'Actions Skipped Count'
          type: DEPENDENT
          key: shelly1pm.status.actions_stats.skipped
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..actions_stats.skipped
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 0b963dc7d2d1418b9855fa9441f04736
              expression: change(/Shelly-1PM/shelly1pm.status.actions_stats.skipped)>0
              recovery_mode: NONE
              name: 'At least one action has been skipped'
              priority: WARNING
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 1bba7af2aec84b41b1f2a5d0e781d355
          name: 'Configuration Changed Count'
          type: DEPENDENT
          key: shelly1pm.status.cfg_changed_cnt
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..cfg_changed_cnt
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 13c9b657f2f04cf68b01ba335d00883e
              expression: change(/Shelly-1PM/shelly1pm.status.cfg_changed_cnt)>0
              recovery_mode: NONE
              name: 'System configuration has been changed'
              priority: INFO
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: b7ee124325c94112927be0471dad703d
          name: 'Cloud Connection State'
          type: DEPENDENT
          key: shelly1pm.status.cloud.connected
          delay: '0'
          valuemap:
            name: 'Shelly Connection State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..cloud.connected
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Cloud
          triggers:
            -
              uuid: 7deba987ce0744f98de0a55d782f8058
              expression: change(/Shelly-1PM/shelly1pm.status.cloud.connected)<>0
              recovery_mode: NONE
              name: 'Cloud connection state has changed'
              priority: WARNING
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 36918d26bd4c4986b20cb69d466ccece
          name: 'Cloud Configured State'
          type: DEPENDENT
          key: shelly1pm.status.cloud.enabled
          delay: '0'
          valuemap:
            name: 'Shelly Enabled State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..cloud.enabled
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Cloud
          triggers:
            -
              uuid: 62e57e9f314842788a67c58c1e6e7d23
              expression: change(/Shelly-1PM/shelly1pm.status.cloud.enabled)<>0
              recovery_mode: NONE
              name: 'Cloud configuration has changed'
              priority: INFO
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 6fc663314c6745d0b06f746455e0b021
          name: 'Filesystem Free'
          type: DEPENDENT
          key: shelly1pm.status.fs_free
          delay: '0'
          units: b
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..fs_free
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: ec3c3689070d45b6ad0130d54af2a4e1
          name: 'Filesystem Total'
          type: DEPENDENT
          key: shelly1pm.status.fs_size
          delay: '0'
          units: b
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..fs_size
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 9c0aa425b62d4124a0e0a68adf7053c6
          name: 'Input Event'
          type: DEPENDENT
          key: shelly1pm.status.inputs0.event
          delay: '0'
          valuemap:
            name: 'Shelly Input Event'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..inputs[0].event'
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "S") {
                  return 0 ;
                  } else if (value == "L") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Input
        -
          uuid: 5a637771d5714d43a92dd44c772d7d8c
          name: 'Input Event Count'
          type: DEPENDENT
          key: shelly1pm.status.inputs0.event_cnt
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..inputs[0].event_cnt'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Input
        -
          uuid: 5dd1f3739dca41e8aab21f43b40afdb1
          name: 'Input State'
          type: DEPENDENT
          key: shelly1pm.status.inputs0.input
          delay: '0'
          valuemap:
            name: 'Shelly On/Off State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..inputs[0].input'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Input
          triggers:
            -
              uuid: 177297d34ed14dfe8523a2e4f97b1c56
              expression: change(/Shelly-1PM/shelly1pm.status.inputs0.input)<>0
              recovery_mode: NONE
              name: 'Input state has changed'
              priority: INFO
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 2afc983ee20744ac8f2620e8b8db7a35
          name: 'MAC Address'
          type: DEPENDENT
          key: shelly1pm.status.mac
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: MACADDRESS_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..mac
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 62902c1b55d3417e99fd84a2268dca61
          name: 'Power Consumption (1m)'
          type: DEPENDENT
          key: shelly1pm.status.meters0.counters0
          delay: '0'
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..meters[0].counters[0]'
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - 'return value/60;'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Meters
        -
          uuid: ecc867720ed744118372b1064e6b0151
          name: 'Meters Self-Check State'
          type: DEPENDENT
          key: shelly1pm.status.meters0.is_valid
          delay: '0'
          valuemap:
            name: 'Shelly Status'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..meters[0].is_valid'
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "true") {
                  return 0 ;
                  } else if (value == "false") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Meters
          triggers:
            -
              uuid: 99eaa93101494cd09b468cd4a1535bd1
              expression: last(/Shelly-1PM/shelly1pm.status.meters0.is_valid)<>0
              name: 'Meters self-check is not ok'
        -
          uuid: 688bc4a69eff411d86ca8a35c1db527b
          name: 'Overpower Value'
          type: DEPENDENT
          key: shelly1pm.status.meters0.overpower
          delay: '0'
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..meters[0].overpower'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Meters
        -
          uuid: 10719c9d287d4896b3d17a0e2de6b5ee
          name: 'Current Power Consumption'
          type: DEPENDENT
          key: shelly1pm.status.meters0.power
          delay: '0'
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..meters[0].power'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Meters
        -
          uuid: fad48f3bba8f426eb3278371fd5c54d4
          name: 'Current Power Consumption Time'
          type: DEPENDENT
          key: shelly1pm.status.meters0.timestamp
          delay: '0'
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..meters[0].timestamp'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Meters
        -
          uuid: 40228e12edd64e44937b085f13f782aa
          name: 'Total Power Consumption'
          type: DEPENDENT
          key: shelly1pm.status.meters0.total
          delay: '0'
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..meters[0].total'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Meters
        -
          uuid: 6861cbad5de74ed999c70683fd9fd992
          name: 'MQTT Connection State'
          type: DEPENDENT
          key: shelly1pm.status.mqtt.connected
          delay: '0'
          valuemap:
            name: 'Shelly Connection State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..mqtt.connected
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: 955a875c62194877a3a17d0b9f7836b7
              expression: change(/Shelly-1PM/shelly1pm.status.mqtt.connected)<>0
              recovery_mode: NONE
              name: 'MQTT connection state has changed'
              priority: WARNING
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 69b1877f8e16488d8d61b29097199dc6
          name: 'Overheating State'
          type: DEPENDENT
          key: shelly1pm.status.overtemperature
          delay: '0'
          valuemap:
            name: 'Shelly Status'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..overtemperature
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Temperature
          triggers:
            -
              uuid: c905c804be7f43a3815cd58b3bec40ad
              expression: last(/Shelly-1PM/shelly1pm.status.overtemperature)=1
              name: 'Overheating event has been detected'
              priority: DISASTER
        -
          uuid: 7cd3ba559fa2497d8081a74eb0b9e162
          name: 'Memory Free'
          type: DEPENDENT
          key: shelly1pm.status.ram_free
          delay: '0'
          units: b
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ram_free
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 7a06a77e9e374fbf8b0415f4e9779373
          name: 'Memory Total'
          type: DEPENDENT
          key: shelly1pm.status.ram_total
          delay: '0'
          units: b
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ram_total
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 133ec05eb553479983953c9de8b0b29b
          name: 'Relay Timer State'
          type: DEPENDENT
          key: shelly1pm.status.relays0.has_timer
          delay: '0'
          valuemap:
            name: 'Shelly Enabled State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].has_timer'
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
        -
          uuid: 6ab6e915bc554865a7bdbb63deeac558
          name: 'Relay State'
          type: DEPENDENT
          key: shelly1pm.status.relays0.ison
          delay: '0'
          valuemap:
            name: 'Shelly On/Off State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].ison'
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
          triggers:
            -
              uuid: 99e5d1fdd52b4bbeaa2515b6b1e8648f
              expression: change(/Shelly-1PM/shelly1pm.status.relays0.ison)<>0
              recovery_mode: NONE
              name: 'Input state has changed'
              priority: WARNING
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 6618e893963d4ea4a13f21d5ec5f84ca
          name: 'Relay Overpower State'
          type: DEPENDENT
          key: shelly1pm.status.relays0.overpower
          delay: '0'
          valuemap:
            name: 'Shelly Status'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].overpower'
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
          triggers:
            -
              uuid: 766d5c87338741c4b0c1b4f6c13c7203
              expression: last(/Shelly-1PM/shelly1pm.status.relays0.overpower)=1
              name: 'Overpower event has been detected'
              priority: DISASTER
        -
          uuid: bdf2dc4f2a5c4b2090662ec820b6791c
          name: 'Relay Last Command Source'
          type: DEPENDENT
          key: shelly1pm.status.relays0.source
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].source'
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
        -
          uuid: 076d7dac7a1344e5840271afdc2e4da9
          name: 'Relay Timer Duration'
          type: DEPENDENT
          key: shelly1pm.status.relays0.timer_duration
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].timer_duration'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
        -
          uuid: 390b6aab63cd4d699bc2c5e007bb8506
          name: 'Relay Timer Remaining'
          type: DEPENDENT
          key: shelly1pm.status.relays0.timer_remaining
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].timer_remaining'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
        -
          uuid: d6109908ecf44cc7b7e306dff288ad54
          name: 'Relay Timer Started'
          type: DEPENDENT
          key: shelly1pm.status.relays0.timer_started
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..relays[0].timer_started'
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Relays
        -
          uuid: bf6d02cd68ac406ea4470aed7446538e
          name: 'Cloud Serial Number'
          type: DEPENDENT
          key: shelly1pm.status.serial
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..serial
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Cloud
        -
          uuid: 7d46337946f746e2993eca22724168e1
          name: 'Temperature Status'
          type: DEPENDENT
          key: shelly1pm.status.temperature_status
          delay: '0'
          valuemap:
            name: 'Shelly Temperature Status'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..temperature_status
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "Normal") {
                  return 0 ;
                  } else if (value == "High") {
                  return 1 ;
                  } else if (value == "Very High") {
                  return 2 ;
                  } else {
                  return 3 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Temperature
          triggers:
            -
              uuid: a68a65348f274a0c82bf28e2b132405a
              expression: last(/Shelly-1PM/shelly1pm.status.temperature_status)=1
              name: 'Device temperature is high'
              priority: AVERAGE
            -
              uuid: 62a21a774f57468fb23f2b0cbf38eb64
              expression: last(/Shelly-1PM/shelly1pm.status.temperature_status)=2
              name: 'Device temperature is very high'
              priority: HIGH
            -
              uuid: eb80045d77bd45dbb68a7d9b0131c36b
              expression: last(/Shelly-1PM/shelly1pm.status.temperature_status)=3
              name: 'Device temperature status is unknown'
        -
          uuid: aee44f450ada43eaa01ae5d10c078f96
          name: 'Current Time'
          type: DEPENDENT
          key: shelly1pm.status.time
          delay: '0'
          trends: '0'
          status: DISABLED
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..time
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: cd1549eeb0384438962ded97b60939ea
          name: 'Temperature Self-Check State'
          type: DEPENDENT
          key: shelly1pm.status.tmp.is_valid
          delay: '0'
          valuemap:
            name: 'Shelly Status'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..tmp.is_valid
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "true") {
                  return 0 ;
                  } else if (value == "false") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Temperature
          triggers:
            -
              uuid: ad90f6c6c7eb4177baae61554a91cbd5
              expression: last(/Shelly-1PM/shelly1pm.status.tmp.is_valid)<>0
              name: 'Temperature self-check is not ok'
        -
          uuid: cf2b4ea9ac894b03afb3062606039692
          name: 'Current Temperature'
          type: DEPENDENT
          key: shelly1pm.status.tmp.tC
          delay: '0'
          value_type: FLOAT
          units: Â°C
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..tmp.tC
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Temperature
        -
          uuid: 3ac21f6f94074dd5b3aa52bf7aaa3bfd
          name: 'Current Unixtime'
          type: DEPENDENT
          key: shelly1pm.status.unixtime
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..unixtime
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 7e57a0f22b69493494d554056f2b39fe
              expression: 'fuzzytime(/Shelly-1PM/shelly1pm.status.unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
        -
          uuid: d80660a812a045ef84f17f25371cdb9c
          name: 'Update Availability'
          type: DEPENDENT
          key: shelly1pm.status.update.has_update
          delay: '0'
          valuemap:
            name: 'Shelly Update Availability'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..update.has_update
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Update
          triggers:
            -
              uuid: 2b4d0a4ff25849dd8bb08b7f78094a27
              expression: last(/Shelly-1PM/shelly1pm.status.update.has_update)=1
              name: 'Update available'
              priority: INFO
        -
          uuid: e955d097863f4b4680649027025b0a67
          name: 'New Version Available'
          type: DEPENDENT
          key: shelly1pm.status.update.new_version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..update.new_version
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Update
        -
          uuid: 965a467527e94101b87235fded150bbf
          name: 'Current Version'
          type: DEPENDENT
          key: shelly1pm.status.update.old_version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..update.old_version
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Update
          triggers:
            -
              uuid: 92ac650586e146bea84485fcf999ecda
              expression: change(/Shelly-1PM/shelly1pm.status.update.old_version)<>0
              recovery_mode: NONE
              name: 'Version has changed'
              priority: WARNING
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 3833ffc398c043c0963adec573ef9944
          name: 'Update Status'
          type: DEPENDENT
          key: shelly1pm.status.update.status
          delay: '0'
          valuemap:
            name: 'Shelly Update Status'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..update.status
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "idle") {
                  return 0 ;
                  } else if (value == "pending") {
                  return 1 ;
                  } else if (value == "updating") {
                  return 2 ;
                  } else {
                  return 3 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: Update
        -
          uuid: 43c18abd4a874668b8bdfd678b3796a7
          name: Uptime
          type: DEPENDENT
          key: shelly1pm.status.uptime
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..uptime
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: b4bfe57dc57945e1a53de20fc911df23
              expression: last(/Shelly-1PM/shelly1pm.status.uptime)<600
              name: 'Device has been restarted (Uptime <10m)'
              priority: WARNING
        -
          uuid: a336fda98f33432eac1fc62e2bf9c251
          name: 'WiFi Connection State'
          type: DEPENDENT
          key: shelly1pm.status.wifi_sta.connected
          delay: '0'
          valuemap:
            name: 'Shelly Connection State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..wifi_sta.connected
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: JAVASCRIPT
              parameters:
                - |
                  if (value == "false") {
                  return 0 ;
                  } else if (value == "true") {
                  return 1 ;
                  } else {
                  return 2 ;
                  }
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: WiFi
        -
          uuid: 82c285e72b6e48cba353eb79b3a0a110
          name: 'WiFi IP'
          type: DEPENDENT
          key: shelly1pm.status.wifi_sta.ip
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..wifi_sta.ip
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: WiFi
        -
          uuid: 8853057d599c47bdacf0932eeefb0e4f
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: shelly1pm.status.wifi_sta.rssi
          delay: '0'
          value_type: FLOAT
          valuemap:
            name: 'Shelly Connection State'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..wifi_sta.rssi
            -
              type: TRIM
              parameters:
                - '[]'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: WiFi
        -
          uuid: eda4217da38d4e58a808e218dedc0c06
          name: 'WiFi SSID'
          type: DEPENDENT
          key: shelly1pm.status.wifi_sta.ssid
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..wifi_sta.ssid
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: shelly1pm.status
          tags:
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$SHELLYPWD}'
          type: SECRET_TEXT
          description: 'Password for admin user, if present'
      valuemaps:
        -
          uuid: 0db42638c555414c9f984fa09f6cba44
          name: 'Shelly Connection State'
          mappings:
            -
              value: '0'
              newvalue: Disconnected
            -
              value: '1'
              newvalue: Connected
            -
              value: '2'
              newvalue: Unknown
        -
          uuid: a4a27bf681644776a6ba11acc1f2e25d
          name: 'Shelly Enabled State'
          mappings:
            -
              value: '0'
              newvalue: Disabled
            -
              value: '1'
              newvalue: Enabled
            -
              value: '2'
              newvalue: Unknown
        -
          uuid: df0cfa277d3b40c7a86010de486460b6
          name: 'Shelly Input Event'
          mappings:
            -
              value: '0'
              newvalue: Shortpush
            -
              value: '1'
              newvalue: Longpush
            -
              value: '2'
              newvalue: none/invalid
        -
          uuid: 08c0a8bbaf1845d7b39137d759451b6a
          name: 'Shelly On/Off State'
          mappings:
            -
              value: '0'
              newvalue: 'Off'
            -
              value: '1'
              newvalue: 'On'
            -
              value: '2'
              newvalue: Unknown
        -
          uuid: 298b6923322e48b8966bd7fd26b412d4
          name: 'Shelly Status'
          mappings:
            -
              value: '0'
              newvalue: Ok
            -
              value: '1'
              newvalue: Critical
            -
              value: '2'
              newvalue: Unknown
        -
          uuid: c5873ab9a0064d34ab374edfa4731289
          name: 'Shelly Temperature Status'
          mappings:
            -
              value: '0'
              newvalue: Normal
            -
              value: '1'
              newvalue: High
            -
              value: '2'
              newvalue: 'Very High'
            -
              value: '3'
              newvalue: Unknown
        -
          uuid: 72420a95ce704802a3fa2a9c676b31f3
          name: 'Shelly Update Availability'
          mappings:
            -
              value: '0'
              newvalue: 'No Update Available'
            -
              value: '1'
              newvalue: 'Update Available'
            -
              value: '2'
              newvalue: Unknown
        -
          uuid: 0a38b3bd52cd489ebe898fec22741ffe
          name: 'Shelly Update Status'
          mappings:
            -
              value: '0'
              newvalue: Idle
            -
              value: '1'
              newvalue: Pending
            -
              value: '2'
              newvalue: Updating
            -
              value: '3'
              newvalue: Unknown
  triggers:
    -
      uuid: 445d4aac435f4c43b30c6079da04d57f
      expression: 'last(/Shelly-1PM/shelly1pm.status.fs_free)>=last(/Shelly-1PM/shelly1pm.status.fs_size)*0.8 and last(/Shelly-1PM/shelly1pm.status.fs_free)<last(/Shelly-1PM/shelly1pm.status.fs_size)*0.9'
      name: 'Filesystem usage >=80%'
      priority: WARNING
    -
      uuid: 5ed397a0b07c4853a741323acb56169d
      expression: 'last(/Shelly-1PM/shelly1pm.status.fs_free)>=last(/Shelly-1PM/shelly1pm.status.fs_size)*0.9'
      name: 'Filesystem usage >=90%'
      priority: AVERAGE
    -
      uuid: 977ede1aeb494ba98ff0a3c3802e9549
      expression: 'last(/Shelly-1PM/shelly1pm.status.ram_free)>=last(/Shelly-1PM/shelly1pm.status.ram_total)*0.8 and last(/Shelly-1PM/shelly1pm.status.ram_free)<last(/Shelly-1PM/shelly1pm.status.ram_total)*0.9'
      name: 'Memory usage >=80%'
      priority: WARNING
    -
      uuid: 33067715b3e24dd28490c391d0671b02
      expression: 'last(/Shelly-1PM/shelly1pm.status.ram_free)>=last(/Shelly-1PM/shelly1pm.status.ram_total)*0.9'
      name: 'Memory usage >=90%'
      priority: AVERAGE
