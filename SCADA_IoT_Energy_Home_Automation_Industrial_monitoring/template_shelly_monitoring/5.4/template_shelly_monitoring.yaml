zabbix_export:
  version: '5.4'
  date: '2021-11-21T22:09:10Z'
  groups:
    -
      uuid: f609ef9a7ec748ae8ceb88ad929b7613
      name: Shelly
    -
      uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: d51f33db1b344222937b67babcb6e413
      template: 'Shelly 3EM'
      name: 'Shelly 3EM'
      description: |
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        
      templates:
        -
          name: 'Template Module ICMP Ping'
      groups:
        -
          name: Shelly
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: de03f0507a144c6da565a56786ab4d6a
          name: 'Skipped actions'
          type: DEPENDENT
          key: actions_stats.skipped
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.actions_stats.skipped
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 68f14def577c497bb3bdbb71fb695c38
              expression: 'change(/Shelly 3EM/actions_stats.skipped)>0'
              name: 'At least one action has been skipped'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: a21f6ddc42904976924d71cdb015cd1a
          name: 'System configuration changes'
          type: DEPENDENT
          key: cfg_changed_cnt
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cfg_changed_cnt
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 27a323790e134f329e739c4e0ba643fe
              expression: 'change(/Shelly 3EM/cfg_changed_cnt)>0'
              name: 'System configuration has been changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 546908a545d740e1b61f7c55eb48c35d
          name: 'Cloud connected'
          type: DEPENDENT
          key: cloud.connected
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 8eeeaf26835f4a45b5cec41272f3b7f7
              expression: 'change(/Shelly 3EM/cloud.connected)<>0'
              name: 'Cloud connection state has changed'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 067400d321f642faae01689eb526b492
          name: 'Cloud enabled'
          type: DEPENDENT
          key: cloud.enabled
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.enabled
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 0a9e33bf4a9e44d3adc52dcb93c0520f
              expression: 'change(/Shelly 3EM/cloud.enabled)<>0'
              name: 'Cloud configuration has changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: f31be186fee947e2a83309d5c41ecc7d
          name: 'Electric company electrometer estimate'
          type: DEPENDENT
          key: ec_em_estimate
          delay: '0'
          history: 1825d
          status: DISABLED
          value_type: FLOAT
          units: Wh
          description: |
            Estimated value of electric company electrometer. This value may differ from real value due to device restarts or incorrect measurements. This estimate is only useful when your Shelly 3EM is measuring power consumption on the main breaker.
            
            For this value to show correct estimate, you have to take a note of how many Wh were on electric company electrometer when you reset Shelly 3EM data and put this value into macro {$EC_EM_CONSUMPTION}.
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var json_data = JSON.parse(value);
                  
                  var ec_emeter_offset  = 0;
                  
                  var emeter_a_consumed = 0;
                  var emeter_b_consumed = 0;
                  var emeter_c_consumed = 0;
                  var emeter_n_consumed = 0;
                  
                  var emeter_a_returned = 0;
                  var emeter_b_returned = 0;
                  var emeter_c_returned = 0;
                  var emeter_n_returned = 0;
                  
                  var ec_em_consumed= '{$EC_EM_CONSUMPTION}';
                  
                  if (ec_em_consumed == '' || ec_em_consumed == null || ec_em_consumed === undefined) {
                    ec_em_consumed = 0;
                  } else {
                    try {
                      ec_em_consumed = parseInt(ec_em_consumed);
                    } catch (e) {
                      ec_em_consumed = 0;
                    }
                  }
                  
                  ec_emeter_offset = ec_em_consumed;
                  
                  if (json_data.emeters[0]) {
                    emeter_a_consumed = json_data.emeters[0].total;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b_consumed = json_data.emeters[1].total;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c_consumed = json_data.emeters[2].total;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n_consumed = json_data.emeters[3].total;
                  }
                  
                  if (json_data.emeters[0]) {
                    emeter_a_returned = json_data.emeters[0].total_returned;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b_returned = json_data.emeters[1].total_returned;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c_returned = json_data.emeters[2].total_returned;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n_returned = json_data.emeters[3].total_returned;
                  }
                  
                  return ec_emeter_offset + ((emeter_a_consumed + emeter_b_consumed + emeter_c_consumed + emeter_n_consumed) - (emeter_a_returned + emeter_b_returned + emeter_c_returned + emeter_n_returned));
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: 93aeda6f098b4641b570ff9bb6d5d208
          name: 'Electrometer A current'
          type: DEPENDENT
          key: emeters-0.current
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].current'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 2f63a07439bd43aa8a3ba601247aa393
          name: 'Electrometer A self-check'
          type: DEPENDENT
          key: emeters-0.is_valid
          delay: '0'
          history: 365d
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 338f4f9f3bf34906a501958ad4638719
          name: 'Electrometer A power factor'
          type: DEPENDENT
          key: emeters-0.pf
          delay: '0'
          history: 365d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].pf'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 930f124b03eb402da67471eab0b903a0
          name: 'Electrometer A power'
          type: DEPENDENT
          key: emeters-0.power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].power'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 4da9e08cdaa446e7871d710c99f0587a
          name: 'Electrometer A total consumed'
          type: DEPENDENT
          key: emeters-0.total
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].total'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 0ca029344f99473dbec61b4775427098
          name: 'Electrometer A total returned'
          type: DEPENDENT
          key: emeters-0.total_returned
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].total_returned'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: e45f922cf4314a26bcead1dbf0aec6be
          name: 'Electrometer A voltage'
          type: DEPENDENT
          key: emeters-0.voltage
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].voltage'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: f8886e4ca43f45e5b9d724fcde6be0b0
          name: 'Electrometer B current'
          type: DEPENDENT
          key: emeters-1.current
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].current'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 5fcee5d8db084acc90d668c4182dc5a7
          name: 'Electrometer B self-check'
          type: DEPENDENT
          key: emeters-1.is_valid
          delay: '0'
          history: 365d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 95771bc1b4c046c7b1b8ac5124b95831
          name: 'Electrometer B power factor'
          type: DEPENDENT
          key: emeters-1.pf
          delay: '0'
          history: 365d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].pf'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: ff08c1312f8246ae91944f09660651ed
          name: 'Electrometer B power'
          type: DEPENDENT
          key: emeters-1.power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].power'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 3781242b1f194fa087bc68bb5da65216
          name: 'Electrometer B total consumed'
          type: DEPENDENT
          key: emeters-1.total
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].total'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: a3818f93484d491095218e9258acdc0b
          name: 'Electrometer B total returned'
          type: DEPENDENT
          key: emeters-1.total_returned
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].total_returned'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 731fe4075bfd4a84bc73a4976a4fbaf8
          name: 'Electrometer B voltage'
          type: DEPENDENT
          key: emeters-1.voltage
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].voltage'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 792044981174459dbf4dbb379da75116
          name: 'Electrometer C current'
          type: DEPENDENT
          key: emeters-2.current
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].current'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 3f96377570304784bb87826838c0a930
          name: 'Electrometer C self-check'
          type: DEPENDENT
          key: emeters-2.is_valid
          delay: '0'
          history: 365d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 0d5edf970edc424baf495409356feb10
          name: 'Electrometer C power factor'
          type: DEPENDENT
          key: emeters-2.pf
          delay: '0'
          history: 365d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].pf'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: c6d4a2a3ea1542bb94c51f3872733de4
          name: 'Electrometer C power'
          type: DEPENDENT
          key: emeters-2.power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].power'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 3e0d929ef58148b9a4007f2440553c98
          name: 'Electrometer C total consumed'
          type: DEPENDENT
          key: emeters-2.total
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].total'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: c3b5763ba8994105a514b04097cc0baa
          name: 'Electrometer C total returned'
          type: DEPENDENT
          key: emeters-2.total_returned
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].total_returned'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 419c8d58349d487b9da670945c608944
          name: 'Electrometer C voltage'
          type: DEPENDENT
          key: emeters-2.voltage
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].voltage'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 84c0ab76969a4465966f77648615d560
          name: 'Electrometer N current'
          type: DEPENDENT
          key: emeters-3.current
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].current'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: cdeeb06649064afa8238af003acff3da
          name: 'Electrometer N self-check'
          type: DEPENDENT
          key: emeters-3.is_valid
          delay: '0'
          history: 365d
          status: DISABLED
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 2eb2c8442c1b4c8f812edc0a8e509298
          name: 'Electrometer N power factor'
          type: DEPENDENT
          key: emeters-3.pf
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].pf'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 7f408becd77e4b6f817a4f93546aa583
          name: 'Electrometer N power'
          type: DEPENDENT
          key: emeters-3.power
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].power'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 788ba14c094b4b0bb3d281a68d501aee
          name: 'Electrometer N total consumed'
          type: DEPENDENT
          key: emeters-3.total
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].total'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 00a81e0ebf7d420fb6b385018d0fa1c2
          name: 'Electrometer N total returned'
          type: DEPENDENT
          key: emeters-3.total_returned
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].total_returned'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 8ef3032f89c441cfacdf07ba817447bb
          name: 'Electrometer N voltage'
          type: DEPENDENT
          key: emeters-3.voltage
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].voltage'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 4404c3bc5eff49189654f19c11ca72b5
          name: 'File system free size'
          type: DEPENDENT
          key: fs_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_free
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 7562c85165484dbbbcf5e6edbbf8c88f
          name: 'Sysflash is mounted'
          type: DEPENDENT
          key: fs_mounted
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_mounted
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 5288f28eedd449abbc569756d4ce28e6
          name: 'File system total size'
          type: DEPENDENT
          key: fs_size
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_size
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: d521187129a5411f8e9bc02f13f84c38
          name: 'MQTT connected'
          type: DEPENDENT
          key: mqtt.connected
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.mqtt.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: 685912c5b9a54f75b633d5420869332c
              expression: 'change(/Shelly 3EM/mqtt.connected)<>0'
              name: 'MQTT connection state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 30cf2ff764614e4e9601ad71b6253f35
          name: 'RAM free'
          type: DEPENDENT
          key: ram_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_free
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: fe47ce26f64447faaf33fb3ebb08de25
          name: 'RAM total'
          type: DEPENDENT
          key: ram_total
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_total
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: ce873be92ef841a0addf0afc2247ecaf
          name: 'Relay has timer'
          type: DEPENDENT
          key: relays-0.has_timer
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].has_timer'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 4c095f7d9a744099bb651a256ecdeb23
          name: 'Relay turned on'
          type: DEPENDENT
          key: relays-0.ison
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].ison'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: d082a453be7f460e84a94345246fb092
              expression: 'change(/Shelly 3EM/relays-0.ison)<>0'
              name: 'Relay state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 20d8327462524510809a6499c92220f1
          name: 'Relay sensor self-check'
          type: DEPENDENT
          key: relays-0.is_valid
          delay: '0'
          history: 365d
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
            -
              tag: Application
              value: Sefl-check
        -
          uuid: 06ea44d476f84a57af7ef4085643fb4d
          name: 'Relay overpower occurred'
          type: DEPENDENT
          key: relays-0.overpower
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].overpower'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: 88c69464d8674e43a4bc999cc28ae637
              expression: 'last(/Shelly 3EM/relays-0.overpower)="true"'
              name: 'Overpower event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 24f315d570834754bf45d7efb4cae709
          name: 'Relays last command source'
          type: DEPENDENT
          key: relays-0.source
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].source'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: c9af4f1c9de140628fb643a0df32952a
          name: 'Relay timer duration'
          type: DEPENDENT
          key: relays-0.timer_duration
          delay: '0'
          history: 365d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_duration'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: b5dce777b94a4455a0e8af1bb22eb046
          name: 'Relay timer remaining'
          type: DEPENDENT
          key: relays-0.timer_remaining
          delay: '0'
          history: 365d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_remaining'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 2ec1759dc1514bb2bd717f7aec6a9eb8
          name: 'Relay timer started'
          type: DEPENDENT
          key: relays-0.timer_started
          delay: '0'
          history: 365d
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_started'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 8c75d74cad834425a8da022e8d4b3557
          name: 'Status data'
          type: HTTP_AGENT
          key: status
          delay: '30'
          history: 1h
          trends: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$SHELLY_USER}'
          password: '{$SHELLY_PASS}'
          description: 'Collect data from Shelly device status API.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.body
          url: 'http://{HOST.IP}/status'
          follow_redirects: 'NO'
          output_format: JSON
          tags:
            -
              tag: Application
              value: 'Data collection'
          triggers:
            -
              uuid: 4d77de91491f41ddbc33c38009f874cb
              expression: 'nodata(/Shelly 3EM/status,120s)=1'
              name: 'No data received'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: 'Data collection'
        -
          uuid: 2ddd6bb4d43f4f8da1ae786c051e1324
          name: 'Total consumption from last reset'
          type: DEPENDENT
          key: total_consuption
          delay: '0'
          history: 1825d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var json_data = JSON.parse(value);
                  
                  var emeter_a = 0;
                  var emeter_b = 0;
                  var emeter_c = 0;
                  var emeter_n = 0;
                  
                  if (json_data.emeters[0]) {
                    emeter_a = json_data.emeters[0].total;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b = json_data.emeters[1].total;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c = json_data.emeters[2].total;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n = json_data.emeters[3].total;
                  }
                  
                  return (emeter_a + emeter_b + emeter_c + emeter_n);
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: 59326fc54a664511bb2a9fa8bf66f277
          name: 'Total power consumption'
          type: DEPENDENT
          key: total_power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.total_power
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: ca8c3df5619a45d6b39d9ec6dd54572b
          name: 'Total return from last reset'
          type: DEPENDENT
          key: total_returned
          delay: '0'
          history: 1825d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var json_data = JSON.parse(value);
                  
                  var emeter_a = 0;
                  var emeter_b = 0;
                  var emeter_c = 0;
                  var emeter_n = 0;
                  
                  if (json_data.emeters[0]) {
                    emeter_a = json_data.emeters[0].total_returned;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b = json_data.emeters[1].total_returned;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c = json_data.emeters[2].total_returned;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n = json_data.emeters[3].total_returned;
                  }
                  
                  return (emeter_a + emeter_b + emeter_c + emeter_n);
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: 3d2c95d37a31473dabad2f5c032e9646
          name: 'Device time'
          type: DEPENDENT
          key: unixtime
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.unixtime
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 1e044004af7641d1b0667e6673a7a254
              expression: 'fuzzytime(/Shelly 3EM/unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 9acda239f1674008a4b8e1893c16d272
          name: 'Update available'
          type: DEPENDENT
          key: update.has_update
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.has_update
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: e93b9500a8264661bb2310ff79cbf549
              expression: 'last(/Shelly 3EM/update.has_update)="true"'
              name: 'Update available'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 3d26a038683146e9b231972baa8db695
          name: 'Firmware new version'
          type: DEPENDENT
          key: update.new_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.new_version
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 9ac45f72d12e4d24975d88adb762654e
          name: 'Firmware old version'
          type: DEPENDENT
          key: update.old_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.old_version
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 06d0ca8b4d114a14bb5ee89a08746684
              expression: 'change(/Shelly 3EM/update.old_version)<>0'
              name: 'Version has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 2ef19e5b21c8478a9c1ea4f4ce4ff251
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 10d
          units: uptime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: edabab5ffff1468eb059e1eb115a047b
              expression: 'change(/Shelly 3EM/uptime)<0'
              name: 'Device has been restarted'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 32436f883f22495ebd0e4ed4d6f1109d
          name: 'WiFi connected'
          type: DEPENDENT
          key: wifi_sta.connected
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 34be1fb7cb374e2f88710ced1f39f6e9
          name: 'WiFi IP'
          type: DEPENDENT
          key: wifi_sta.ip
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ip
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: b5f34de0544e476c95773265b16ea494
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: wifi_sta.rssi
          delay: '0'
          history: 10d
          value_type: FLOAT
          units: dBm
          valuemap:
            name: 'Received Signal Strength Indicator'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.rssi
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 5d55d8ae37a84e1c939d798d0f43c543
          name: 'WiFi SSID'
          type: DEPENDENT
          key: wifi_sta.ssid
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ssid
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$EC_EM_CONSUMPTION}'
          value: '0'
          description: 'Total value on your electric company electrometer in Wh at the moment you reset Shelly 3EM data.'
        -
          macro: '{$SHELLY_PASS}'
          type: SECRET_TEXT
          description: 'Device password, if configured'
        -
          macro: '{$SHELLY_USER}'
          value: admin
          description: 'Device user, if configured'
      valuemaps:
        -
          uuid: 3744628ae85645edbfe818519ce35827
          name: 'Received Signal Strength Indicator'
          mappings:
            -
              type: GREATER_OR_EQUAL
              value: '-30'
              newvalue: Amazing
            -
              type: GREATER_OR_EQUAL
              value: '-67'
              newvalue: 'Very Good'
            -
              type: GREATER_OR_EQUAL
              value: '-70'
              newvalue: Good
            -
              type: GREATER_OR_EQUAL
              value: '-80'
              newvalue: 'Not Good'
            -
              type: LESS_OR_EQUAL
              value: '-81'
              newvalue: Unusable
        -
          uuid: ffffe09da8bf44efae7cc9a7fecadfd9
          name: Self-check
          mappings:
            -
              value: '1'
              newvalue: Working
            -
              value: '0'
              newvalue: 'Not working'
    -
      uuid: d9d1a00713ca44e383634ba852e8bb12
      template: 'Shelly 3EM - MQTT'
      name: 'Shelly 3EM - MQTT'
      description: |
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        
      groups:
        -
          name: Shelly
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: c712d922fec749f9a19e19fc6353851c
          name: 'Skipped actions'
          type: DEPENDENT
          key: actions_stats.skipped
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.actions_stats.skipped
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: c12233fc35c64a18bb523103652626c7
              expression: 'change(/Shelly 3EM - MQTT/actions_stats.skipped)>0'
              name: 'At least one action has been skipped'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 4e53ae5fd4c14132aa186713cb3eac1a
          name: 'System configuration changes'
          type: DEPENDENT
          key: cfg_changed_cnt
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cfg_changed_cnt
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: dd3b8e51d5094e569d916d787cd01924
              expression: 'change(/Shelly 3EM - MQTT/cfg_changed_cnt)>0'
              name: 'System configuration has been changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: fa011634183840a5a82050ae36fe071f
          name: 'Cloud connected'
          type: DEPENDENT
          key: cloud.connected
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 2aa23bc6bc234fdb949247677c0bab96
              expression: 'change(/Shelly 3EM - MQTT/cloud.connected)<>0'
              name: 'Cloud connection state has changed'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 817610344daa494e8348a502b3b7c9e8
          name: 'Cloud enabled'
          type: DEPENDENT
          key: cloud.enabled
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.enabled
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 004bb4b18a104b2283a9ffe1373c749b
              expression: 'change(/Shelly 3EM - MQTT/cloud.enabled)<>0'
              name: 'Cloud configuration has changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 8ee4492271f7496696ba3b2b6cfaed05
          name: 'Electric company electrometer estimate'
          type: DEPENDENT
          key: ec_em_estimate
          delay: '0'
          history: 1825d
          status: DISABLED
          value_type: FLOAT
          units: Wh
          description: |
            Estimated value of electric company electrometer. This value may differ from real value due to device restarts or incorrect measurements. This estimate is only useful when your Shelly 3EM is measuring power consumption on the main breaker.
            
            For this value to show correct estimate, you have to take a note of how many Wh were on electric company electrometer when you reset Shelly 3EM data and put this value into macro {$EC_EM_CONSUMPTION}.
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var json_data = JSON.parse(value);
                  
                  var ec_emeter_offset  = 0;
                  
                  var emeter_a_consumed = 0;
                  var emeter_b_consumed = 0;
                  var emeter_c_consumed = 0;
                  var emeter_n_consumed = 0;
                  
                  var emeter_a_returned = 0;
                  var emeter_b_returned = 0;
                  var emeter_c_returned = 0;
                  var emeter_n_returned = 0;
                  
                  var ec_em_consumed= '{$EC_EM_CONSUMPTION}';
                  
                  if (ec_em_consumed == '' || ec_em_consumed == null || ec_em_consumed === undefined) {
                    ec_em_consumed = 0;
                  } else {
                    try {
                      ec_em_consumed = parseInt(ec_em_consumed);
                    } catch (e) {
                      ec_em_consumed = 0;
                    }
                  }
                  
                  ec_emeter_offset = ec_em_consumed;
                  
                  if (json_data.emeters[0]) {
                    emeter_a_consumed = json_data.emeters[0].total;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b_consumed = json_data.emeters[1].total;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c_consumed = json_data.emeters[2].total;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n_consumed = json_data.emeters[3].total;
                  }
                  
                  if (json_data.emeters[0]) {
                    emeter_a_returned = json_data.emeters[0].total_returned;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b_returned = json_data.emeters[1].total_returned;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c_returned = json_data.emeters[2].total_returned;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n_returned = json_data.emeters[3].total_returned;
                  }
                  
                  return ec_emeter_offset + ((emeter_a_consumed + emeter_b_consumed + emeter_c_consumed + emeter_n_consumed) - (emeter_a_returned + emeter_b_returned + emeter_c_returned + emeter_n_returned));
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: b3d5337b8013479481132651c01cba02
          name: 'Electrometer A current'
          type: DEPENDENT
          key: emeters-0.current
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].current'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: b0d421be1e6c457ba5bb4056939aed4b
          name: 'Electrometer A self-check'
          type: DEPENDENT
          key: emeters-0.is_valid
          delay: '0'
          history: 365d
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 53e0bcee831849168cde673a8f85c142
          name: 'Electrometer A power factor'
          type: DEPENDENT
          key: emeters-0.pf
          delay: '0'
          history: 365d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].pf'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: e9af68c5ffc74098b1ebb49b2eaf1745
          name: 'Electrometer A power'
          type: DEPENDENT
          key: emeters-0.power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].power'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: b28d35a52948419bbd83ed0fe27d232e
          name: 'Electrometer A total consumed'
          type: DEPENDENT
          key: emeters-0.total
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].total'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 8db7e24e57084e829d965a584a1ef8b2
          name: 'Electrometer A total returned'
          type: DEPENDENT
          key: emeters-0.total_returned
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].total_returned'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: f428d123409042b292b860b48bf2ccca
          name: 'Electrometer A voltage'
          type: DEPENDENT
          key: emeters-0.voltage
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[0].voltage'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer A'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 970995c832d24071b626e51133645d43
          name: 'Electrometer B current'
          type: DEPENDENT
          key: emeters-1.current
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].current'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: efdb1799b410411881a330b68987bcd8
          name: 'Electrometer B self-check'
          type: DEPENDENT
          key: emeters-1.is_valid
          delay: '0'
          history: 365d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 10f2f6f3fac3440d9e0d78a122b416ee
          name: 'Electrometer B power factor'
          type: DEPENDENT
          key: emeters-1.pf
          delay: '0'
          history: 365d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].pf'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: a059ffd03de144efae2e2c259409855a
          name: 'Electrometer B power'
          type: DEPENDENT
          key: emeters-1.power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].power'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 84c8a7fab8ef417cb443c3284baec177
          name: 'Electrometer B total consumed'
          type: DEPENDENT
          key: emeters-1.total
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].total'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 17ae92df20734080af40ec093dc03e3f
          name: 'Electrometer B total returned'
          type: DEPENDENT
          key: emeters-1.total_returned
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].total_returned'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 823362bbd28e4bccbe755b2bd21775b9
          name: 'Electrometer B voltage'
          type: DEPENDENT
          key: emeters-1.voltage
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[1].voltage'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer B'
            -
              tag: Application
              value: Electrometers
        -
          uuid: c58712c52b954c9cb9925c94c3e3e4f4
          name: 'Electrometer C current'
          type: DEPENDENT
          key: emeters-2.current
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].current'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: e5b6b6d1a6ad487ba8bbc6e3e8d56ded
          name: 'Electrometer C self-check'
          type: DEPENDENT
          key: emeters-2.is_valid
          delay: '0'
          history: 365d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: 348191a4d7364428af574e9d72bfb756
          name: 'Electrometer C power factor'
          type: DEPENDENT
          key: emeters-2.pf
          delay: '0'
          history: 365d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].pf'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 0690eb009379491c910d7933aaab2fd9
          name: 'Electrometer C power'
          type: DEPENDENT
          key: emeters-2.power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].power'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 478bba63e48646659d8952aea18af60e
          name: 'Electrometer C total consumed'
          type: DEPENDENT
          key: emeters-2.total
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].total'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 0ec7f205a8e94f338306aa811b51fb5b
          name: 'Electrometer C total returned'
          type: DEPENDENT
          key: emeters-2.total_returned
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].total_returned'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: d29db3ef9a2842e0bd36f46a30609bad
          name: 'Electrometer C voltage'
          type: DEPENDENT
          key: emeters-2.voltage
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[2].voltage'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer C'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 5c934e3b1d004748b01959284c224b40
          name: 'Electrometer N current'
          type: DEPENDENT
          key: emeters-3.current
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].current'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 65b725295c07407086c1a4bb06c10efb
          name: 'Electrometer N self-check'
          type: DEPENDENT
          key: emeters-3.is_valid
          delay: '0'
          history: 365d
          status: DISABLED
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
            -
              tag: Application
              value: Self-check
        -
          uuid: a0c31755b79a4f4081995be95eafef89
          name: 'Electrometer N power factor'
          type: DEPENDENT
          key: emeters-3.pf
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].pf'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 5831b9d2a7c64b71a552c1a70bc444d4
          name: 'Electrometer N power'
          type: DEPENDENT
          key: emeters-3.power
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].power'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: f62d9ca874034fe598fea1d6a1b86a6a
          name: 'Electrometer N total consumed'
          type: DEPENDENT
          key: emeters-3.total
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].total'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: ea2c2642fc934109b41ff6c3373fc310
          name: 'Electrometer N total returned'
          type: DEPENDENT
          key: emeters-3.total_returned
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].total_returned'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: d6f94109b48341a6bd7dbd9c217dcf81
          name: 'Electrometer N voltage'
          type: DEPENDENT
          key: emeters-3.voltage
          delay: '0'
          history: 365d
          status: DISABLED
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.emeters[3].voltage'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Electrometer N'
            -
              tag: Application
              value: Electrometers
        -
          uuid: 86f64ae2044f407c94c3c0b13823c146
          name: 'File system free size'
          type: DEPENDENT
          key: fs_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_free
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: c4478ca261624ba9a5ed10b0d1d19055
          name: 'Sysflash is mounted'
          type: DEPENDENT
          key: fs_mounted
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_mounted
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: aa87ae09c8b84cdc80bd642a1017803c
          name: 'File system total size'
          type: DEPENDENT
          key: fs_size
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_size
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: efa92edb83d84f3787021727198e2523
          name: 'MQTT connected'
          type: DEPENDENT
          key: mqtt.connected
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.mqtt.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: be91b0e32bf04abda3db6dfb6480273d
              expression: 'change(/Shelly 3EM - MQTT/mqtt.connected)<>0'
              name: 'MQTT connection state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: ee239b5171bb4588994e4b69f3cf7240
          name: 'Status data'
          type: ZABBIX_ACTIVE
          key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          delay: '0'
          history: 1h
          trends: '0'
          value_type: TEXT
          description: 'Collect data from Shelly device status topic.'
          tags:
            -
              tag: Application
              value: 'Data collection'
          triggers:
            -
              uuid: c8cefea8573b42ecaa41b35cc0aee0be
              expression: 'nodata(/Shelly 3EM - MQTT/mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}],120s)=1'
              name: 'No data received'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: 'Data collection'
        -
          uuid: 87f7e30ca0fb47b6ac5eb452dcc01565
          name: 'RAM free'
          type: DEPENDENT
          key: ram_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_free
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 878225154d73432f811ec02c411d015a
          name: 'RAM total'
          type: DEPENDENT
          key: ram_total
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_total
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 98237acaad8a41008dc2e127e48b4da3
          name: 'Relay has timer'
          type: DEPENDENT
          key: relays-0.has_timer
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].has_timer'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 4a771db1d8c7404180a26d1c6fb5dce2
          name: 'Relay turned on'
          type: DEPENDENT
          key: relays-0.ison
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].ison'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: f64e33573be544298eb766e2628e73ef
              expression: 'change(/Shelly 3EM - MQTT/relays-0.ison)<>0'
              name: 'Relay state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 1d1a325f57704acc85bb892bb6a7ee6f
          name: 'Relay sensor self-check'
          type: DEPENDENT
          key: relays-0.is_valid
          delay: '0'
          history: 365d
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
            -
              tag: Application
              value: Sefl-check
        -
          uuid: 4232bfff69824155b6ab5832bb86f55c
          name: 'Relay overpower occurred'
          type: DEPENDENT
          key: relays-0.overpower
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].overpower'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: 197e0b8b8c67463c81ab38b1d0c9e422
              expression: 'last(/Shelly 3EM - MQTT/relays-0.overpower)="true"'
              name: 'Overpower event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 391e51ecf7d54161aa528db2874a0322
          name: 'Relays last command source'
          type: DEPENDENT
          key: relays-0.source
          delay: '0'
          history: 365d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].source'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: ebfb3ba82ca449dabc7459249cc7e4ee
          name: 'Relay timer duration'
          type: DEPENDENT
          key: relays-0.timer_duration
          delay: '0'
          history: 365d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_duration'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: c50e5a0ef8ad4f839d50834b6b5816da
          name: 'Relay timer remaining'
          type: DEPENDENT
          key: relays-0.timer_remaining
          delay: '0'
          history: 365d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_remaining'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 9c822f91ebb345fbb4c5a5f8cb33b058
          name: 'Relay timer started'
          type: DEPENDENT
          key: relays-0.timer_started
          delay: '0'
          history: 365d
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_started'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 13724f729d8e49feb962b9750ce6645a
          name: 'Total consumption from last reset'
          type: DEPENDENT
          key: total_consuption
          delay: '0'
          history: 1825d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var json_data = JSON.parse(value);
                  
                  var emeter_a = 0;
                  var emeter_b = 0;
                  var emeter_c = 0;
                  var emeter_n = 0;
                  
                  if (json_data.emeters[0]) {
                    emeter_a = json_data.emeters[0].total;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b = json_data.emeters[1].total;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c = json_data.emeters[2].total;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n = json_data.emeters[3].total;
                  }
                  
                  return (emeter_a + emeter_b + emeter_c + emeter_n);
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: 5e7034a24c524cb29e3fc685db07b201
          name: 'Total power consumption'
          type: DEPENDENT
          key: total_power
          delay: '0'
          history: 365d
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.total_power
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: ea6fb531623f43e48b5ce1ec7c199be8
          name: 'Total return from last reset'
          type: DEPENDENT
          key: total_returned
          delay: '0'
          history: 1825d
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var json_data = JSON.parse(value);
                  
                  var emeter_a = 0;
                  var emeter_b = 0;
                  var emeter_c = 0;
                  var emeter_n = 0;
                  
                  if (json_data.emeters[0]) {
                    emeter_a = json_data.emeters[0].total_returned;
                  }
                  if (json_data.emeters[1]) {
                    emeter_b = json_data.emeters[1].total_returned;
                  }
                  if (json_data.emeters[2]) {
                    emeter_c = json_data.emeters[2].total_returned;
                  }
                  if (json_data.emeters[3]) {
                    emeter_n = json_data.emeters[3].total_returned;
                  }
                  
                  return (emeter_a + emeter_b + emeter_c + emeter_n);
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: 'Electrometer summary'
        -
          uuid: 84024b1385a1459fae0b58ade7fc40c4
          name: 'Device time'
          type: DEPENDENT
          key: unixtime
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.unixtime
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 5cd28e3e494b4eae94cd79f24b6de1d7
              expression: 'fuzzytime(/Shelly 3EM - MQTT/unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 809071ce141d47878f30f18a512b075e
          name: 'Update available'
          type: DEPENDENT
          key: update.has_update
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.has_update
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: b01b82ec56a4416d8e5c217ea1a3e66d
              expression: 'last(/Shelly 3EM - MQTT/update.has_update)="true"'
              name: 'Update available'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 1399278b5aab40b19dcb2121e3c7a039
          name: 'Firmware new version'
          type: DEPENDENT
          key: update.new_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.new_version
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: ba73ab9097904c48b5baddf4926ca63d
          name: 'Firmware old version'
          type: DEPENDENT
          key: update.old_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.old_version
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 8930d82089124ecea8559533950a24bc
              expression: 'change(/Shelly 3EM - MQTT/update.old_version)<>0'
              name: 'Version has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: c9499513c23645aa9a382c12e5da7c00
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 10d
          units: uptime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: b6f835f5cbd846bd8f88e18f8d0faf4c
              expression: 'change(/Shelly 3EM - MQTT/uptime)<0'
              name: 'Device has been restarted'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: c70c6805d5c742c292aafbd65bee4d15
          name: 'WiFi connected'
          type: DEPENDENT
          key: wifi_sta.connected
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 6bae78b3eff24b1885fde577092b21aa
          name: 'WiFi IP'
          type: DEPENDENT
          key: wifi_sta.ip
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ip
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 03dc55e375bd49f38060cd87768573e3
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: wifi_sta.rssi
          delay: '0'
          history: 10d
          value_type: FLOAT
          units: dBm
          valuemap:
            name: 'Received Signal Strength Indicator'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.rssi
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: b8c27a05a8f44c558e34ac176a303967
          name: 'WiFi SSID'
          type: DEPENDENT
          key: wifi_sta.ssid
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ssid
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$EC_EM_CONSUMPTION}'
          value: '0'
          description: 'Total value on your electric company electrometer in Wh at the moment you reset Shelly 3EM data.'
        -
          macro: '{$MQTT_BROKER_HOST}'
          value: 'tcp://localhost:1883'
          description: 'MQTT broker host'
        -
          macro: '{$MQTT_BROKER_PASS}'
          type: SECRET_TEXT
          description: 'MQTT broker password, if configured'
        -
          macro: '{$MQTT_BROKER_USER}'
          description: 'MQTT broker user, if configured'
        -
          macro: '{$MQTT_DEVICE_ID}'
          description: 'Shelly device MQTT ID'
      valuemaps:
        -
          uuid: b393a380aae84bbab962b68e42c8f4dd
          name: 'Received Signal Strength Indicator'
          mappings:
            -
              type: GREATER_OR_EQUAL
              value: '-30'
              newvalue: Amazing
            -
              type: GREATER_OR_EQUAL
              value: '-67'
              newvalue: 'Very Good'
            -
              type: GREATER_OR_EQUAL
              value: '-70'
              newvalue: Good
            -
              type: GREATER_OR_EQUAL
              value: '-80'
              newvalue: 'Not Good'
            -
              type: LESS_OR_EQUAL
              value: '-81'
              newvalue: Unusable
        -
          uuid: 62c7e1ddb29048fbb2169387cda7928f
          name: Self-check
          mappings:
            -
              value: '1'
              newvalue: Working
            -
              value: '0'
              newvalue: 'Not working'
    -
      uuid: e5e4158ec3584ce6ade9e13c6b09bc56
      template: 'Shelly Motion'
      name: 'Shelly Motion'
      description: |
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        
      templates:
        -
          name: 'Template Module ICMP Ping'
      groups:
        -
          name: Shelly
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: b182a3f49dfa4a868d2aa11f2cbab8ee
          name: 'Skipped actions'
          type: DEPENDENT
          key: actions_stats.skipped
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.actions_stats.skipped
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 8787a6f12e494a369b126d06fa4b6a9e
              expression: 'change(/Shelly Motion/actions_stats.skipped)>0'
              name: 'At least one action has been skipped'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 6371b845439a4c66a6a6a6f3627b252c
          name: 'Battery percentage'
          type: DEPENDENT
          key: bat.value
          delay: '0'
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.bat.value
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Battery
          triggers:
            -
              uuid: c6fdad66212e4e2d82c6574b8c0617fd
              expression: 'last(/Shelly Motion/bat.value)<=10'
              name: 'Sensor battery is low'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: System
            -
              uuid: 876689f576c34b2499754656e4e5b6ad
              expression: 'last(/Shelly Motion/bat.value)>10 and last(/Shelly Motion/bat.value)<=20'
              name: 'Sensor battery is low'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 87918a13ce8f4e43b9f09b58905a16a1
          name: 'Battery voltage'
          type: DEPENDENT
          key: bat.voltage
          delay: '0'
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.bat.voltage
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Battery
        -
          uuid: 16e24d3bea4643909289f2729dbbd078
          name: 'System configuration changes'
          type: DEPENDENT
          key: cfg_changed_cnt
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cfg_changed_cnt
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 4060facac10547d59fd25f57a1ac0761
              expression: 'change(/Shelly Motion/cfg_changed_cnt)>0'
              name: 'System configuration has been changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 1796b216f22540a498bbcdd2f289b3b5
          name: 'Charger connected'
          type: DEPENDENT
          key: charger
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.charger
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: c14500236c4848f3ae829ccdbd93483c
          name: 'Cloud connected'
          type: DEPENDENT
          key: cloud.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: da45482d40b44e5b8e761053bce07c48
              expression: 'change(/Shelly Motion/cloud.connected)<>0'
              name: 'Cloud connection state has changed'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: b2b35071152b48d5b1ea2e41fc26ab6d
          name: 'Cloud enabled'
          type: DEPENDENT
          key: cloud.enabled
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.enabled
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 9dfb447d1211449c939be9258d8e8e0c
              expression: 'change(/Shelly Motion/cloud.enabled)<>0'
              name: 'Cloud configuration has changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 33d5ca368f844f23a0f6c1c3b6357cb9
          name: 'File system free size'
          type: DEPENDENT
          key: fs_free
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_free
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: abce78709c4e4287adef784f8ce6bc28
          name: 'File system total size'
          type: DEPENDENT
          key: fs_size
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_size
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: bf34b11182194363b1eb807f82db2dd6
          name: 'Lux illumination'
          type: DEPENDENT
          key: lux.illumination
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.lux.illumination
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Lux sensor'
        -
          uuid: 17e40ac5118a4077b0fcf833809d8ede
          name: 'Lux sensor self-check'
          type: DEPENDENT
          key: lux.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.lux.is_valid
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Lux sensor'
            -
              tag: Application
              value: Sefl-check
        -
          uuid: 315b506e11dc43f683c9ed9892d68b79
          name: 'Lux value'
          type: DEPENDENT
          key: lux.value
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.lux.value
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Lux sensor'
        -
          uuid: fcc21fff6f7048f89d364c671e3b115a
          name: 'MQTT connected'
          type: DEPENDENT
          key: mqtt.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.mqtt.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: 3fbd3df9794a4a69a706512332ffd59e
              expression: 'change(/Shelly Motion/mqtt.connected)<>0'
              name: 'MQTT connection state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: b673f5d7502240248b7b6bd3b3a68aa7
          name: 'RAM free'
          type: DEPENDENT
          key: ram_free
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_free
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: eb3a1f3530274fe98d9ffab706586030
          name: 'RAM total'
          type: DEPENDENT
          key: ram_total
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_total
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 25974414e1cc4701b7f7eaa871dfee63
          name: 'Motion sensor active'
          type: DEPENDENT
          key: sensor.active
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.active
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Motion sensor'
          triggers:
            -
              uuid: 46e649c53c6c437cac6948f1bd4c2cc3
              expression: 'last(/Shelly Motion/sensor.active)="true"'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/Shelly Motion/sensor.active)="false"'
              name: 'Motion sensor active'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: 'Motion sensor'
        -
          uuid: 1467e5abcc38479fa71bbba68f1e6ab5
          name: 'Motion sensor self-check'
          type: DEPENDENT
          key: sensor.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.is_valid
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Motion sensor'
            -
              tag: Application
              value: Sefl-check
        -
          uuid: 430cd77e6ea444c28924b3021892febd
          name: 'Motion detection'
          type: DEPENDENT
          key: sensor.motion
          delay: '0'
          valuemap:
            name: Motion
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.motion
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Motion sensor'
        -
          uuid: 60d5d6b7d1db4ba693bbabdbe51e4630
          name: 'Tamper detection'
          type: DEPENDENT
          key: sensor.vibration
          delay: '0'
          valuemap:
            name: Tampering
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.vibration
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: 'Motion sensor'
        -
          uuid: 629c64f8242c445ab53b002f7e7b3164
          name: 'Status data'
          type: HTTP_AGENT
          key: status
          delay: '30'
          history: 1h
          trends: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$SHELLY_USER}'
          password: '{$SHELLY_PASS}'
          description: 'Collect data from Shelly device status API.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.body
          timeout: 25s
          url: 'http://{HOST.IP}/status'
          follow_redirects: 'NO'
          output_format: JSON
          tags:
            -
              tag: Application
              value: 'Data collection'
          triggers:
            -
              uuid: 38117ec9b9114443a56f727b60eb3367
              expression: 'nodata(/Shelly Motion/status,180s)=1'
              name: 'No data received'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: 'Data collection'
        -
          uuid: a2b80942c39a487a8a057cd53f3cd758
          name: 'Device time'
          type: DEPENDENT
          key: unixtime
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.unixtime
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 875e7f149e6347aeb139445aa2489a5f
              expression: 'fuzzytime(/Shelly Motion/unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: d873de862fce4312ae0d51e3cea6b171
          name: 'Update available'
          type: DEPENDENT
          key: update.has_update
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.has_update
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: d405b2003e7d4ce78ee4c3cefce81eb9
              expression: 'last(/Shelly Motion/update.has_update)="true"'
              name: 'Update available'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 51a1c1999ddc416bae5b16c59c69f114
          name: 'Firmware new version'
          type: DEPENDENT
          key: update.new_version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.new_version
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 9f2f7fb1bb81424a845229f71e60e1ee
          name: 'Firmware old version'
          type: DEPENDENT
          key: update.old_version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.old_version
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 9050639bec0d442d9a6face8c5f3df67
              expression: 'change(/Shelly Motion/update.old_version)<>0'
              name: 'Version has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 142a08d145df4da4a30af028f381bb32
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          units: uptime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 0bd330b80ba14509980f52c531e797b2
              expression: 'change(/Shelly Motion/uptime)<0'
              name: 'Device has been restarted'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: ad4d358c47874fb5962081a73aac42fd
          name: 'WiFi connected'
          type: DEPENDENT
          key: wifi_sta.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: a503e8f140ed4c729c3fe4c8556404fc
          name: 'WiFi IP'
          type: DEPENDENT
          key: wifi_sta.ip
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ip
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: c53b5e9a29bd448c9848ec96a6a26b32
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: wifi_sta.rssi
          delay: '0'
          value_type: FLOAT
          units: dBm
          valuemap:
            name: 'Received Signal Strength Indicator'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.rssi
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 40ba849a48614489b0778687e5215991
          name: 'WiFi SSID'
          type: DEPENDENT
          key: wifi_sta.ssid
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ssid
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$SHELLY_PASS}'
          type: SECRET_TEXT
          description: 'Device password, if configured'
        -
          macro: '{$SHELLY_USER}'
          value: admin
          description: 'Device user, if configured'
      valuemaps:
        -
          uuid: 319fdcbc35404cb9ad5f014459403036
          name: Motion
          mappings:
            -
              value: '1'
              newvalue: Motion
            -
              value: '0'
              newvalue: 'No motion'
        -
          uuid: b034c6ad33e24658896cf0768693774c
          name: 'Received Signal Strength Indicator'
          mappings:
            -
              type: GREATER_OR_EQUAL
              value: '-30'
              newvalue: Amazing
            -
              type: GREATER_OR_EQUAL
              value: '-67'
              newvalue: 'Very Good'
            -
              type: GREATER_OR_EQUAL
              value: '-70'
              newvalue: Good
            -
              type: GREATER_OR_EQUAL
              value: '-80'
              newvalue: 'Not Good'
            -
              type: LESS_OR_EQUAL
              value: '-81'
              newvalue: Unusable
        -
          uuid: 9369a5ce4f394f2f8a2c2a21d030920c
          name: Self-check
          mappings:
            -
              value: '1'
              newvalue: Working
            -
              value: '0'
              newvalue: 'Not working'
        -
          uuid: 5f43c56d6fde454dbdaf9f8672d1ded8
          name: Tampering
          mappings:
            -
              value: '1'
              newvalue: Tamper
            -
              value: '0'
              newvalue: 'No tamper'
    -
      uuid: 161c4bb799a54116bd8c019a9680a6a7
      template: 'Shelly Motion - MQTT'
      name: 'Shelly Motion - MQTT'
      description: |
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        
      groups:
        -
          name: Shelly
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 0c3b9ccf8b844726b10e2ebbd9387a2d
          name: 'Skipped actions'
          type: DEPENDENT
          key: actions_stats.skipped
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.actions_stats.skipped
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: bfd4d51b60f342b2a5c79c84703ba9fd
              expression: 'change(/Shelly Motion - MQTT/actions_stats.skipped)>0'
              name: 'At least one action has been skipped'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 99c7bd9589814bc0b4f1e91613846c33
          name: 'Battery percentage'
          type: DEPENDENT
          key: bat.value
          delay: '0'
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.bat.value
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Battery
          triggers:
            -
              uuid: 32c4c593558946128bede0a90ef14ec2
              expression: 'last(/Shelly Motion - MQTT/bat.value)<=10'
              name: 'Sensor battery is low'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: System
            -
              uuid: 1bb40a6a17754bcaad3b7c95b63c15b2
              expression: 'last(/Shelly Motion - MQTT/bat.value)>10 and last(/Shelly Motion - MQTT/bat.value)<=20'
              name: 'Sensor battery is low'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 549efb1bb1504d728adb1debf0762895
          name: 'Battery voltage'
          type: DEPENDENT
          key: bat.voltage
          delay: '0'
          value_type: FLOAT
          units: V
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.bat.voltage
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Battery
        -
          uuid: 41f01089f3714e83a29cecdfc6b9a872
          name: 'System configuration changes'
          type: DEPENDENT
          key: cfg_changed_cnt
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cfg_changed_cnt
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 95138ed580b14e3d837e57e4f728ccaf
              expression: 'change(/Shelly Motion - MQTT/cfg_changed_cnt)>0'
              name: 'System configuration has been changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 37825dc185e34e518fc9a4ca6e076c97
          name: 'Charger connected'
          type: DEPENDENT
          key: charger
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.charger
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 9819ec9a9ff840c9b842d1184f0dc32e
          name: 'Cloud connected'
          type: DEPENDENT
          key: cloud.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 33c5849f7d4144dc90c0eac6b622a6c8
              expression: 'change(/Shelly Motion - MQTT/cloud.connected)<>0'
              name: 'Cloud connection state has changed'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 4dfa7550909842c7a06dc7fd0448e4b5
          name: 'Cloud enabled'
          type: DEPENDENT
          key: cloud.enabled
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.enabled
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 67534c87a78c4074b26d74422f070682
              expression: 'change(/Shelly Motion - MQTT/cloud.enabled)<>0'
              name: 'Cloud configuration has changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: d3e4b23003c7415f8bd256f4b0a28ab8
          name: 'File system free size'
          type: DEPENDENT
          key: fs_free
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_free
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 33946e25c42b4fc0a393355905174b65
          name: 'File system total size'
          type: DEPENDENT
          key: fs_size
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_size
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: a7b7e0b77dcb49abbcc86f879c290db3
          name: 'Lux illumination'
          type: DEPENDENT
          key: lux.illumination
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.lux.illumination
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Lux sensor'
        -
          uuid: f6a207578c99445b861d8cad731dcb87
          name: 'Lux sensor self-check'
          type: DEPENDENT
          key: lux.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.lux.is_valid
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Lux sensor'
            -
              tag: Application
              value: Sefl-check
        -
          uuid: eff2eb7166784deb87c1b5fc24f75d7a
          name: 'Lux value'
          type: DEPENDENT
          key: lux.value
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.lux.value
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Lux sensor'
        -
          uuid: 111ed2d90d7949bd867b0242d36cf4b5
          name: 'MQTT connected'
          type: DEPENDENT
          key: mqtt.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.mqtt.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: 8332e83752ed443ab0aba8ab48c97b9b
              expression: 'change(/Shelly Motion - MQTT/mqtt.connected)<>0'
              name: 'MQTT connection state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 9d85d0033e60475fa89ce4a5613644c9
          name: 'Status data'
          type: ZABBIX_ACTIVE
          key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          delay: '0'
          history: 1h
          trends: '0'
          value_type: TEXT
          description: 'Collect data from Shelly device status topic.'
          tags:
            -
              tag: Application
              value: 'Data collection'
          triggers:
            -
              uuid: 9d2c328904564824b2083baca2875f6f
              expression: 'nodata(/Shelly Motion - MQTT/mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}],180s)=1'
              name: 'No data received'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: 'Data collection'
        -
          uuid: d01729798c1e4571b70f5501ea047171
          name: 'RAM free'
          type: DEPENDENT
          key: ram_free
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_free
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: a7cca86a44854a44a2168d5fe337c38a
          name: 'RAM total'
          type: DEPENDENT
          key: ram_total
          delay: '0'
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_total
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 3bc28629a25f4691bcacdc9e38ed0fa4
          name: 'Motion sensor active'
          type: DEPENDENT
          key: sensor.active
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.active
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Motion sensor'
          triggers:
            -
              uuid: 25978a3ce04947b197fa5e6210da29b8
              expression: 'last(/Shelly Motion - MQTT/sensor.active)="true"'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/Shelly Motion - MQTT/sensor.active)="false"'
              name: 'Motion sensor active'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: 'Motion sensor'
        -
          uuid: a5a7a9a20f1d40c18ee3b51fee767515
          name: 'Motion sensor self-check'
          type: DEPENDENT
          key: sensor.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.is_valid
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Motion sensor'
            -
              tag: Application
              value: Sefl-check
        -
          uuid: 799855a06c754124b62129c04e51db33
          name: 'Motion detection'
          type: DEPENDENT
          key: sensor.motion
          delay: '0'
          valuemap:
            name: Motion
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.motion
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Motion sensor'
        -
          uuid: 8053e3caae934b18b1c9312f06bccbb0
          name: 'Tamper detection'
          type: DEPENDENT
          key: sensor.vibration
          delay: '0'
          valuemap:
            name: Tampering
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.sensor.vibration
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: 'Motion sensor'
        -
          uuid: 8979e32eb18646ce87bad3a5f745409c
          name: 'Device time'
          type: DEPENDENT
          key: unixtime
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.unixtime
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: a3c075d1519d453a93eeffe4dd6f85c1
              expression: 'fuzzytime(/Shelly Motion - MQTT/unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 035c00e4aedc4a53995f8a77066ce7bd
          name: 'Update available'
          type: DEPENDENT
          key: update.has_update
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.has_update
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 9b1a6c669de6411ebfed8ee793b9beed
              expression: 'last(/Shelly Motion - MQTT/update.has_update)="true"'
              name: 'Update available'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: a48603a3536643d1bf38298690c410f8
          name: 'Firmware new version'
          type: DEPENDENT
          key: update.new_version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.new_version
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 167f8e60be5744b0a85f9609dd34631b
          name: 'Firmware old version'
          type: DEPENDENT
          key: update.old_version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.old_version
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 893c7fe674c444ad80011d18541dc654
              expression: 'change(/Shelly Motion - MQTT/update.old_version)<>0'
              name: 'Version has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 59e42489916f4185849f8bfa58d22500
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          units: uptime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: de2b7f66d229441480fdc2f39359af33
              expression: 'change(/Shelly Motion - MQTT/uptime)<0'
              name: 'Device has been restarted'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 7287d9c1a7c94a5ab364aa2e3140829d
          name: 'WiFi connected'
          type: DEPENDENT
          key: wifi_sta.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 7557163db8ce4bb292f0e7e262d7ea55
          name: 'WiFi IP'
          type: DEPENDENT
          key: wifi_sta.ip
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ip
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: b2a774d369c54c1c9388ad79aa6b0e48
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: wifi_sta.rssi
          delay: '0'
          value_type: FLOAT
          units: dBm
          valuemap:
            name: 'Received Signal Strength Indicator'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.rssi
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 7c9cbf36eada4b6a91bc2d7ded63841c
          name: 'WiFi SSID'
          type: DEPENDENT
          key: wifi_sta.ssid
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ssid
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$MQTT_BROKER_HOST}'
          value: 'tcp://localhost:1883'
          description: 'MQTT broker host'
        -
          macro: '{$MQTT_BROKER_PASS}'
          type: SECRET_TEXT
          description: 'MQTT broker password, if configured'
        -
          macro: '{$MQTT_BROKER_USER}'
          description: 'MQTT broker user, if configured'
        -
          macro: '{$MQTT_DEVICE_ID}'
          description: 'Shelly device MQTT ID'
      valuemaps:
        -
          uuid: 72537e98ecb741e7805afd7f3d494dfb
          name: Motion
          mappings:
            -
              value: '1'
              newvalue: Motion
            -
              value: '0'
              newvalue: 'No motion'
        -
          uuid: 1e4e762895464e00a3311572e4dfc65f
          name: 'Received Signal Strength Indicator'
          mappings:
            -
              type: GREATER_OR_EQUAL
              value: '-30'
              newvalue: Amazing
            -
              type: GREATER_OR_EQUAL
              value: '-67'
              newvalue: 'Very Good'
            -
              type: GREATER_OR_EQUAL
              value: '-70'
              newvalue: Good
            -
              type: GREATER_OR_EQUAL
              value: '-80'
              newvalue: 'Not Good'
            -
              type: LESS_OR_EQUAL
              value: '-81'
              newvalue: Unusable
        -
          uuid: f09b01e65abe40f3a27976d80ebfec84
          name: Self-check
          mappings:
            -
              value: '1'
              newvalue: Working
            -
              value: '0'
              newvalue: 'Not working'
        -
          uuid: e03b534f829447d395603c7ee1f94527
          name: Tampering
          mappings:
            -
              value: '1'
              newvalue: Tamper
            -
              value: '0'
              newvalue: 'No tamper'
    -
      uuid: 42740ba2769246749725e554c85c1ce4
      template: 'Shelly Plug and Plug-S'
      name: 'Shelly Plug and Plug-S'
      description: |
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        
      templates:
        -
          name: 'Template Module ICMP Ping'
      groups:
        -
          name: Shelly
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 91a3a9b4d6e042d9974f3f6da8533111
          name: 'Skipped actions'
          type: DEPENDENT
          key: actions_stats.skipped
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.actions_stats.skipped
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: ef2ec6de85e04718a580de0137ccde0a
              expression: 'change(/Shelly Plug and Plug-S/actions_stats.skipped)>0'
              name: 'At least one action has been skipped'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 86798a7581e94a3da5de969dfe714c91
          name: 'System configuration changes'
          type: DEPENDENT
          key: cfg_changed_cnt
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cfg_changed_cnt
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 1dea1922d7f34cc891bac891702500ab
              expression: 'change(/Shelly Plug and Plug-S/cfg_changed_cnt)>0'
              name: 'System configuration has been changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: d7d700f5cc23428aa78cba0fb4d5de63
          name: 'Cloud connected'
          type: DEPENDENT
          key: cloud.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 08df627ef0e14dc281a06099f561f9b8
              expression: 'change(/Shelly Plug and Plug-S/cloud.connected)<>0'
              name: 'Cloud connection state has changed'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 85163193a7484dfb90b6ff8b1cc0a038
          name: 'Cloud enabled'
          type: DEPENDENT
          key: cloud.enabled
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.enabled
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 91ae9e1dceeb432e825d458b1ff23625
              expression: 'change(/Shelly Plug and Plug-S/cloud.enabled)<>0'
              name: 'Cloud configuration has changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 70255db192b7468784ef943006118bca
          name: 'File system free size'
          type: DEPENDENT
          key: fs_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_free
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 70b2b8f077ba4d22884f12f6a481ab59
          name: 'File system total size'
          type: DEPENDENT
          key: fs_size
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_size
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 5b8afd21a3684254a62a9b12bf412986
          name: 'Electrometer self-check'
          type: DEPENDENT
          key: meters-0.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: Self-check
        -
          uuid: 48b0d608a6304457900ad74be46115c6
          name: 'Electrometer overpower occurred'
          type: DEPENDENT
          key: meters-0.overpower
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].overpower'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
          triggers:
            -
              uuid: 8bcfea1aa8ee409e992159eb460111bc
              expression: 'last(/Shelly Plug and Plug-S/meters-0.overpower)="true"'
              name: 'Overpower event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 8a6f5a3389bb4a34a64852dcaea9bc4c
          name: 'Electrometer power'
          type: DEPENDENT
          key: meters-0.power
          delay: '0'
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].power'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
        -
          uuid: 927bd642a38a4aca92f013539befec6d
          name: 'Electrometer total consumed'
          type: DEPENDENT
          key: meters-0.total
          delay: '0'
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].total'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Electrometer
        -
          uuid: 1fd6f125271642acb5dd4aa4cc938f47
          name: 'MQTT connected'
          type: DEPENDENT
          key: mqtt.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.mqtt.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: bde85e437d734a91ad6066451590d451
              expression: 'change(/Shelly Plug and Plug-S/mqtt.connected)<>0'
              name: 'MQTT connection state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: cd8d3212af3840c7913fa1a3b6ce1d0d
          name: 'Device overtemperature occurred'
          type: DEPENDENT
          key: overtemperature
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.overtemperature
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Temperature
          triggers:
            -
              uuid: 5fbc7758a5244056af7c583eb646f4e4
              expression: 'last(/Shelly Plug and Plug-S/overtemperature)="true"'
              name: 'Overtemperature event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Temperature
        -
          uuid: c9e1f361ece24579b7104d8279813bdc
          name: 'RAM free'
          type: DEPENDENT
          key: ram_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_free
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: fe87dfe1292749278da40e85afe49354
          name: 'RAM total'
          type: DEPENDENT
          key: ram_total
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_total
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 648a71b874f948c28391fad1b9b64416
          name: 'Relay has timer'
          type: DEPENDENT
          key: relays-0.has_timer
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].has_timer'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 786f236af2b84d0f943121b407586854
          name: 'Relay turned on'
          type: DEPENDENT
          key: relays-0.ison
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].ison'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: 346502b7bec243288ed9c88c04879cbc
              expression: 'change(/Shelly Plug and Plug-S/relays-0.ison)<>0'
              name: 'Relay state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: ee5a0c03b9aa4679befaa0540d9b9bc9
          name: 'Relay overpower occurred'
          type: DEPENDENT
          key: relays-0.overpower
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].overpower'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: d35da485f66644a3bf8edfacaa45c76b
              expression: 'last(/Shelly Plug and Plug-S/relays-0.overpower)="true"'
              name: 'Overpower event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 76c73cc4c4db43dd902804bdb4ca1a8e
          name: 'Relays last command source'
          type: DEPENDENT
          key: relays-0.source
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].source'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: b2d9605591e545fdb129785e2514a381
          name: 'Relay timer duration'
          type: DEPENDENT
          key: relays-0.timer_duration
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_duration'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 11363348cce14f26b3df57f983f89fa3
          name: 'Relay timer remaining'
          type: DEPENDENT
          key: relays-0.timer_remaining
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_remaining'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 988dc400cb2b449cbff9b5df6c29f80d
          name: 'Relay timer started'
          type: DEPENDENT
          key: relays-0.timer_started
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_started'
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: bee23426b54245b1a19ad658b67d8b6c
          name: 'Status data'
          type: HTTP_AGENT
          key: status
          delay: '30'
          history: 1h
          trends: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$SHELLY_USER}'
          password: '{$SHELLY_PASS}'
          description: 'Collect data from Shelly device status API.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.body
          url: 'http://{HOST.IP}/status'
          follow_redirects: 'NO'
          output_format: JSON
          tags:
            -
              tag: Application
              value: 'Data collection'
          triggers:
            -
              uuid: 0f12dac3e7ab450d93a2162a3d4dcbad
              expression: 'nodata(/Shelly Plug and Plug-S/status,120s)=1'
              name: 'No data received'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: 'Data collection'
        -
          uuid: 6e62338a33f44024a19caaf980332d06
          name: 'Temperature self-check'
          type: DEPENDENT
          key: tmp.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.tmp.is_valid
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Self-check
            -
              tag: Application
              value: Temperature
        -
          uuid: 51bf83593a26418d95ae113d80b6352d
          name: 'Temperature in Celsius'
          type: DEPENDENT
          key: tmp.tC
          delay: '0'
          value_type: FLOAT
          units: C
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.tmp.tC
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Temperature
        -
          uuid: f5c54d9efa124b90b8a669d7f4e74cd9
          name: 'Temperature in Fahrenheit'
          type: DEPENDENT
          key: tmp.tF
          delay: '0'
          value_type: FLOAT
          units: F
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.tmp.tF
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: Temperature
        -
          uuid: f384c05104a04255b1c45eae4d4ccefd
          name: 'Device time'
          type: DEPENDENT
          key: unixtime
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.unixtime
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 3d82b0ea7ca94ab9bc315499b6664cae
              expression: 'fuzzytime(/Shelly Plug and Plug-S/unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 49596ea9fdf14dd0995948b53cf22066
          name: 'Update available'
          type: DEPENDENT
          key: update.has_update
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.has_update
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: d538eeb87492428cb6347c4d5fa3482f
              expression: 'last(/Shelly Plug and Plug-S/update.has_update)="true"'
              name: 'Update available'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 5e8b1885642c45ba9a03d1f8a23efb32
          name: 'Firmware new version'
          type: DEPENDENT
          key: update.new_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.new_version
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 9764737b1140495c96042c8d4b5a5a7f
          name: 'Firmware old version'
          type: DEPENDENT
          key: update.old_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.old_version
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 7ddaa3818c234968a25381497fc8e71c
              expression: 'change(/Shelly Plug and Plug-S/update.old_version)<>0'
              name: 'Version has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 22423744cd0d40f694acfde3fe9c98c2
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 10d
          units: uptime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 38438df02abe47ca8ca10675624b615a
              expression: 'change(/Shelly Plug and Plug-S/uptime)<0'
              name: 'Device has been restarted'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 7fec7a57b4a54af3a4f87c53fe5bee06
          name: 'WiFi connected'
          type: DEPENDENT
          key: wifi_sta.connected
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.connected
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 06850685459e43a899c163c7b6dcb553
          name: 'WiFi IP'
          type: DEPENDENT
          key: wifi_sta.ip
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ip
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 8ae762bd211a444fb8c12ed786bf6ae6
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: wifi_sta.rssi
          delay: '0'
          history: 10d
          value_type: FLOAT
          units: dBm
          valuemap:
            name: 'Received Signal Strength Indicator'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.rssi
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 8103f845df5d40479c0dd3f933fa61cf
          name: 'WiFi SSID'
          type: DEPENDENT
          key: wifi_sta.ssid
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ssid
          master_item:
            key: status
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$SHELLY_PASS}'
          type: SECRET_TEXT
          description: 'Device password, if configured'
        -
          macro: '{$SHELLY_USER}'
          value: admin
          description: 'Device user, if configured'
      valuemaps:
        -
          uuid: 89a0bf3bd4ad4ff097c9ccd100e361d2
          name: 'Received Signal Strength Indicator'
          mappings:
            -
              type: GREATER_OR_EQUAL
              value: '-30'
              newvalue: Amazing
            -
              type: GREATER_OR_EQUAL
              value: '-67'
              newvalue: 'Very Good'
            -
              type: GREATER_OR_EQUAL
              value: '-70'
              newvalue: Good
            -
              type: GREATER_OR_EQUAL
              value: '-80'
              newvalue: 'Not Good'
            -
              type: LESS_OR_EQUAL
              value: '-81'
              newvalue: Unusable
        -
          uuid: c5c4dc08a6114690af2e1f7e30a2114a
          name: Self-check
          mappings:
            -
              value: '1'
              newvalue: Working
            -
              value: '0'
              newvalue: 'Not working'
    -
      uuid: 225341e8812846f684a475d8bf8c0e11
      template: 'Shelly Plug and Plug-S - MQTT'
      name: 'Shelly Plug and Plug-S - MQTT'
      description: |
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        ## Overview
        
        List of supported Shelly devices:
        
        
        * Shelly 3EM
        * Shelly Plug and Plug-S
        * Shelly Motion
        * more to come (I hope)...
        
        
        Each device has two templates to choose from, one is using HTTP calls to collect device information from API status page and other is collecting device information from MQTT broker "shellies/*/info" topic. Templates were tested and created on Zabbix version 5.4 but some other versions will most likely work as well.
        
        
        For more information and configuration information see [README.md](https://github.com/UniverseDevel/zabbix-templates/tree/main/shelly) at GitHub repo. All templates can be downloaded here as a single file or separate templates are available on GitHub.
        
        
        
        ## Author
        
        Martin Suchy
        
        
      groups:
        -
          name: Shelly
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 330d1809adb14dca931a33e91e17715d
          name: 'Skipped actions'
          type: DEPENDENT
          key: actions_stats.skipped
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.actions_stats.skipped
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 255fb503e873486d995a5a8f35b1fe42
              expression: 'change(/Shelly Plug and Plug-S - MQTT/actions_stats.skipped)>0'
              name: 'At least one action has been skipped'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 56415c86b7e546b2802edd7b84c60ec9
          name: 'System configuration changes'
          type: DEPENDENT
          key: cfg_changed_cnt
          delay: '0'
          history: 10d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cfg_changed_cnt
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 79f27555e7744f439b8b6b17e4456165
              expression: 'change(/Shelly Plug and Plug-S - MQTT/cfg_changed_cnt)>0'
              name: 'System configuration has been changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: e5d9bd923b8c4ae99717b3ee3bcf7cf5
          name: 'Cloud connected'
          type: DEPENDENT
          key: cloud.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 066c3e4e07ff43dbb60a7f3d3606af2c
              expression: 'change(/Shelly Plug and Plug-S - MQTT/cloud.connected)<>0'
              name: 'Cloud connection state has changed'
              priority: AVERAGE
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 1813d96eeac34855946ac4ded881267c
          name: 'Cloud enabled'
          type: DEPENDENT
          key: cloud.enabled
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.cloud.enabled
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Cloud
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 69b1dfe576ba41d584c9ff972d0670bf
              expression: 'change(/Shelly Plug and Plug-S - MQTT/cloud.enabled)<>0'
              name: 'Cloud configuration has changed'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: Cloud
                -
                  tag: Application
                  value: System
        -
          uuid: 48d85cf2c56e4ed1905fd33557d23397
          name: 'File system free size'
          type: DEPENDENT
          key: fs_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_free
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 3d5fa9dc2f3d4be5870f0b77ffb57bd4
          name: 'File system total size'
          type: DEPENDENT
          key: fs_size
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.fs_size
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 08c1ad0483cb4d5db0e99caafb365822
          name: 'Electrometer self-check'
          type: DEPENDENT
          key: meters-0.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].is_valid'
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
            -
              tag: Application
              value: Self-check
        -
          uuid: a11e22358b864304871a946147073859
          name: 'Electrometer overpower occurred'
          type: DEPENDENT
          key: meters-0.overpower
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].overpower'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
          triggers:
            -
              uuid: a42d14f3658448fbbf1fd25fac2d356a
              expression: 'last(/Shelly Plug and Plug-S - MQTT/meters-0.overpower)="true"'
              name: 'Overpower event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: aadf8d0b23374d9fbdf0f3fab21dfcb8
          name: 'Electrometer power'
          type: DEPENDENT
          key: meters-0.power
          delay: '0'
          value_type: FLOAT
          units: W
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].power'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
        -
          uuid: 4662338f6cba40a88f35cee6a0ed5379
          name: 'Electrometer total consumed'
          type: DEPENDENT
          key: meters-0.total
          delay: '0'
          value_type: FLOAT
          units: Wh
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.meters[0].total'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Electrometer
        -
          uuid: 5349d53df71c4d9b96927926e4e7680c
          name: 'MQTT connected'
          type: DEPENDENT
          key: mqtt.connected
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.mqtt.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: MQTT
          triggers:
            -
              uuid: 6e22c44186c34eb9bab66152c29f1eca
              expression: 'change(/Shelly Plug and Plug-S - MQTT/mqtt.connected)<>0'
              name: 'MQTT connection state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 80d059ecd4234b2eace45e651455b26d
          name: 'Status data'
          type: ZABBIX_ACTIVE
          key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          delay: '0'
          history: 1h
          trends: '0'
          value_type: TEXT
          description: 'Collect data from Shelly device status topic.'
          tags:
            -
              tag: Application
              value: 'Data collection'
          triggers:
            -
              uuid: 75de9ddcb1af4cd4b72a3341b14decae
              expression: 'nodata(/Shelly Plug and Plug-S - MQTT/mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}],120s)=1'
              name: 'No data received'
              priority: HIGH
              tags:
                -
                  tag: Application
                  value: 'Data collection'
        -
          uuid: 2f4bb70085f6489ca8012e3809a3b68c
          name: 'Device overtemperature occurred'
          type: DEPENDENT
          key: overtemperature
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.overtemperature
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Temperature
          triggers:
            -
              uuid: 7e4902e68934486b91158e294b41452d
              expression: 'last(/Shelly Plug and Plug-S - MQTT/overtemperature)="true"'
              name: 'Overtemperature event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Temperature
        -
          uuid: f9fdfb57ea404f7f8ec4651931f4845d
          name: 'RAM free'
          type: DEPENDENT
          key: ram_free
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_free
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: dccd1f2d8a644a9fa995e26f4622224b
          name: 'RAM total'
          type: DEPENDENT
          key: ram_total
          delay: '0'
          history: 10d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.ram_total
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 9567db9ca7c04e58aa55ae438c88e2a6
          name: 'Relay has timer'
          type: DEPENDENT
          key: relays-0.has_timer
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].has_timer'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: a212f8c7dd1d4ebd87e426ec0e9d9e0d
          name: 'Relay turned on'
          type: DEPENDENT
          key: relays-0.ison
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].ison'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: 934856a143e247e9abfb46ee6da84d6d
              expression: 'change(/Shelly Plug and Plug-S - MQTT/relays-0.ison)<>0'
              name: 'Relay state has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 9f836949df92403fa95b743411cd6e61
          name: 'Relay overpower occurred'
          type: DEPENDENT
          key: relays-0.overpower
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].overpower'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
          triggers:
            -
              uuid: fe24da85a7fa4eea8091a8a408ac4ddf
              expression: 'last(/Shelly Plug and Plug-S - MQTT/relays-0.overpower)="true"'
              name: 'Overpower event has been detected'
              priority: DISASTER
              tags:
                -
                  tag: Application
                  value: Relay
        -
          uuid: 9001301e669444deac2b66b5ff8d0e96
          name: 'Relays last command source'
          type: DEPENDENT
          key: relays-0.source
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].source'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: b7e871ecaee249f9a63cb1f90c93501b
          name: 'Relay timer duration'
          type: DEPENDENT
          key: relays-0.timer_duration
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_duration'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: df1463c584a443bfbc11e4560fd8f8e0
          name: 'Relay timer remaining'
          type: DEPENDENT
          key: relays-0.timer_remaining
          delay: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_remaining'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 1a96f51bbcdc43f987a32a3d965ec33e
          name: 'Relay timer started'
          type: DEPENDENT
          key: relays-0.timer_started
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.relays[0].timer_started'
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Relay
        -
          uuid: 28ddcd40a68447a1b5ff8d2a665c96c2
          name: 'Temperature self-check'
          type: DEPENDENT
          key: tmp.is_valid
          delay: '0'
          valuemap:
            name: Self-check
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.tmp.is_valid
            -
              type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Self-check
            -
              tag: Application
              value: Temperature
        -
          uuid: 05f1aa3437f542efba1859197ab4fa9c
          name: 'Temperature in Celsius'
          type: DEPENDENT
          key: tmp.tC
          delay: '0'
          value_type: FLOAT
          units: C
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.tmp.tC
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Temperature
        -
          uuid: eaa1657c3f1147768378107065288e8e
          name: 'Temperature in Fahrenheit'
          type: DEPENDENT
          key: tmp.tF
          delay: '0'
          value_type: FLOAT
          units: F
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.tmp.tF
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: Temperature
        -
          uuid: 39e4e3f9bf0d462cb495311ddb7a0a92
          name: 'Device time'
          type: DEPENDENT
          key: unixtime
          delay: '0'
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.unixtime
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 12efd2daf76f4e8699ddf911b7ab859f
              expression: 'fuzzytime(/Shelly Plug and Plug-S - MQTT/unixtime,60s)=0'
              name: 'Time is out of sync'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: a0ca56e615a64e56bb2ac4ae474bd304
          name: 'Update available'
          type: DEPENDENT
          key: update.has_update
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.has_update
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 7cb08a0449734f81aa4eb3419edc858d
              expression: 'last(/Shelly Plug and Plug-S - MQTT/update.has_update)="true"'
              name: 'Update available'
              priority: INFO
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 133ad50ecd344a40825e252605af744d
          name: 'Firmware new version'
          type: DEPENDENT
          key: update.new_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.new_version
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
        -
          uuid: 2475b41aa3914e79992aa871df0cee0d
          name: 'Firmware old version'
          type: DEPENDENT
          key: update.old_version
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.update.old_version
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 70fc06cd03914e9fa02d295db3e0380f
              expression: 'change(/Shelly Plug and Plug-S - MQTT/update.old_version)<>0'
              name: 'Version has changed'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 0995316d88c64692a39e7e3cf5dc5c6b
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 10d
          units: uptime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
          triggers:
            -
              uuid: 02f35b7bfbf34a0ca7d5b2dd6da96430
              expression: 'change(/Shelly Plug and Plug-S - MQTT/uptime)<0'
              name: 'Device has been restarted'
              priority: WARNING
              tags:
                -
                  tag: Application
                  value: System
        -
          uuid: 851ee3e1108e4cf98e02d2593cb9cc91
          name: 'WiFi connected'
          type: DEPENDENT
          key: wifi_sta.connected
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.connected
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: 5a86cfa8c61a42c9a5837f8e6cfa833e
          name: 'WiFi IP'
          type: DEPENDENT
          key: wifi_sta.ip
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ip
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: ef6dde355c4947dc9f69d8515c8b162b
          name: 'WiFi RSSI'
          type: DEPENDENT
          key: wifi_sta.rssi
          delay: '0'
          history: 10d
          value_type: FLOAT
          units: dBm
          valuemap:
            name: 'Received Signal Strength Indicator'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.rssi
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
        -
          uuid: de7f088c6c5e42c6b77b30525a88ce72
          name: 'WiFi SSID'
          type: DEPENDENT
          key: wifi_sta.ssid
          delay: '0'
          history: 10d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.wifi_sta.ssid
          master_item:
            key: 'mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]'
          tags:
            -
              tag: Application
              value: System
            -
              tag: Application
              value: WiFi
      macros:
        -
          macro: '{$MQTT_BROKER_HOST}'
          value: 'tcp://localhost:1883'
          description: 'MQTT broker host'
        -
          macro: '{$MQTT_BROKER_PASS}'
          type: SECRET_TEXT
          description: 'MQTT broker password, if configured'
        -
          macro: '{$MQTT_BROKER_USER}'
          description: 'MQTT broker user, if configured'
        -
          macro: '{$MQTT_DEVICE_ID}'
          description: 'Shelly device MQTT ID'
      valuemaps:
        -
          uuid: 66528c50ab8545a594ad0a057ddbb4a0
          name: 'Received Signal Strength Indicator'
          mappings:
            -
              type: GREATER_OR_EQUAL
              value: '-30'
              newvalue: Amazing
            -
              type: GREATER_OR_EQUAL
              value: '-67'
              newvalue: 'Very Good'
            -
              type: GREATER_OR_EQUAL
              value: '-70'
              newvalue: Good
            -
              type: GREATER_OR_EQUAL
              value: '-80'
              newvalue: 'Not Good'
            -
              type: LESS_OR_EQUAL
              value: '-81'
              newvalue: Unusable
        -
          uuid: 625274c7a7884238bd32c6289b1483e3
          name: Self-check
          mappings:
            -
              value: '1'
              newvalue: Working
            -
              value: '0'
              newvalue: 'Not working'
    -
      uuid: 37e5eb5606bc4abba66c8b20381a1e8a
      template: 'Template Module ICMP Ping'
      name: 'Template Module ICMP Ping'
      description: 'Template Module ICMP Ping version: 0.12'
      groups:
        -
          name: Templates/Modules
      items:
        -
          uuid: db5a94f6cea14deba957202b2f014469
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          delay: '60'
          history: 1w
          valuemap:
            name: 'Service state'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: b030876299434f3ba43e11c584104a81
              expression: 'max(/Template Module ICMP Ping/icmpping,#3)=0'
              name: 'Unavailable by ICMP ping'
              priority: HIGH
              description: |
                Last value: {ITEM.LASTVALUE1}.
                Last three attempts returned timeout.  Please check device connectivity.
        -
          uuid: 04b21adaf422473a88df2c52786474ed
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          delay: '60'
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: 42c4b0310aaf4b9c8cb502542b7dea90
              expression: 'min(/Template Module ICMP Ping/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Template Module ICMP Ping/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              priority: WARNING
              dependencies:
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Module ICMP Ping/icmpping,#3)=0'
        -
          uuid: a79e33e5fd264725b934f603fa071555
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          delay: '60'
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: 32b4d8f3eba34bd380803410111d4b7f
              expression: 'avg(/Template Module ICMP Ping/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              priority: WARNING
              dependencies:
                -
                  name: 'High ICMP ping loss'
                  expression: 'min(/Template Module ICMP Ping/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Template Module ICMP Ping/icmppingloss,5m)<100'
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Module ICMP Ping/icmpping,#3)=0'
      macros:
        -
          macro: '{$ICMP_LOSS_WARN}'
          value: '20'
        -
          macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
      valuemaps:
        -
          uuid: bdb5d65d925542eaa61c302dc40fbfe8
          name: 'Service state'
          mappings:
            -
              value: '0'
              newvalue: Down
            -
              value: '1'
              newvalue: Up
  triggers:
    -
      uuid: 74d8fe16f2764d31a003c8afed9e360c
      expression: 'last(/Shelly Motion - MQTT/sensor.motion)=1'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'sum(/Shelly Motion - MQTT/sensor.motion,10m)=0 or last(/Shelly Motion - MQTT/sensor.active)="false"'
      name: 'Motion detected'
      priority: HIGH
      tags:
        -
          tag: Application
          value: 'Motion sensor'
    -
      uuid: 71c7888b78754f749eba7cdc6da77e13
      expression: 'last(/Shelly Motion/sensor.motion)=1'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'sum(/Shelly Motion/sensor.motion,10m)=0 or last(/Shelly Motion/sensor.active)="false"'
      name: 'Motion detected'
      priority: HIGH
      tags:
        -
          tag: Application
          value: 'Motion sensor'
    -
      uuid: 3446d37ebd4f4aa4a71f7235b5e58ef5
      expression: 'last(/Shelly 3EM - MQTT/fs_free)>=last(/Shelly 3EM - MQTT/fs_size)*0.8 and last(/Shelly 3EM - MQTT/fs_free)<last(/Shelly 3EM - MQTT/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 6c731f22b342478ab8e1a3e92503a9c6
      expression: 'last(/Shelly 3EM - MQTT/fs_free)>=last(/Shelly 3EM - MQTT/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 0cdc792f96b94ae89a56ba75cdda716c
      expression: 'last(/Shelly 3EM/fs_free)>=last(/Shelly 3EM/fs_size)*0.8 and last(/Shelly 3EM/fs_free)<last(/Shelly 3EM/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 3e1fe8780db745fc93cc1d25a4b5e504
      expression: 'last(/Shelly 3EM/fs_free)>=last(/Shelly 3EM/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 8cf9c39a72d846139565b5577f296da3
      expression: 'last(/Shelly Motion - MQTT/fs_free)>=last(/Shelly Motion - MQTT/fs_size)*0.8 and last(/Shelly Motion - MQTT/fs_free)<last(/Shelly Motion - MQTT/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: f53b6b1333e346e4b5356fdfb6a4163c
      expression: 'last(/Shelly Motion - MQTT/fs_free)>=last(/Shelly Motion - MQTT/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: d2bfc3c5b2ab4b24b81f40142d9ae9e5
      expression: 'last(/Shelly Motion/fs_free)>=last(/Shelly Motion/fs_size)*0.8 and last(/Shelly Motion/fs_free)<last(/Shelly Motion/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 19efb44f5a574a268205631f8f15ecd0
      expression: 'last(/Shelly Motion/fs_free)>=last(/Shelly Motion/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 911a6f09a42449259ea48f524a488532
      expression: 'last(/Shelly Plug and Plug-S - MQTT/fs_free)>=last(/Shelly Plug and Plug-S - MQTT/fs_size)*0.8 and last(/Shelly Plug and Plug-S - MQTT/fs_free)<last(/Shelly Plug and Plug-S - MQTT/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 0857f26833f34ee18cab5f256cded41a
      expression: 'last(/Shelly Plug and Plug-S - MQTT/fs_free)>=last(/Shelly Plug and Plug-S - MQTT/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 05bbe39f9fba4ea48985f2d8940d6353
      expression: 'last(/Shelly Plug and Plug-S/fs_free)>=last(/Shelly Plug and Plug-S/fs_size)*0.8 and last(/Shelly Plug and Plug-S/fs_free)<last(/Shelly Plug and Plug-S/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: a8f26ba02be4485aaadbd07ab0a8da73
      expression: 'last(/Shelly Plug and Plug-S/fs_free)>=last(/Shelly Plug and Plug-S/fs_size)*0.9'
      name: 'Sensor file system space is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 20b7fccb6c524d659532c95535a89417
      expression: 'last(/Shelly 3EM - MQTT/ram_free)>=last(/Shelly 3EM - MQTT/ram_total)*0.8 and last(/Shelly 3EM - MQTT/ram_free)<last(/Shelly 3EM - MQTT/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 161510decc764d2ab5d79930c617df22
      expression: 'last(/Shelly 3EM - MQTT/ram_free)>=last(/Shelly 3EM - MQTT/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: eadb1851b212499890689498226b474c
      expression: 'last(/Shelly 3EM/ram_free)>=last(/Shelly 3EM/ram_total)*0.8 and last(/Shelly 3EM/ram_free)<last(/Shelly 3EM/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 0b5c883005824f4db490922adc4a0022
      expression: 'last(/Shelly 3EM/ram_free)>=last(/Shelly 3EM/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 2d56f585ccd7473a821f07adfe4f8c60
      expression: 'last(/Shelly Motion - MQTT/ram_free)>=last(/Shelly Motion - MQTT/ram_total)*0.8 and last(/Shelly Motion - MQTT/ram_free)<last(/Shelly Motion - MQTT/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 5e9ed487d0f242328dbd7f702db79cfb
      expression: 'last(/Shelly Motion - MQTT/ram_free)>=last(/Shelly Motion - MQTT/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: c8f6a50672b84bdc8246adaf6d6b7cae
      expression: 'last(/Shelly Motion/ram_free)>=last(/Shelly Motion/ram_total)*0.8 and last(/Shelly Motion/ram_free)<last(/Shelly Motion/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: d85269fa1e7840c7adabcf79fef4414f
      expression: 'last(/Shelly Motion/ram_free)>=last(/Shelly Motion/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: bd73054483994cf19264e2ca6551d4c7
      expression: 'last(/Shelly Plug and Plug-S - MQTT/ram_free)>=last(/Shelly Plug and Plug-S - MQTT/ram_total)*0.8 and last(/Shelly Plug and Plug-S - MQTT/ram_free)<last(/Shelly Plug and Plug-S - MQTT/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 41368409cb474c7cae715a44839dcc4c
      expression: 'last(/Shelly Plug and Plug-S - MQTT/ram_free)>=last(/Shelly Plug and Plug-S - MQTT/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 6eb55f0c6f6743b48c5525335da16a57
      expression: 'last(/Shelly Plug and Plug-S/ram_free)>=last(/Shelly Plug and Plug-S/ram_total)*0.8 and last(/Shelly Plug and Plug-S/ram_free)<last(/Shelly Plug and Plug-S/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: WARNING
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 6ae12da8db5e475db8e8e4b6d6220420
      expression: 'last(/Shelly Plug and Plug-S/ram_free)>=last(/Shelly Plug and Plug-S/ram_total)*0.9'
      name: 'Sensor memory is low'
      status: DISABLED
      priority: AVERAGE
      tags:
        -
          tag: Application
          value: System
    -
      uuid: 93ffcaf61d5e4017b4fb2c83c9bb4670
      expression: 'last(/Shelly Motion - MQTT/sensor.vibration)=1 and last(/Shelly Motion - MQTT/sensor.active)="true"'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'sum(/Shelly Motion - MQTT/sensor.vibration,10m)=0 or last(/Shelly Motion - MQTT/sensor.active)="false"'
      name: 'Tampering detected'
      priority: HIGH
      tags:
        -
          tag: Application
          value: 'Motion sensor'
    -
      uuid: c3d1e7a6d70f4a35946c8c734af6a1f6
      expression: 'last(/Shelly Motion/sensor.vibration)=1 and last(/Shelly Motion/sensor.active)="true"'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'sum(/Shelly Motion/sensor.vibration,10m)=0 or last(/Shelly Motion/sensor.active)="false"'
      name: 'Tampering detected'
      priority: HIGH
      tags:
        -
          tag: Application
          value: 'Motion sensor'
  graphs:
    -
      uuid: d37485c728f14dc6afd45ccbf80d0089
      name: 'Total power consumption'
      graph_items:
        -
          sortorder: '1'
          color: 6C59DC
          item:
            host: 'Shelly 3EM'
            key: total_power
        -
          sortorder: '2'
          color: C7A72D
          item:
            host: 'Shelly 3EM'
            key: emeters-0.power
        -
          sortorder: '3'
          color: BA2A5D
          item:
            host: 'Shelly 3EM'
            key: emeters-1.power
        -
          sortorder: '4'
          color: F230E0
          item:
            host: 'Shelly 3EM'
            key: emeters-2.power
        -
          sortorder: '5'
          color: 5CCD18
          item:
            host: 'Shelly 3EM'
            key: emeters-3.power
    -
      uuid: 694a682d2d5b487c959f65810a9171ea
      name: 'Total power consumption'
      graph_items:
        -
          sortorder: '1'
          color: 6C59DC
          item:
            host: 'Shelly 3EM - MQTT'
            key: total_power
        -
          sortorder: '2'
          color: C7A72D
          item:
            host: 'Shelly 3EM - MQTT'
            key: emeters-0.power
        -
          sortorder: '3'
          color: BA2A5D
          item:
            host: 'Shelly 3EM - MQTT'
            key: emeters-1.power
        -
          sortorder: '4'
          color: F230E0
          item:
            host: 'Shelly 3EM - MQTT'
            key: emeters-2.power
        -
          sortorder: '5'
          color: 5CCD18
          item:
            host: 'Shelly 3EM - MQTT'
            key: emeters-3.power
