zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 7df96b18c230490a9a0a9e2307226333
      name: Templates
  templates:
    - uuid: 9ad700221fc44abfbf487472afa7ade9
      template: 'Cisco Catalyst 9800 RESTCONF'
      name: 'Cisco Catalyst 9800 RESTCONF'
      description: |
        Zabbix Template for Cisco Catalyst 9800 Series Wireless Controller
        
        OVERVIEW
        This template adopts a hybrid approach, leveraging RESTCONF for efficient, high-performance data collection while retaining SNMP Traps for real-time alerting.
        This design addresses performance issues often observed with SNMPv3 encryption by offloading statistical data retrieval to the lightweight RESTCONF API.
        
        KEY FEATURES
        - Performance & Security: Utilizes RESTCONF (HTTP Agent) for efficient data retrieval over HTTPS.
        - High Availability (HA) Monitoring: Tracks SSO status, peer state (Standby Hot), and switchover reasons.
        - Mobility Monitoring: Tracks mobility tunnel status and group members.
        - Smart AP Radio Discovery: Dynamically detects and maps radio slots to their actual frequency bands (2.4GHz / 5GHz / 6GHz), supporting XOR radios and Wi-Fi 6E.
        - WLAN/SSID Statistics: Monitors client counts per SSID.
        - Rogue Monitoring: Tracks total counts of Rogue APs and clients.
        - Hybrid Alerting: Uses SNMP Traps for real-time events (DFS Radar, AP Disassociation) while using RESTCONF for metrics.
        
        REQUIREMENTS
        - Device: Cisco Catalyst 9800 Series (IOS XE 16.10 or later recommended)
        - Configuration: "restconf" and "ip http secure-server" must be enabled
        - Zabbix: Version 7.0 or later
        
        SETUP
        1. Enable RESTCONF on the WLC.
        2. Set the {$RESTCONF.USER} and {$RESTCONF.PASS} macros.
        3. Ensure the host interface is configured correctly for connection.
        
        NOTE
        While this template monitors WLC-specific resources, it is recommended to use the standard "Cisco IOS by SNMP" template for monitoring physical network interfaces.
        
        ## AUTHOR
        Hideaki Shimomura @hshimomura
      groups:
        - name: Templates
      items:
        - uuid: 3f28c62f21984934811c6cff974c7465
          name: 'Total Joined AP Count'
          type: HTTP_AGENT
          key: cisco.ap.total
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-rogue-oper:rogue-oper-data/rogue-stats/total-client-count'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-wireless-access-point-oper:ap-name-mac-map''].length()'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/ap-name-mac-map'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: 27c818b04850469a8290434c7ce1b17c
          name: 'HA Local State'
          type: DEPENDENT
          key: cisco.ha.local.state
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-ha-oper:ha-infra''][''ha-state'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '86400'
          master_item:
            key: cisco.ha.stats.master
        - uuid: 9ac4e07ae4e54d18b41c47f56e114f8b
          name: 'HA Peer State'
          type: DEPENDENT
          key: cisco.ha.peer.state
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-ha-oper:ha-infra''][''peer-state'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '86400'
          master_item:
            key: cisco.ha.stats.master
          triggers:
            - uuid: e8428fb3f86748b4bacce1449d49209b
              expression: 'last(/Cisco Catalyst 9800 RESTCONF/cisco.ha.peer.state) <> "db-rf-standby-hot"'
              name: 'HA Peer is NOT Standby Hot (Risk of HA Failure)'
              priority: HIGH
              description: 'The peer is not in the ''Standby Hot'' state (e.g., Disabled, Unknown, Standby Cold). Proper failover may not be possible in the event of a failure'
              manual_close: 'YES'
        - uuid: 6f9a21d2d228432bbe89ca85c3ef36b9
          name: 'WLC HA Stats Master'
          type: HTTP_AGENT
          key: cisco.ha.stats.master
          history: '0'
          value_type: TEXT
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-ha-oper:ha-oper-data/ha-infra'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-ha-oper:ha-oper-data/ha-infra'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: 25200264ec524ea0b6831a671fc98888
          name: 'HA Last Switchover Reason'
          type: DEPENDENT
          key: cisco.ha.switchover.reason
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-ha-oper:ha-infra''][''last-switchover-reason'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '86400'
          master_item:
            key: cisco.ha.stats.master
        - uuid: 14ae264ac128429f936f4e6cb8140c3e
          name: 'WLC RRM Stats Master'
          type: HTTP_AGENT
          key: cisco.iosxe.rrm.master
          delay: 3m
          history: '0'
          value_type: TEXT
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-rrm-oper:rrm-oper-data/rrm-measurement'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-rrm-oper:rrm-oper-data/rrm-measurement'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: 3b0d822db8db4c8b9e99238232d73b9e
          name: 'WLC Mobility Stats Master'
          type: HTTP_AGENT
          key: cisco.mobility.stats.master
          history: '0'
          value_type: TEXT
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-mobility-oper:mobility-node-data'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-mobility-oper:mobility-oper-data/mobility-node-data'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: ae57fd378e9b4871880cf8426a4d9dee
          name: 'WLC Radio Config Master'
          type: HTTP_AGENT
          key: cisco.radio.cfg.master
          delay: 15m
          history: '0'
          value_type: TEXT
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/radio-oper-data'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/radio-oper-data'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: 3596528aa4d1489d80c6d2e09b2d780f
          name: 'Rogue AP: Total Count'
          type: HTTP_AGENT
          key: cisco.rogue.ap.total
          delay: 3m
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-rogue-oper:rogue-oper-data/rogue-stats/total-count'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-wireless-rogue-oper:total-count'']'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-rogue-oper:rogue-oper-data/rogue-stats/total-count'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: 687c8809fa374bfabe307abfb27d5e18
          name: 'Rogue AP: Total Client Count'
          type: HTTP_AGENT
          key: cisco.rogue.client.total
          delay: 3m
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-rogue-oper:rogue-oper-data/rogue-stats/total-client-count'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-wireless-rogue-oper:total-client-count'']'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-rogue-oper:rogue-oper-data/rogue-stats/total-client-count'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: d20fb16e3174428a85eb45fddbd1c121
          name: 'WLC AP Master'
          type: HTTP_AGENT
          key: cisco.rrm.stats.master
          delay: 15m
          history: '0'
          value_type: TEXT
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/ap-name-mac-map'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/ap-name-mac-map'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: c34798e5fae6438b816ef27908220a15
          name: 'WLC WLAN Stats Master'
          type: HTTP_AGENT
          key: cisco.wlan.stats.master
          delay: 3m
          history: '0'
          value_type: TEXT
          trends: '0'
          authtype: BASIC
          username: '{$RESTCONF.USER}'
          password: '{$RESTCONF.PASS}'
          description: 'Cisco-IOS-XE-wireless-wlan-global-oper:wlan-global-oper-data/wlan-info'
          url: 'https://{HOST.CONN}/restconf/data/Cisco-IOS-XE-wireless-wlan-global-oper:wlan-global-oper-data/wlan-info'
          headers:
            - name: accept
              value: application/yang-data+json
        - uuid: c181e23106714997a8719d158c57ee11
          name: 'SNMP Trap - Channel Changed'
          type: SNMP_TRAP
          key: 'snmptrap["SNMPv2-SMI::enterprises.14179.2.6.3.16|bsnAPCurrentChannelChanged$"]'
          delay: '0'
          value_type: LOG
          trends: '0'
          description: 'AIRESPACE-WIRELESS-MIB::bsnAPCurrentChannelChanged'
          triggers:
            - uuid: 0005659153154b9d92f08163279ee1be
              expression: 'find(/Cisco Catalyst 9800 RESTCONF/snmptrap["SNMPv2-SMI::enterprises.14179.2.6.3.16|bsnAPCurrentChannelChanged$"],,"regexp","(14179\\.2\\.6\\.3\\.16|bsnAPCurrentChannelChanged)")=1'
              recovery_mode: NONE
              name: 'Channel Updated on AP: {{ITEM.VALUE}.regsub("(14179\.2\.2\.1\.1\.3|bsnAPName).*?\s+=\s+\"?([^\"\n\r]*)", \2)} to Primary Channel: {{ITEM.VALUE}.regsub("(14179\.2\.6\.2\.23|bsnAPChannelNumberTrapVariable).*?\s+=\s+(\d+)", \2)}'
              priority: INFO
              description: |
                AIRESPACE-WIRELESS-MIB::bsnAPCurrentChannelChanged
                
                APNAME
                AIRESPACE-WIRELESS-MIB::bsnAPName
                
                find(/Cisco Catalyst 9800 by restconf/snmptrap["SNMPv2-SMI::enterprises.14179.2.6.3.16"],86400)=1
              type: MULTIPLE
              manual_close: 'YES'
              tags:
                - tag: AP
                  value: '{{ITEM.VALUE}.regsub("(bsnAPName|cLApName|14179\.2\.2\.1\.1\.3|9\.9\.513\.1\.1\.1\.1\.5).*?=\s*\"?([^\"\n\r]*)", \2)}'
        - uuid: 52c4ab29287143fa86e287615f4e1b06
          name: 'SNMP Trap - RadarChannelDetected'
          type: SNMP_TRAP
          key: 'snmptrap["SNMPv2-SMI::enterprises.14179.2.6.3.81|bsnRadarChannelDetected$"]'
          delay: '0'
          value_type: LOG
          trends: '0'
          description: 'AIRESPACE-WIRELESS-MIB::bsnRadarChannelDetected'
          triggers:
            - uuid: a59c7d33f9a64f03a6aa3280c86319c8
              expression: 'find(/Cisco Catalyst 9800 RESTCONF/snmptrap["SNMPv2-SMI::enterprises.14179.2.6.3.81|bsnRadarChannelDetected$"],,"regexp","(14179\\.2\\.6\\.3\\.81|bsnRadarChannelDetected)")=1'
              recovery_mode: NONE
              name: 'DFS Detected on AP: {{ITEM.VALUE}.regsub("(14179\.2\.2\.1\.1\.3|bsnAPName).*?\s+=\s+\"(.*?)\"", \2)} Channel: {{ITEM.VALUE}.regsub("(14179\.2\.2\.2\.1\.4|bsnAPIfPhyChannelNumber).*?\s+=\s+(\d+)", \2)}'
              priority: INFO
              description: |
                Trigger SNMP OID
                AIRESPACE-WIRELESS-MIB::bsnRadarChannelDetected
                
                APNAME
                AIRESPACE-WIRELESS-MIB::bsnAPName
                
                CHANNEL
                AIRESPACE-WIRELESS-MIB::bsnAPIfPhyChannelNumber
                
                find(/Cisco Catalyst 9800 by restconf/snmptrap["SNMPv2-SMI::enterprises.14179.2.6.3.81"],86400)=1
              type: MULTIPLE
              manual_close: 'YES'
              tags:
                - tag: AP
                  value: '{{ITEM.VALUE}.regsub("(bsnAPName|14179\.2\.2\.1\.1\.3).*?=\s*\"?([^\"\n\r]*)", \2)}'
        - uuid: 9546fd2ac99f486b9ef685886d409523
          name: 'SNMP Trap - AP disassociation'
          type: SNMP_TRAP
          key: 'snmptrap[SNMPv2-SMI::enterprises.14179.2.6.3.8$|SNMPv2-SMI::enterprises.9.9.513.0.4$|bsnAPDisassociated$|ciscoLwappApAssociated$]'
          delay: '0'
          value_type: LOG
          trends: '0'
          description: |
            AIRESPACE-WIRELESS-MIB::bsnAPDisassociated
            CISCO-LWAPP-AP-MIB::ciscoLwappApAssociated
          triggers:
            - uuid: 0236ba6a0cbb47f88a96625a272698e7
              expression: 'find(/Cisco Catalyst 9800 RESTCONF/snmptrap[SNMPv2-SMI::enterprises.14179.2.6.3.8$|SNMPv2-SMI::enterprises.9.9.513.0.4$|bsnAPDisassociated$|ciscoLwappApAssociated$],,"regexp","(14179\\.2\\.6\\.3\\.8|bsnAPDisassociated)")=1'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'find(/Cisco Catalyst 9800 RESTCONF/snmptrap[SNMPv2-SMI::enterprises.14179.2.6.3.8$|SNMPv2-SMI::enterprises.9.9.513.0.4$|bsnAPDisassociated$|ciscoLwappApAssociated$],,"regexp","(9\\.9\\.513\\.0\\.4|ciscoLwappApAssociated)")=1'
              correlation_mode: TAG_VALUE
              correlation_tag: AP
              name: 'AP Name: {{ITEM.VALUE}.regsub("(bsnAPName|14179\.2\.2\.1\.1\.3).*?=\s*\"?([^\"\n\r]*)", \2)} Disjoined'
              priority: WARNING
              description: |
                Problem trigger TrapOID
                AIRESPACE-WIRELESS-MIB::bsnAPDisassociated
                
                Recovery trigger TrapOID
                CISCO-LWAPP-AP-MIB::ciscoLwappApAssociated
                
                Tag "APNAME" from
                AIRESPACE-WIRELESS-MIB::bsnAPName (problem)
                CISCO-LWAPP-AP-MIB::cLApName (recovery)
              type: MULTIPLE
              manual_close: 'YES'
              tags:
                - tag: AP
                  value: '{{ITEM.VALUE}.regsub("(bsnAPName|cLApName|14179\.2\.2\.1\.1\.3|9\.9\.513\.1\.1\.1\.1\.5).*?=\s*\"?([^\"\n\r]*)", \2)}'
      discovery_rules:
        - uuid: 4958e29747804b7a843e5795b14071c4
          name: 'Mobility Node Discovery'
          type: DEPENDENT
          key: cisco.mobility.discovery
          delay: '0'
          description: 'Cisco-IOS-XE-wireless-mobility-oper:mobility-node-data'
          item_prototypes:
            - uuid: 59d03f28650f443f82ef26f66c48c827
              name: 'Mobility Node {#NODE.IP}: Link Status'
              type: DEPENDENT
              key: 'cisco.mobility.link.status[{#NODE.IP}]'
              delay: '0'
              value_type: TEXT
              trends: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''Cisco-IOS-XE-wireless-mobility-oper:mobility-node-data''][?(@[''node-ip''] == ''{#NODE.IP}'')][''ulink-status''].first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              master_item:
                key: cisco.mobility.stats.master
              trigger_prototypes:
                - uuid: 707a88e3c2944f9494045cf0040b39c6
                  expression: 'last(/Cisco Catalyst 9800 RESTCONF/cisco.mobility.link.status[{#NODE.IP}]) <> "up"'
                  name: 'Mobility Tunnel to {#NODE.IP} is Down'
                  manual_close: 'YES'
          master_item:
            key: cisco.mobility.stats.master
          lld_macro_paths:
            - lld_macro: '{#GROUP.NAME}'
              path: '$.[''group-name'']'
            - lld_macro: '{#NODE.IP}'
              path: '$.[''node-ip'']'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-wireless-mobility-oper:mobility-node-data'']'
        - uuid: a2c85581f9ae41ff8dd5e1a4191d90cb
          name: 'Radio Slot Discovery'
          type: SCRIPT
          key: cisco.rrm.discovery.named
          delay: 1h
          params: |
            var params = JSON.parse(value);
            
            var url = params.base_url;
            var user = params.user;
            var pass = params.pass;
            
            var req = new HttpRequest();
            req.addHeader('Accept: application/yang-data+json');
            
            // Generate Basic Authentication Header
            var authString = btoa(user + ':' + pass);
            req.addHeader('Authorization: Basic ' + authString);
            
            // -------------------------------------------------------
            // -------------------------------------------------------
            // 1. Get AP List (MAC Address -> AP Name)
            // -------------------------------------------------------
            // -------------------------------------------------------
            var apListUrl = url + "/Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/ap-name-mac-map";
            var apListRaw = req.get(apListUrl);
            
            if (req.getStatus() != 200) {
                throw 'AP List Error: ' + req.getStatus();
            }
            
            // -------------------------------------------------------
            // -------------------------------------------------------
            // 2. Get Radio Info (MAC + Slot -> Frequency Band)
            // -------------------------------------------------------
            // -------------------------------------------------------
            var radioUrl = url + "/Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/radio-oper-data";
            var radioRaw = req.get(radioUrl);
            
            if (req.getStatus() != 200) {
                throw 'Radio Data Error: ' + req.getStatus();
            }
            
            // -------------------------------------------------------
            // -------------------------------------------------------
            // 3. Get RRM Stats Data (Main Loop Target)
            // -------------------------------------------------------
            // -------------------------------------------------------
            var rrmDataUrl = url + "/Cisco-IOS-XE-wireless-rrm-oper:rrm-oper-data/rrm-measurement";
            var rrmDataRaw = req.get(rrmDataUrl);
            
            if (req.getStatus() != 200) {
                throw 'RRM Data Error: ' + req.getStatus();
            }
            
            // -------------------------------------------------------
            // -------------------------------------------------------
            // Data Merge and Formatting
            // -------------------------------------------------------
            // -------------------------------------------------------
            var output = [];
            try {
                var apListJson = JSON.parse(apListRaw);
                var radioJson  = JSON.parse(radioRaw);
                var rrmDataJson = JSON.parse(rrmDataRaw);
            
                var apListData = apListJson["Cisco-IOS-XE-wireless-access-point-oper:ap-name-mac-map"] || [];
                var radioData  = radioJson["Cisco-IOS-XE-wireless-access-point-oper:radio-oper-data"] || [];
                var rrmData    = rrmDataJson["Cisco-IOS-XE-wireless-rrm-oper:rrm-measurement"] || [];
            
                // Map 1: MAC Address -> AP Name
                var nameMap = {};
                apListData.forEach(function(ap) {
                    nameMap[ap["wtp-mac"]] = ap["wtp-name"];
                });
            
                // Map 2: MAC_Slot -> Frequency Band Name
                var bandMap = {};
                radioData.forEach(function(rad) {
                    var key = rad["wtp-mac"] + "_" + rad["radio-slot-id"];
                    var bandRaw = rad["current-active-band"];
                    
                    var bandName = "Unknown";
                    if (bandRaw === "dot11-2-dot-4-ghz-band") {
                        bandName = "2.4GHz";
                    } else if (bandRaw === "dot11-5-ghz-band") {
                        bandName = "5GHz";
                    } else if (bandRaw === "dot11-6-ghz-band") {
                        bandName = "6GHz";
                    } else {
                        // Handle cases like radio-remote-lan
                        bandName = "Other"; 
                    }
                    bandMap[key] = bandName;
                });
            
                // Main Loop: Iterate RRM Data to Generate Items
                rrmData.forEach(function(item) {
                    var mac = item["wtp-mac"];
                    var slot = item["radio-slot-id"];
                    var apName = nameMap[mac] || mac;
                    
                    // Dynamically get frequency from Band Map (Unknown if missing)
                    var freq = bandMap[mac + "_" + slot] || "Unknown";
            
                    // If you want to exclude "Other" or "Unknown" slots, insert if(freq === "Other") return; here
            
                    output.push({
                        "{#AP.NAME}": apName,
                        "{#WTP.MAC}": mac,
                        "{#SLOT.ID}": slot.toString(),
                        "{#FREQ.NAME}": freq
                    });
                });
            
            } catch (e) {
                throw 'Parsing Error: ' + e;
            }
            
            return JSON.stringify(output);
          description: |
            Functional Overview: Dynamically discovers and monitors radio slot statistics for Cisco Catalyst 9800 WLC Access Points (APs) using RESTCONF. This discovery rule automatically resolves AP names and actual operating frequency bands to generate human-readable item names.
            
            Key Features:
            - AP Name Mapping:
              Uses the configured "AP Name" for item generation instead of MAC addresses.
            - Dynamic Band Mapping:
              Detects the actual operating frequency band for each slot instead of assuming fixed assignments.
            -  XOR Radio Support: Correctly identifies if Slot 0 is operating in 5GHz mode (e.g., Dual 5GHz).
              Wi-Fi 6E Support: Automatically detects 6GHz bands on supported APs (e.g., Slot 2).
            
            Efficient Data Retrieval:
            - Minimizes API calls by aggregating data from multiple endpoints within a single JavaScript execution.
            
            Generated LLD Macros:
            - {#AP.NAME} : Access Point Name (e.g., AP-Tokyo-01)
            - {#WTP.MAC} : AP MAC Address (Used as the unique key)
            - {#SLOT.ID} : Radio Slot ID (0, 1, 2...)
            - {#FREQ.NAME} : Operating Frequency Band (2.4GHz, 5GHz, 6GHz)
            
            RESTCONF Paths Used:
            - Name Mapping: /Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/ap-name-mac-map
            - Band Mapping: /Cisco-IOS-XE-wireless-access-point-oper:access-point-oper-data/radio-oper-data
            - Statistics: /Cisco-IOS-XE-wireless-rrm-oper:rrm-oper-data/rrm-measurement
            
            Item Name Examples:
            - AP AP-Tokyo-01 (5GHz): Channel Utilization
            - AP AP-Osaka-02 (6GHz): Client Count
          item_prototypes:
            - uuid: 6340e14ce1c84dcaab9034352cbaa910
              name: 'AP {#AP.NAME} ({#FREQ.NAME}): Operating Channel'
              type: DEPENDENT
              key: 'cisco.ap.channel[{#WTP.MAC},{#SLOT.ID}]'
              delay: '0'
              value_type: TEXT
              trends: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''Cisco-IOS-XE-wireless-access-point-oper:radio-oper-data''][?(@[''wtp-mac'']==''{#WTP.MAC}'' && @[''radio-slot-id'']=={#SLOT.ID})][''phy-ht-cfg''][''cfg-data''][''freq-string''].first()'
              master_item:
                key: cisco.radio.cfg.master
            - uuid: a31755cca0c74a83a03380ab3056aa23
              name: 'AP {#AP.NAME} ({#FREQ.NAME}): Channel Utilization'
              type: DEPENDENT
              key: 'rrm.cca.util[{#WTP.MAC},{#SLOT.ID}]'
              delay: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''Cisco-IOS-XE-wireless-rrm-oper:rrm-measurement''][?(@[''wtp-mac'']==''{#WTP.MAC}'' && @[''radio-slot-id'']=={#SLOT.ID})].load[''cca-util-percentage''].first()'
              master_item:
                key: cisco.iosxe.rrm.master
            - uuid: f6966d8a9c9c4f60b7751a583299b764
              name: 'AP {#AP.NAME} ({#FREQ.NAME}): Client Count'
              type: DEPENDENT
              key: 'rrm.client.count[{#WTP.MAC},{#SLOT.ID}]'
              delay: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''Cisco-IOS-XE-wireless-rrm-oper:rrm-measurement''][?(@[''wtp-mac'']==''{#WTP.MAC}'' && @[''radio-slot-id'']=={#SLOT.ID})].load[''stations''].first()'
              master_item:
                key: cisco.iosxe.rrm.master
            - uuid: 2e5ee889e0454851ac747788e1f07489
              name: 'AP {#AP.NAME} ({#FREQ.NAME}): Noise Level'
              type: DEPENDENT
              key: 'rrm.noise[{#WTP.MAC},{#SLOT.ID}]'
              delay: '0'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''Cisco-IOS-XE-wireless-rrm-oper:rrm-measurement''][?(@[''wtp-mac'']==''{#WTP.MAC}'' && @[''radio-slot-id'']=={#SLOT.ID})].noise.noise[''noise-data''][0].noise.first()'
              master_item:
                key: cisco.iosxe.rrm.master
          timeout: 10s
          parameters:
            - name: base_url
              value: 'https://{HOST.CONN}/restconf/data'
            - name: pass
              value: '{$RESTCONF.PASS}'
            - name: user
              value: '{$RESTCONF.USER}'
        - uuid: 61444ff60aff4b149f553b303e208293
          name: 'WLAN SSID Discovery'
          type: DEPENDENT
          key: cisco.wlan.discovery
          delay: '0'
          description: 'Cisco-IOS-XE-wireless-wlan-global-oper:wlan-global-oper-data/wlan-info'
          item_prototypes:
            - uuid: e4dc8b7ce0b5492db9c7de36e4640f27
              name: 'SSID {#WLAN.NAME}: Client Count'
              type: DEPENDENT
              key: 'cisco.wlan.client.count[{#WLAN.NAME}]'
              delay: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''Cisco-IOS-XE-wireless-wlan-global-oper:wlan-info''][?(@[''wlan-profile''] == ''{#WLAN.NAME}'')][''curr-clients-count''].first()'
              master_item:
                key: cisco.wlan.stats.master
          master_item:
            key: cisco.wlan.stats.master
          lld_macro_paths:
            - lld_macro: '{#WLAN.NAME}'
              path: '$.[''wlan-profile'']'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''Cisco-IOS-XE-wireless-wlan-global-oper:wlan-info'']'
      tags:
        - tag: class
          value: network
        - tag: target
          value: cisco
        - tag: target
          value: cisco-catalyst-9800
      macros:
        - macro: '{$RESTCONF.PASS}'
          value: adminpassword
        - macro: '{$RESTCONF.URL}'
          value: 'https://{HOST.CONN}/restconf/data'
        - macro: '{$RESTCONF.USER}'
          value: admin
