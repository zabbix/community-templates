<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:30:01Z</date><groups><group><name>Templates</name></group></groups><templates><template><template>Cisco Total</template><name>Cisco Total</name><description>## Overview

This template is a smattering of a few templates combined with some custom discovery rules.


It has been tested to work with a bunch of Cisco switches and routers. It uses the standard SNMP root for all discovery (using OID's), so it works with most switch/router devices. If you have any issues with it let me know. I exported this from a live system, so the read the dependencies below.


**What it does:**


* BGP Discovery
	+ Admin Status
	+ Peer State
* CPU Discovery
	+ Usage on core
* Interface Discovery
	+ Traffic in/out
	+ Errors in/out
	+ Drops in/out
* Memory Pool Discovery
	+ Mem free in pool
* OSPF Discovery
	+ Neighbor State
* Temperature Discovery
	+ temperature of monitor


The template creates quite a few graph prototypes and adds them to a screen as well.


 


**Dependencies:**


The template had value maps, interface filters and groups associated with it when I cloned it, but I removed them so there shouldn't be any issues with it. If you find an issue importing let me know. I was successful importing default template to a new system.


 


**Other Instructions:**


Be sure to set the $SNMP\_COMMUNITY and $CRD\_SNMPV2\_R values. They should both be your SNMP community string.


 



</description><groups><group><name>Templates</name></group></groups><applications><application><name>BGP</name></application><application><name>Cisco</name></application><application><name>Interfaces</name></application><application><name>OSPF</name></application><application><name>Temperature</name></application></applications><discovery_rules><discovery_rule><name>Cisco OSPF Discovery</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.14.10.1.6]</snmp_oid><key>cisco.ospf.diuscovery</key><delay>3600</delay><item_prototypes><item_prototype><name>ospfNbrState {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.14.10.1.6.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.14.10.1.6.[{#SNMPINDEX}]</key><delay>30</delay><value_type>FLOAT</value_type><applications><application><name>OSPF</name></application></applications></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Cisco memory pool discovery</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#MEMNAME},1.3.6.1.4.1.9.9.48.1.1.1.2]</snmp_oid><key>ciscoMemoryPoolTable</key><delay>3600</delay><lifetime>1d</lifetime><description>{#MEMNAME} --&gt; A textual name assigned to the memory pool. This object is suitable for output to a human operator, and may also be used to distinguish among the various pool types, especially among dynamic pools.</description><item_prototypes><item_prototype><name>Memory - free in pool '{#MEMNAME}'</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.9.9.48.1.1.1.6.{#SNMPINDEX}</snmp_oid><key>ciscoMemoryPoolFree[{#SNMPINDEX}]</key><delay>600</delay><history>7d</history><units>B</units><description>Indicates the number of bytes from the memory pool that are currently unused on the managed device.</description><applications><application><name>Cisco</name></application></applications><trigger_prototypes><trigger_prototype><expression>{max(#3)}&lt;{$MEM_FREE_MIN_1:&quot;{#MEMNAME}&quot;}</expression><name>Cisco: 'Free memory' in pool '{#MEMNAME}' is low [{ITEM.LASTVALUE}]</name><priority>WARNING</priority><dependencies><dependency><name>Cisco: 'Free memory' in pool '{#MEMNAME}' is too low [{ITEM.LASTVALUE}]</name><expression>{Cisco Total:ciscoMemoryPoolFree[{#SNMPINDEX}].max(#3)}&lt;{$MEM_FREE_MIN_2:&quot;{#MEMNAME}&quot;}</expression></dependency></dependencies></trigger_prototype><trigger_prototype><expression>{max(#3)}&lt;{$MEM_FREE_MIN_2:&quot;{#MEMNAME}&quot;}</expression><name>Cisco: 'Free memory' in pool '{#MEMNAME}' is too low [{ITEM.LASTVALUE}]</name><priority>AVERAGE</priority></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>{#SNMPINDEX} Memory Free</name><graph_items><graph_item><color>1A7C11</color><item><host>Cisco Total</host><key>ciscoMemoryPoolFree[{#SNMPINDEX}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule><discovery_rule><name>Cisco CPU Discovery</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#CPUID},1.3.6.1.4.1.9.9.109.1.1.1.1.2]</snmp_oid><key>cpmCPUTotalTable</key><delay>3600</delay><lifetime>1d</lifetime><description>{#CPUID} --&gt; The physical entity can be a CPU chip, a group of CPUs, a CPU card etc. The exact type of this entity is described by its entPhysicalVendorType value.</description><item_prototypes><item_prototype><name>CPU - usage on core '{#CPUID}'</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.9.9.109.1.1.1.1.8.{#SNMPINDEX}</snmp_oid><key>cpmCPUTotal5minRev[{#SNMPINDEX}]</key><delay>300</delay><history>7d</history><units>%</units><description>The overall CPU busy percentage in the last 5 minute period.</description><applications><application><name>Cisco</name></application></applications><trigger_prototypes><trigger_prototype><expression>{min(#3)}&gt;{$CPU_PUSED_MAX_1:&quot;{#CPUID}&quot;}</expression><name>Cisco: 'CPU usage' on core '{#CPUID}' is high [{ITEM.LASTVALUE}]</name><url>http://www.cisco.com/c/en/us/support/docs/routers/10000-series-routers/15095-highcpu.html#anc0</url><priority>WARNING</priority><description>- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds.&#13;
- Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands.&#13;
- Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands.&#13;
- Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command.&#13;
- Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue.&#13;
&#13;
The overall CPU busy percentage.</description><dependencies><dependency><name>Cisco: 'CPU usage' on core '{#CPUID}' is too high [{ITEM.LASTVALUE}]</name><expression>{Cisco Total:cpmCPUTotal5minRev[{#SNMPINDEX}].min(#3)}&gt;{$CPU_PUSED_MAX_2:&quot;{#CPUID}&quot;}</expression></dependency></dependencies></trigger_prototype><trigger_prototype><expression>{min(#3)}&gt;{$CPU_PUSED_MAX_2:&quot;{#CPUID}&quot;}</expression><name>Cisco: 'CPU usage' on core '{#CPUID}' is too high [{ITEM.LASTVALUE}]</name><url>http://www.cisco.com/c/en/us/support/docs/routers/10000-series-routers/15095-highcpu.html#anc0</url><priority>AVERAGE</priority><description>- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds.&#13;
- Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands.&#13;
- Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands.&#13;
- Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command.&#13;
- Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue.&#13;
&#13;
The overall CPU busy percentage.</description></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>CPU usage on core '{#CPUID}'</name><show_triggers>NO</show_triggers><ymin_type_1>FIXED</ymin_type_1><ymax_type_1>FIXED</ymax_type_1><graph_items><graph_item><color>1A7C11</color><item><host>Cisco Total</host><key>cpmCPUTotal5minRev[{#SNMPINDEX}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule><discovery_rule><name>Cisco BGP Peer Enumeration</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.15.3.1.7]</snmp_oid><key>discovery.bgpDescr</key><delay>3600</delay><lifetime>1d</lifetime><item_prototypes><item_prototype><name>BGP Peer State {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.15.3.1.2.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.15.3.1.2.[{#SNMPINDEX}]</key><delay>30</delay><value_type>FLOAT</value_type><applications><application><name>BGP</name></application></applications></item_prototype><item_prototype><name>BGP Admin Status {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.15.3.1.3.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.15.3.1.3.[{#SNMPINDEX}]</key><delay>30</delay><value_type>FLOAT</value_type><applications><application><name>BGP</name></application></applications></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Cisco Interface Discovery</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.2.2.1.2]</snmp_oid><key>discovery.ifDescr</key><delay>3600</delay><lifetime>1d</lifetime><item_prototypes><item_prototype><name>{#SNMPVALUE} - Inbound traffic</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.2.2.1.10.[{#SNMPINDEX}]</key><delay>60</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><applications><application><name>Interfaces</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step><step><type>MULTIPLIER</type><params>8</params></step></preprocessing></item_prototype><item_prototype><name>{#SNMPVALUE} - Inbound discarded packets</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.2.2.1.13.[{#SNMPINDEX}]</key><delay>60</delay><history>7d</history><applications><application><name>Interfaces</name></application></applications><preprocessing><step><type>SIMPLE_CHANGE</type><params/></step></preprocessing></item_prototype><item_prototype><name>{#SNMPVALUE} - Inbound error packets</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.2.2.1.14.[{#SNMPINDEX}]</key><delay>60</delay><history>7d</history><applications><application><name>Interfaces</name></application></applications><preprocessing><step><type>SIMPLE_CHANGE</type><params/></step></preprocessing></item_prototype><item_prototype><name>{#SNMPVALUE} - Outbound traffic</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.2.2.1.16.[{#SNMPINDEX}]</key><delay>60</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><applications><application><name>Interfaces</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step><step><type>MULTIPLIER</type><params>8</params></step></preprocessing></item_prototype><item_prototype><name>{#SNMPVALUE} - Outbound discarded packets</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.2.2.1.19.[{#SNMPINDEX}]</key><delay>60</delay><history>7d</history><applications><application><name>Interfaces</name></application></applications><preprocessing><step><type>SIMPLE_CHANGE</type><params/></step></preprocessing></item_prototype><item_prototype><name>{#SNMPVALUE} - Outbound error packets</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}</snmp_oid><key>.1.3.6.1.2.1.2.2.1.20.[{#SNMPINDEX}]</key><delay>60</delay><history>7d</history><applications><application><name>Interfaces</name></application></applications><preprocessing><step><type>SIMPLE_CHANGE</type><params/></step></preprocessing></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>Interface {#SNMPVALUE} Discards and Errors</name><graph_items><graph_item><color>1A7C11</color><item><host>Cisco Total</host><key>.1.3.6.1.2.1.2.2.1.13.[{#SNMPINDEX}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>F63100</color><item><host>Cisco Total</host><key>.1.3.6.1.2.1.2.2.1.19.[{#SNMPINDEX}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>2774A4</color><item><host>Cisco Total</host><key>.1.3.6.1.2.1.2.2.1.14.[{#SNMPINDEX}]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>Cisco Total</host><key>.1.3.6.1.2.1.2.2.1.20.[{#SNMPINDEX}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><name>Interface {#SNMPVALUE} Traffic</name><graph_items><graph_item><color>1A7C11</color><item><host>Cisco Total</host><key>.1.3.6.1.2.1.2.2.1.10.[{#SNMPINDEX}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>F63100</color><item><host>Cisco Total</host><key>.1.3.6.1.2.1.2.2.1.16.[{#SNMPINDEX}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule><discovery_rule><name>Cisco Temperature Discovery</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.13.1.3.1.3]</snmp_oid><key>discovery.TempDesc</key><delay>3600</delay><lifetime>1d</lifetime><item_prototypes><item_prototype><name>{#SNMPINDEX} temperature</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.9.9.13.1.3.1.3.{#SNMPINDEX}</snmp_oid><key>1.3.6.1.4.1.9.9.13.1.3.1.3.[{#SNMPINDEX}]</key><delay>30</delay><value_type>FLOAT</value_type><units>C</units><applications><application><name>Temperature</name></application></applications></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>Temperature {#SNMPINDEX}</name><graph_items><graph_item><color>1A7C11</color><item><host>Cisco Total</host><key>1.3.6.1.4.1.9.9.13.1.3.1.3.[{#SNMPINDEX}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule></discovery_rules><macros><macro><macro>{$CPU_PUSED_MAX_1}</macro><value>85</value></macro><macro><macro>{$CPU_PUSED_MAX_2}</macro><value>95</value></macro><macro><macro>{$CRD_SNMPV2_R}</macro><value>FillMeIn</value></macro><macro><macro>{$MEM_FREE_MIN_1}</macro><value>5000000</value></macro><macro><macro>{$MEM_FREE_MIN_1:&quot;I/O&quot;}</macro><value>1400000</value></macro><macro><macro>{$MEM_FREE_MIN_1:&quot;SRAM&quot;}</macro><value>3000</value></macro><macro><macro>{$MEM_FREE_MIN_2}</macro><value>1000000</value></macro><macro><macro>{$MEM_FREE_MIN_2:&quot;I/O&quot;}</macro><value>500000</value></macro><macro><macro>{$MEM_FREE_MIN_2:&quot;SRAM&quot;}</macro><value>1000</value></macro><macro><macro>{$SNMP_COMMUNITY}</macro><value>FillMeIn</value></macro></macros><screens><screen><name>Performance screen</name><hsize>2</hsize><vsize>8</vsize><screen_items><screen_item><resourcetype>20</resourcetype><style>0</style><resource><name>Temperature {#SNMPINDEX}</name><host>Cisco Total</host></resource><width>500</width><height>100</height><x>0</x><y>0</y><colspan>1</colspan><rowspan>1</rowspan><elements>0</elements><valign>0</valign><halign>0</halign><dynamic>0</dynamic><sort_triggers>0</sort_triggers><url/><application/><max_columns>2</max_columns></screen_item><screen_item><resourcetype>20</resourcetype><style>0</style><resource><name>CPU usage on core '{#CPUID}'</name><host>Cisco Total</host></resource><width>500</width><height>100</height><x>0</x><y>1</y><colspan>1</colspan><rowspan>1</rowspan><elements>0</elements><valign>0</valign><halign>0</halign><dynamic>0</dynamic><sort_triggers>0</sort_triggers><url/><application/><max_columns>2</max_columns></screen_item><screen_item><resourcetype>20</resourcetype><style>0</style><resource><name>{#SNMPINDEX} Memory Free</name><host>Cisco Total</host></resource><width>500</width><height>100</height><x>0</x><y>2</y><colspan>1</colspan><rowspan>1</rowspan><elements>0</elements><valign>0</valign><halign>0</halign><dynamic>0</dynamic><sort_triggers>0</sort_triggers><url/><application/><max_columns>2</max_columns></screen_item><screen_item><resourcetype>20</resourcetype><style>0</style><resource><name>Interface {#SNMPVALUE} Traffic</name><host>Cisco Total</host></resource><width>500</width><height>100</height><x>0</x><y>3</y><colspan>1</colspan><rowspan>1</rowspan><elements>0</elements><valign>0</valign><halign>0</halign><dynamic>0</dynamic><sort_triggers>0</sort_triggers><url/><application/><max_columns>2</max_columns></screen_item><screen_item><resourcetype>20</resourcetype><style>0</style><resource><name>Interface {#SNMPVALUE} Discards and Errors</name><host>Cisco Total</host></resource><width>500</width><height>100</height><x>0</x><y>5</y><colspan>1</colspan><rowspan>1</rowspan><elements>0</elements><valign>0</valign><halign>0</halign><dynamic>0</dynamic><sort_triggers>0</sort_triggers><url/><application/><max_columns>2</max_columns></screen_item></screen_items></screen></screens></template></templates></zabbix_export>
