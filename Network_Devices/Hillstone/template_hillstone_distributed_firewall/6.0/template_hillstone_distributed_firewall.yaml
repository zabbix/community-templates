zabbix_export:
  version: '6.0'
  date: '2025-12-12T08:27:12Z'
  groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: e71461c7026b4469a0d8a157a04e6e20
      template: 'Hillstone SX series by SNMP'
      name: 'Hillstone SX series by SNMP'
      description: |
        Template Net Hillstone
        MIBs used:
        HILLSTONE-SYSTEM-MIB
        HILLSTONE-MODULE-MIB
        HILLSTONE-FAN-MIB
        HILLSTONE-POWER-MIB
        SNMPv2-MIB
        IF-MIB
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 2354f47e41b0490792a7d27351960f96
          name: 'Memory utilization'
          type: CALCULATED
          key: hillstone.memory.utilization
          units: '%'
          params: 'last(//hillstone.sysCurMemory)/(last(//hillstone.sysTotalMemory))*100'
          description: 'Current memory utilization (percentage).'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: 14a6e255ce1f4e8c9d88b1dccfeef2c9
              expression: 'min(/Hillstone SX series by SNMP/hillstone.memory.utilization,5m)>{$MEMORY.UTIL.WARN}'
              name: 'Hillstone: High memory utilization'
              event_name: 'Hillstone: High memory utilization (>{$MEMORY.UTIL.WARN}% for 5m)'
              priority: WARNING
              description: 'The system is running out of free memory.'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: 1ba64175b0654309a81c5341d73fcdaa
          name: sysCurMemory
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.28557.2.2.1.5.0
          key: hillstone.sysCurMemory
          units: B
          description: |
            MIB: HILLSTONE-SYSTEM-MIB
            The currently used memory.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            - tag: component
              value: memory
        - uuid: 14eb2361dbe64a49a064cbd4671b7044
          name: sysCurSession
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.28557.2.2.1.7.0
          key: hillstone.sysCurSession
          delay: 30s
          description: 'MIB: HILLSTONE-SYSTEM-MIB'
          tags:
            - tag: component
              value: session
        - uuid: a0785a46cab344da9b0942f6ab12457b
          name: sysHAStatus
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.28557.2.2.1.8.0
          key: hillstone.sysHAStatus
          description: |
            MIB: HILLSTONE-SYSTEM-MIB
            | 0 | Invalid |
            | 1 | Started |
            | 2 | Hello |
            | 3 | Backup device |
            | 4 | Primary device |
            | 5 | Standby device |
            | 15 | Failure |
          tags:
            - tag: component
              value: ha
        - uuid: 9de1b635fe4048e29442a4ff45fb7980
          name: sysOverallThroughput
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.28557.2.2.1.19.0
          key: hillstone.sysOverallThroughput
          units: bps
          description: 'MIB: HILLSTONE-SYSTEM-MIB'
          tags:
            - tag: component
              value: traffic
        - uuid: f54f11183d564d1092e449fbea3c5dc3
          name: sysRamupRate
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.28557.2.2.1.21.0
          key: hillstone.sysRamupRate
          delay: 30s
          description: 'MIB: HILLSTONE-SYSTEM-MIB'
          tags:
            - tag: component
              value: session
        - uuid: 4960cc78e7144cf0ac36fb851fc79555
          name: sysTotalMemory
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.28557.2.2.1.4.0
          key: hillstone.sysTotalMemory
          units: B
          description: |
            MIB: HILLSTONE-SYSTEM-MIB
            Total Memory.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            - tag: component
              value: memory
        - uuid: aff2125877a64b81af9643ad8e190c04
          name: sysTotalSession
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.28557.2.2.1.6.0
          key: hillstone.sysTotalSession
          delay: 1h
          description: 'MIB: HILLSTONE-SYSTEM-MIB'
          tags:
            - tag: component
              value: session
        - uuid: decdb0d5b5274434a5df4e85bae851b7
          name: 'Generic SNMP: ICMP ping'
          type: SIMPLE
          key: icmpping
          delay: 10s
          history: 7d
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: d0e5978acdff4814839c333f801ae35c
              expression: 'max(/Hillstone SX series by SNMP/icmpping,#3)=0'
              name: 'Generic SNMP: Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
              tags:
                - tag: scope
                  value: availability
        - uuid: b5bb7b41a96b42cfaa4aaaca383b0e2a
          name: 'Generic SNMP: ICMP loss'
          type: SIMPLE
          key: icmppingloss
          delay: 10s
          history: 7d
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 224f0dc556fa4d9a99d53f2767fa1211
              expression: 'min(/Hillstone SX series by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Hillstone SX series by SNMP/icmppingloss,5m)<100'
              name: 'Generic SNMP: High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: 'Generic SNMP: Unavailable by ICMP ping'
                  expression: 'max(/Hillstone SX series by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: abc63538c55f4c72867bb1225b56300f
          name: 'Generic SNMP: ICMP response time'
          type: SIMPLE
          key: icmppingsec
          delay: 10s
          history: 7d
          value_type: FLOAT
          units: s
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: f5c45b635bac436396172af597e3bc21
              expression: 'avg(/Hillstone SX series by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'Generic SNMP: High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: 'Generic SNMP: High ICMP ping loss'
                  expression: 'min(/Hillstone SX series by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Hillstone SX series by SNMP/icmppingloss,5m)<100'
                - name: 'Generic SNMP: Unavailable by ICMP ping'
                  expression: 'max(/Hillstone SX series by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 032f9e25d1524eadaaee278e25fab643
          name: 'Generic SNMP: Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          history: 7d
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
      discovery_rules:
        - uuid: 23b19953e7c342d8879dac69befdce5a
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFOPERSTATUS}'
                value: '1'
                formulaid: A
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: 3fbb0f3b734a4ed4aa0e0743d808f772
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 158db0ce58bc4a3e926eb484550cc086
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 8c310198bf514d7cbc9b5f70b4471a7d
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
              key: 'net.if.in[ifInOctets.{#SNMPINDEX}]'
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface,including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and another times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 44c36905b8e74179a2c504726b7ba915
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b7506ab83d86423fb740ef06e14489ae
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: ae1a4e69478942dc9e1bd2dc2b2d7b35
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
              key: 'net.if.out[ifOutOctets.{#SNMPINDEX}]'
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 77d4820dc2bb4bddb8208a001cc1a45f
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
              key: 'net.if.speed[ifSpeed.{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in bits per second.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made,
                this object should contain the nominal bandwidth.
                If the bandwidth of the interface is greater than the maximum value reportable by this object then
                this object should report its maximum value (4,294,967,295) and ifHighSpeed must be used to report the interface's speed.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 05e8b043727243f6b2cea3e7f6abd922
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 0c7809467a9d437bb48b247dc0d80816
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the operational status was up to (1) sometime before (so, do not fire for the 'eternal off' interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 6a81c085a2bf408ebb333a413a6b2437
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: b0ff95fe65f84180b5474aea7e69e831
              expression: |
                change(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])<0 and last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])>0
                and (
                last(/Hillstone SX series by SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/Hillstone SX series by SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/Hillstone SX series by SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/Hillstone SX series by SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/Hillstone SX series by SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/Hillstone SX series by SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])>0 and last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 0aac1bcacc144465a1fdd3e01107a62f
              expression: |
                (avg(/Hillstone SX series by SNMP/net.if.in[ifInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}]) or
                avg(/Hillstone SX series by SNMP/net.if.out[ifOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])) and
                last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Hillstone SX series by SNMP/net.if.in[ifInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}]) and
                avg(/Hillstone SX series by SNMP/net.if.out[ifOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Hillstone SX series by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: b50fa22b7bf04b8a917a2597a4c58be9
              expression: |
                min(/Hillstone SX series by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Hillstone SX series by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Hillstone SX series by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Hillstone SX series by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Hillstone SX series by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 4098da614beb44d3a11f886521a2ea65
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Hillstone SX series by SNMP'
                    key: 'net.if.in[ifInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'Hillstone SX series by SNMP'
                    key: 'net.if.out[ifOutOctets.{#SNMPINDEX}]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |2
                      // 1. 尝试解析原始 JSON
                      var data;
                      try {
                          data = JSON.parse(value);
                      } catch (e) {
                          throw 'Failed to parse JSON of EtherLike-MIB discovery: ' + e.message;
                      }
                  
                      // 2. 确保是数组
                      if (!Array.isArray(data)) {
                          throw 'Parsed JSON is not an array';
                      }
                  
                      // 3. 定义需要清理的字段
                      var fields = ['{#IFOPERSTATUS}', '{#IFADMINSTATUS}', '{#IFALIAS}', '{#IFNAME}', '{#IFDESCR}', '{#IFTYPE}'];
                  
                      // 4. 遍历每个接口
                      data.forEach(function(element) {
                          // 清理所有字段：null/undefined → ""
                          fields.forEach(function(field) {
                              element[field] = (element[field] !== null && element[field] !== undefined) ? String(element[field]) : '';
                          });
                  
                          // 5. 特别处理 {#IFALIAS}：尝试解码十六进制为 UTF-8
                          var alias = element['{#IFALIAS}'].trim();
                          if (alias !== '') {
                              // 移除所有空格，只保留十六进制字符
                              var hexStr = alias.replace(/\s+/g, '').toUpperCase();
                  
                              // 检查是否为偶数长度且全为十六进制字符
                              if (hexStr.length > 0 && hexStr.length % 2 === 0 && /^[0-9A-F]+$/.test(hexStr)) {
                                  // 尝试转换为 UTF-8 字符串
                                  var bytes = [];
                                  for (var i = 0; i < hexStr.length; i += 2) {
                                      bytes.push(parseInt(hexStr.substr(i, 2), 16));
                                  }
                  
                                  // 手动构建 UTF-8 字符串（兼容 Zabbix JS 引擎）
                                  var utf8 = '';
                                  for (var j = 0; j < bytes.length; j++) {
                                      var byte = bytes[j];
                                      if (byte < 0x80) {
                                          utf8 += String.fromCharCode(byte);
                                      } else if (byte < 0xE0) {
                                          utf8 += String.fromCharCode(
                                              ((byte & 0x1F) << 6) | (bytes[++j] & 0x3F)
                                          );
                                      } else if (byte < 0xF0) {
                                          utf8 += String.fromCharCode(
                                              ((byte & 0x0F) << 12) |
                                              ((bytes[++j] & 0x3F) << 6) |
                                              (bytes[++j] & 0x3F)
                                          );
                                      }
                                  }
                  
                                  // 如果解码成功（非空），替换原值
                                  if (utf8 !== '') {
                                      element['{#IFALIAS}'] = utf8;
                                  }
                              }
                              // 否则保留原始字符串（可能是普通文本，如 "WAN"）
                          }
                      });
                  
                      // 6. 返回处理后的 JSON 字符串
                      return JSON.stringify(data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: dae1767c2a9f4ce998cc2065a27f6f87
          name: 'FAN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FANINDEX},1.3.6.1.4.1.28557.2.26.1.2.1.1,{#FANDESCR},1.3.6.1.4.1.28557.2.26.1.2.1.2,{#FANTYPE},1.3.6.1.4.1.28557.2.26.1.2.1.3]'
          key: sysFanStatus.discovery
          filter:
            conditions:
              - macro: '{#FANTYPE}'
                value: '1'
                formulaid: A
          item_prototypes:
            - uuid: 4e6d1a2beaf74a718b700b3188d0d614
              name: '{#FANDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.26.1.2.1.5.{#SNMPINDEX}'
              key: 'sysfanstate.[{#FANINDEX}]'
        - uuid: c824e2c81e7d4587aa5a4c539dfe6386
          name: 'Power Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#POWERINDEX},1.3.6.1.4.1.28557.2.27.1.2.1.1,{#POWERDESCR},1.3.6.1.4.1.28557.2.27.1.2.1.2]'
          key: sysPowerStatus.discovery
          item_prototypes:
            - uuid: b41f474d189e429683f4a12396654c03
              name: '{#POWERDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.28557.2.27.1.2.1.3.{#SNMPINDEX}'
              key: 'sysPowerstate.[{#POWERINDEX}]'
        - uuid: 37698713d2f74331ab8760794f8bc738
          name: 'Slot Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SLOTINDEX},1.3.6.1.4.1.28557.2.25.1.2.1.1,{#SLOTDESCR},1.3.6.1.4.1.28557.2.25.1.2.1.3,{#SLOTSTATE},1.3.6.1.4.1.28557.2.25.1.2.1.4,{#SLOTMODULETYPE},1.3.6.1.4.1.28557.2.25.1.2.1.5]'
          key: sysSlotStatus.discovery
          filter:
            conditions:
              - macro: '{#SLOTSTATE}'
                value: '1'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          item_prototypes:
            - uuid: ae2853a75bda4525b1af18ad2f1dcc0f
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) CPU'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.25.1.2.1.8.{#SNMPINDEX}'
              key: 'hillstoneCpuCur.[{#SLOTINDEX}]'
              units: '%'
              trigger_prototypes:
                - uuid: 1e7e0b1a53754570875e70249d299276
                  expression: 'min(/Hillstone SX series by SNMP/hillstoneCpuCur.[{#SLOTINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: 'Hillstone: High CPU utilization'
                  event_name: 'Hillstone: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  priority: WARNING
            - uuid: 987bc8bdf64a4d0fae67e500ce124831
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) MemCPTotal'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.25.1.2.1.9.{#SNMPINDEX}'
              key: 'hillstoneMemCPTotal.[{#SLOTINDEX}]'
              units: B
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000'
            - uuid: e5ab5255860a4e5fa65f19d7823b661c
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) MemCPUsage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.25.1.2.1.10.{#SNMPINDEX}'
              key: 'hillstoneMemCPUsage.[{#SLOTINDEX}]'
              units: '%'
              trigger_prototypes:
                - uuid: 2ae9cd9d45c84742b56053ee92ffbf7b
                  expression: 'min(/Hillstone SX series by SNMP/hillstoneMemCPUsage.[{#SLOTINDEX}],5m)>{$MEMORY.UTIL.WARN}'
                  name: 'Hillstone: High CP memory utilization'
                  event_name: 'Hillstone: High CP memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
                  priority: WARNING
            - uuid: 273a0e8a44ba477abb4aa1c162f5dd1c
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) MemDPTotal'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.25.1.2.1.11.{#SNMPINDEX}'
              key: 'hillstoneMemDPTotal.[{#SLOTINDEX}]'
              units: B
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000'
            - uuid: 05f5fe3965264691abd7ebcb36c38c3e
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) MemDPUsage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.25.1.2.1.12.{#SNMPINDEX}'
              key: 'hillstoneMemDPUsage.[{#SLOTINDEX}]'
              units: '%'
              trigger_prototypes:
                - uuid: 2ea542a51f4846b594deb95fa8049740
                  expression: 'min(/Hillstone SX series by SNMP/hillstoneMemDPUsage.[{#SLOTINDEX}],5m)>{$MEMORY.UTIL.WARN}'
                  name: 'Hillstone: High DP memory utilization'
                  event_name: 'Hillstone: High DP memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
                  priority: WARNING
            - uuid: 55fc74cf01574749a42a4b028679ed2e
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) State'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.28557.2.25.1.2.1.4.{#SNMPINDEX}'
              key: 'hillstoneSlotState.[{#SLOTINDEX}]'
          graph_prototypes:
            - uuid: 4596058622304bbf90d739fbf1268465
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) CPU utilization'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Hillstone SX series by SNMP'
                    key: 'hillstoneCpuCur.[{#SLOTINDEX}]'
            - uuid: 26ef5859803943c5b07dbaab5654a7bf
              name: 'Slot {#SLOTINDEX}({#SLOTMODULETYPE}) Memory utilization'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Hillstone SX series by SNMP'
                    key: 'hillstoneMemCPUsage.[{#SLOTINDEX}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Hillstone SX series by SNMP'
                    key: 'hillstoneMemDPUsage.[{#SLOTINDEX}]'
      tags:
        - tag: class
          value: network
        - tag: target
          value: hillstone
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '80'
          description: 'Threshold of CPU utilization for the Warning trigger in %.'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Threshold of error packet rate for Warning trigger. Can be used with interface name as context.'
        - macro: '{$IF.UTIL.MAX}'
          value: '95'
          description: 'Threshold of interface bandwidth utilization for Warning trigger in %. Can be used with interface name as context.'
        - macro: '{$IFCONTROL}'
          value: '1'
          description: 'Macro for operational state of interface for "Link down" trigger. Can be used with interface name as context.'
        - macro: '{$MEMORY.UTIL.CRIT}'
          value: '90'
          description: 'Threshold of memory utilization for critical trigger in %.'
        - macro: '{$MEMORY.UTIL.WARN}'
          value: '80'
          description: 'Threshold of memory utilization for warning trigger in %.'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SESSION.UTIL.CRIT}'
          value: '80'
          description: 'Threshold of session utilization for the Warning trigger in %.'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
      valuemaps:
        - uuid: 2fc3bd024ea444b19d06317fa796baee
          name: 'HILLSTONE-FAN-MIB::hillstoneFanState'
          mappings:
            - value: '0'
              newvalue: 良好
            - value: '1'
              newvalue: 不在位
            - value: '2'
              newvalue: 警告
            - value: '3'
              newvalue: 失败
            - value: '4'
              newvalue: 失败或者未供电
            - value: '5'
              newvalue: '无风扇状态因为设备/子卡本 身无风扇'
        - uuid: 8e182cd13eb84becb234f0f7a1e6fb2b
          name: 'HILLSTONE-MODULE-MIB::hillstoneSlotState'
          mappings:
            - value: '0'
              newvalue: 无效
            - value: '1'
              newvalue: 插槽为空
            - value: '2'
              newvalue: 在位
            - value: '3'
              newvalue: 上线等待
            - value: '4'
              newvalue: 上线初始化完成
            - value: '5'
              newvalue: 在线
            - value: '6'
              newvalue: 下线等待
            - value: '7'
              newvalue: 离线
            - value: '8'
              newvalue: 失去连接
            - value: '9'
              newvalue: 启动
            - value: '10'
              newvalue: 加载
            - value: '11'
              newvalue: 错误
            - value: '12'
              newvalue: 系统不支持获取槽位状态
        - uuid: 9250b43564e64b6890deb1c1f2a9e578
          name: 'HILLSTONE-POWER-MIB::hillstonePowerState'
          mappings:
            - value: '0'
              newvalue: 良好
            - value: '1'
              newvalue: 不在位
            - value: '2'
              newvalue: 警告
            - value: '3'
              newvalue: 失败
            - value: '4'
              newvalue: 失败或者未供电
            - value: '5'
              newvalue: 系统不支持获取电源状态
        - uuid: 6532df14b61d49ac8bfbce77fc77173a
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: e01c5708a5d943728bb41d2c44f42db0
          name: 'IF-MIB::Interface type'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: faf5c3f0c16b431fa114048e18911c43
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: e644098adc7b4891b98fd39949a73367
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 2ebc00132ed34a5daa8c4490dc2bf24a
      expression: 'last(/Hillstone SX series by SNMP/hillstone.sysCurSession)>0 and last(/Hillstone SX series by SNMP/hillstone.sysTotalSession)>0 and min(/Hillstone SX series by SNMP/hillstone.sysCurSession,5m)*100/last(/Hillstone SX series by SNMP/hillstone.sysTotalSession)>{$SESSION.UTIL.CRIT}'
      name: 'Hillstone: High Session utilization'
      event_name: 'Hillstone: High Session utilization'
      priority: WARNING
  graphs:
    - uuid: 83d8068294e540cdad9b4c5ab51b7d60
      name: session并发
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Hillstone SX series by SNMP'
            key: hillstone.sysCurSession
    - uuid: a77c752ad3b2419384d3b5a619fc3956
      name: session新建
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Hillstone SX series by SNMP'
            key: hillstone.sysRamupRate
    - uuid: 9a45dcdfad4a4651bb741a3f254ecf01
      name: 主控卡内存利用率
      graph_items:
        - color: FF0000
          calc_fnc: ALL
          item:
            host: 'Hillstone SX series by SNMP'
            key: hillstone.memory.utilization
    - uuid: ac8a990f3e564f61ae60d89a0a1e0f2b
      name: 整机流量
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Hillstone SX series by SNMP'
            key: hillstone.sysOverallThroughput
