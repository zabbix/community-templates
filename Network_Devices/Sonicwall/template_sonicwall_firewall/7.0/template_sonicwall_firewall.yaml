zabbix_export:
  version: '7.0'
  template_groups:
  - uuid: c5381dc540504dbba10e2d300554e4cd
    name: Firewall
  templates:
  - uuid: fb23d8d3752b4d4e8d19afe70b430993
    template: Sonicwall Firewall
    name: Sonicwall Firewall
    description: |
      ## Overview
      This template provides comprehensive monitoring for SonicWall firewall appliances using SNMPv2/v3 protocol. It delivers complete visibility into system health, network performance, VPN connectivity, BGP routing, security services, and multi-device management across physical and virtual firewall deployments.

      ## Core Features
      - **Multi-Protocol Support**: SNMPv2 (validated) / SNMPv3 (compatible)
      - **Hardware Monitoring**: CPU, memory, system health, and performance metrics
      - **Network Performance**: Multi-interface type discovery with traffic analysis and error detection
      - **VPN Monitoring**: Policy-based and route-based tunnel monitoring with comprehensive statistics
      - **BGP Routing**: Dynamic neighbor discovery with session state and route tracking
      - **Security Services**: GAV, IPS/IDS, Anti-Spyware, and Mail Security monitoring
      - **High Availability**: Cluster status and member health monitoring
      - **Enterprise Management**: Multi-device discovery and centralized monitoring
      - **Proactive Alerting**: 25+ triggers with configurable thresholds and flap detection
      - **Rich Visualization**: Integrated dashboard with honeycomb widgets and traffic overlays

      ## Monitoring Components

      ### Items (53 Base Metrics)
      - **System Information**: 
        * Device uptime, firmware version, serial number, model identification
        * SNMP system description, location, and administrator contact
        * System health indicators and performance counters
      - **Security Services Statistics**:
        * GAV (Gateway AntiVirus): scan requests, threats blocked, scan latency
        * IDS/IPS: intrusion detection and prevention statistics
        * Anti-Spyware: scan requests, threats blocked, processing time
        * Mail Security: email scanning and threat prevention metrics
      - **BGP Routing Metrics**:
        * BGP neighbor session statistics and route advertisement tracking
        * Routing table updates and convergence monitoring
      - **VPN Master Items**:
        * Policy-based VPN SA (Security Association) table data
        * Route-based VPN tunnel interface statistics
        * VPN connectivity health and performance metrics
      - **System Performance**:
        * CPU utilization across multiple processor cores
        * Memory usage, cache utilization, and swap statistics
        * SNMP agent responsiveness and system availability

      ### Discovery Rules (12 Active Rules)
      - **BGP Neighbors**: 
        * Discovery: Dynamic BGP peer identification and state monitoring
        * Metrics: Session state, routes received, peer uptime
        * Update: 10-minute discovery with real-time session monitoring
      - **Processors**: 
        * Discovery: Multi-core CPU enumeration for load balancing analysis
        * Metrics: Per-processor utilization percentage
        * Update: Hourly discovery with 2-minute utilization polling
      - **Network Interfaces (Multiple Types)**:
        * Ethernet Interfaces: Physical RJ-45 and vendor-specific ports (ifType=6)
        * Fiber Interfaces: Fiber optic connections (ifType=56)
        * VLAN Interfaces: Virtual LAN segmentation (ifType=135)
        * LAG/Bonded Interfaces: Link aggregation groups (ifType=161)
        * VTI Interfaces: Virtual Tunnel Interfaces (ifType=131)
        * Filter: Configurable interface exclusion patterns for HA-Link and unused ports
        * Update: Hourly discovery with 2-minute traffic and error monitoring
      - **VPN Tunnels (Dual Monitoring Approaches)**:
        * Policy-Based VPNs: IPsec Security Association discovery with subnet pair mapping
        * Route-Based VPNs: VTI tunnel interface monitoring with persistent configuration
        * Filter: Tunnel exclusion patterns for maintenance and inactive tunnels
        * Update: Hourly discovery with real-time traffic and status monitoring
      - **Firewall Statistics**: 
        * Discovery: Internal firewall counter enumeration
        * Metrics: Connection tracking, NAT statistics, policy enforcement
        * Update: Hourly discovery with 5-minute statistical polling
      - **SonicWall Devices**: 
        * Discovery: Multi-device management for cluster deployments
        * Metrics: Device status, model identification, firmware tracking
        * Update: 6-hour discovery for stable enterprise environments

      ### Item Prototypes (Per Discovery Instance)
      - **Network Interface Metrics**:
        * Traffic: Inbound/outbound bytes and packets per second
        * Errors: Interface-specific error counters with threshold alerting
        * Status: Operational state, administrative state, speed detection
        * Performance: Utilization percentage and bandwidth analysis
      - **VPN Tunnel Metrics**:
        * Policy-Based: SA creation time, tunnel status, traffic statistics
        * Route-Based: VTI traffic throughput, connection uptime, tunnel health
        * Security: Encryption status, authentication tracking, SA lifecycle
        * Performance: Tunnel latency, throughput analysis, error detection
      - **BGP Routing Metrics**:
        * Session Management: Neighbor state, session uptime, connection stability
        * Route Analysis: Routes received, prefix tracking, convergence monitoring
        * Performance: Update processing, route flap detection, peer responsiveness
      - **Hardware Performance Metrics**:
        * CPU: Per-processor utilization with load balancing analysis
        * Interfaces: Type-specific performance optimization and error tracking
        * Statistics: Firewall-specific counters and security policy enforcement

      ### Trigger Prototypes (Proactive Alerting)
      - **Network Interface Triggers**:
        * Interface State Changes: Immediate alerting on operational/administrative state
        * High Error Rates: Configurable thresholds for inbound/outbound error detection
        * Traffic Anomalies: Interface utilization and performance degradation alerts
        * Connection Flapping: Interface stability monitoring with hysteresis
      - **VPN Tunnel Triggers**:
        * Tunnel State Changes: Policy-based and route-based tunnel status monitoring
        * Connection Stability: VPN flap detection with configurable sensitivity
        * Traffic Interruption: Tunnel throughput and connectivity health alerts
      - **BGP Routing Triggers**:
        * Route Count Thresholds: Critical and warning alerts for route table size
        * Session Stability: BGP neighbor state change detection and flap monitoring
      - **System Health Triggers**:
        * CPU High Utilization: Per-processor threshold alerting with load distribution
        * Performance Degradation: System responsiveness and health monitoring

      ### Graph Prototypes (Visual Analytics)
      - **Network Performance Graphs**:
        * Interface Traffic: Type-specific throughput analysis with error overlays
        * Multi-Interface: Ethernet, Fiber, VLAN, LAG, and VTI traffic visualization
        * Performance Trends: Bandwidth utilization and capacity planning analysis
      - **VPN Performance Graphs**:
        * Policy-Based VPN: Tunnel-specific traffic analysis with SA lifecycle
        * Route-Based VPN: VTI throughput monitoring with persistent configuration
        * Aggregated VPN: Combined tunnel performance for capacity planning
      - **System Performance Graphs**:
        * CPU Utilization: Multi-processor performance trending and load analysis
        * BGP Routing: Route count trends and session stability monitoring
        * Security Services: GAV, IPS/IDS, and Anti-Spyware performance tracking

      ## Dashboard Integration

      ### Executive Overview Page
      - **Cluster Widget**: Multi-severity problem classification with drill-down capability
      - **System Health Summary**: Device status, firmware tracking, and performance KPIs
      - **Security Services Dashboard**: GAV, IPS/IDS, Anti-Spyware threat detection rates
      - **Performance Monitoring**: CPU, memory, and system responsiveness metrics

      ### Network Infrastructure Page
      - **Interface Honeycomb Widget**: Visual interface status matrix with traffic indicators
      - **VLAN Performance Widget**: Virtual network segmentation and traffic analysis
      - **LAG/Bonding Status**: Link aggregation health and load distribution
      - **Traffic Heat Map**: Network utilization analysis with capacity planning

      ### VPN Monitoring Page
      - **Policy VPN Widget**: IPsec tunnel status matrix with subnet pair mapping
      - **VTI Interface Widget**: Route-based VPN configuration and performance
      - **VPN Throughput Analysis**: Combined tunnel traffic with encryption overhead
      - **Connection Stability**: Tunnel uptime statistics and flap detection

      ### BGP Routing Page
      - **BGP Neighbor Widget**: Dynamic peer discovery with session state visualization
      - **Route Analysis**: Prefix tracking, convergence monitoring, and table growth
      - **Routing Performance**: Update processing and peer responsiveness metrics
      - **Network Topology**: BGP session mapping and redundancy analysis

      ## Device Compatibility

      ### Supported Hardware
      - **TZ Series**: TZ270, TZ370, TZ470, TZ570, TZ670 (Small Business/Home Office)
      - **NSA Series**: NSA2650, NSA3650, NSA4650, NSA5650, NSA6650 (Mid-Range)
      - **NSa Series**: NSa2700, NSa3700, NSa4700, NSa5700, NSa6700 (High Performance)
      - **SuperMassive Series**: SM9200, SM9400, SM9600, SM9800 (Enterprise)
      - **Virtual Appliances**: SonicWall NSv Series (Cloud/Virtualized)

      ### Firmware Compatibility
      - **SonicOS 6.5.x**: Full feature support with legacy MIB compatibility
      - **SonicOS 7.x**: Enhanced monitoring with expanded SNMP objects
      - **SonicOS 7.1+**: Advanced BGP monitoring and multi-device management

      ## Advanced Features

      ### Enterprise Integration
      - **Multi-Device Management**: Centralized monitoring for SonicWall clusters
      - **HA Monitoring**: Active/passive cluster health and synchronization
      - **Scalable Discovery**: Configurable filters for large-scale deployments
      - **Performance Optimization**: Intelligent polling intervals with DISCARD_UNCHANGED

      ### Security Monitoring
      - **Real-Time Threat Detection**: GAV, IPS/IDS threat blocking statistics
      - **Service Performance**: Security scan latency and throughput analysis
      - **License Tracking**: Security service availability and renewal monitoring
      - **Compliance Reporting**: Security policy enforcement and audit trails

      ### Network Intelligence
      - **BGP Route Analysis**: Dynamic routing intelligence and convergence tracking
      - **VPN Redundancy**: Multiple tunnel path monitoring and failover detection
      - **Interface Optimization**: Type-specific monitoring for diverse connectivity
      - **Traffic Engineering**: Bandwidth analysis and capacity planning tools

      Author: Simon Jackson / @sjackson0109
    vendor:
      name: SonicWall
      version: 6.x-7.x
    groups:
    - name: Firewall
    items:
    - uuid: 776cea823ebd460dac46fed8a3338892
      name: AntiSpyware Scan Requests
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.5.2.1.0
      key: asw.scan.requests
      status: DISABLED
      units: scans
      description: Total number of AntiSpyware scan requests
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      - type: CHANGE_PER_SECOND
        parameters:
        - ''
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: ASW
      delay: 2m
      history: 30d
    - uuid: eec8f68d142b46b6b5baf0239d055d89
      name: AntiSpyware Scan Time
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.5.2.4.0
      key: asw.scan.time
      status: DISABLED
      units: ms
      description: Average time taken for AntiSpyware scans
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: ASW
      delay: 2m
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 9419bf5f668246d7be619a72363502aa
      name: AntiSpyware Threats Blocked
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.5.2.3.0
      key: asw.threats.blocked
      status: DISABLED
      units: threats
      description: Total number of spyware threats blocked
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      - type: CHANGE_PER_SECOND
        parameters:
        - ''
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: ASW
      delay: 2m
      history: 30d
    - uuid: 580aa84226934bffa927cac6e1ca4238
      name: AntiSpyware Threats Detected
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.5.2.2.0
      key: asw.threats.detected
      status: DISABLED
      units: threats
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      - type: CHANGE_PER_SECOND
        parameters:
        - ''
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: ASW
      delay: 2m
      history: 30d
    - uuid: b18b32590676472e94da25b71e73be36
      name: 'BGP: Total Messages Received'
      type: SNMP_AGENT
      snmp_oid: walk[1.3.6.1.2.1.15.3.1.12]
      key: bgp.messages.total.received
      delay: 5m
      history: 7d
      value_type: TEXT
      trends: '0'
      description: 'SNMP walk of total BGP messages received per neighbor (BGP4-MIB::bgpPeerInTotalMessages).


        Tracks overall BGP protocol activity and session health.

        '
      tags:
      - tag: Component
        value: BGP
    - uuid: d78a610c542642788c01af4a1109d91a
      name: 'BGP: Neighbor States'
      type: SNMP_AGENT
      snmp_oid: walk[1.3.6.1.2.1.15.3.1.2]
      key: bgp.neighbors.states
      delay: 5m
      history: 7d
      value_type: TEXT
      trends: '0'
      description: 'SNMP walk of BGP neighbor states (BGP4-MIB::bgpPeerState).


        States:

        1=idle, 2=connect, 3=active, 4=opensent, 5=openconfirm, 6=established


        This provides visibility into BGP session stability and convergence issues.

        '
      tags:
      - tag: Component
        value: BGP
    - uuid: e89f720d643745fa9d12bf5b2209e82b
      name: 'BGP: Received Routes Count'
      type: SNMP_AGENT
      snmp_oid: walk[1.3.6.1.2.1.15.3.1.10]
      key: bgp.routes.received
      delay: 5m
      history: 7d
      value_type: TEXT
      trends: '0'
      description: 'SNMP walk of BGP update messages received per neighbor (BGP4-MIB::bgpPeerInUpdates).


        Monitors route updates and detects:

        - Route flapping

        - Routing table changes

        - BGP session activity

        - Convergence problems

        '
      tags:
      - tag: Component
        value: BGP
    - uuid: f9a0831e754846fb8e23c06c3309f93c
      name: 'BGP: Session Uptime'
      type: SNMP_AGENT
      snmp_oid: walk[1.3.6.1.2.1.15.3.1.16]
      key: bgp.session.uptime
      delay: 5m
      history: 7d
      value_type: TEXT
      trends: '0'
      description: 'SNMP walk of BGP session uptime per neighbor (BGP4-MIB::bgpPeerFsmEstablishedTime).


        Tracks BGP session stability and detects frequent reconnections.

        '
      tags:
      - tag: Component
        value: BGP
    - uuid: 230a69f6142c4499a605bced9bf6e7e3
      name: GAV Scan Count
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.5.1.1.0
      key: gav.scan.count
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: GAV
      delay: 2m
      history: 30d
    - uuid: 50f9cd82709c47ee831a5ff9749ac0ee
      name: GAV Virus Count
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.5.1.2.0
      key: gav.virus.count
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: GAV
      delay: 2m
      history: 30d
    - uuid: ad876b04a8dd491f9a01adfad5ce71b8
      name: IDS Attacks Blocked
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.6.2.2.0
      key: ids.attacks.blocked
      status: DISABLED
      units: attacks
      description: Total number of attacks blocked by IDS
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: IDS
      delay: 2m
      history: 30d
    - uuid: 5700d4114d5849d5b714ba54dd36641d
      name: IDS Attacks Detected
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.6.2.1.0
      key: ids.attacks.detected
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: IDS
      delay: 2m
      history: 30d
    - uuid: fabb8b1fd2284e52ab804e1b3aeba46d
      name: IPS Attacks Blocked
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.6.1.1.0
      key: ips.attacks.blocked
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: IPS
      delay: 2m
      history: 30d
    - uuid: 232999d1075740c99141c0b7aebce42c
      name: IPS Attacks Detected
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.6.2.1.0
      key: ips.attacks.detected
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: IPS
      triggers:
      - uuid: 1a94a02f641d4b0bb1677153a43097d3
        expression: min(/Sonicwall Firewall/ips.attacks.detected,5m) > {$SONICWALL_IPS_ATTACK_THRESHOLD}
        name: High IPS Attack Detection Rate
        priority: WARNING
        description: 'IPS detected {ITEM.LASTVALUE} attacks (threshold: {$SONICWALL_IPS_ATTACK_THRESHOLD})'
      delay: 2m
      history: 30d
    - uuid: 583a9eb670824e8fbc2748bcc1902a0f
      name: Mail Good Allowed
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.4.2.0
      key: mail.allowed
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: Mail
      history: 30d
    - uuid: f215d1044787409c8ed1d801e376781d
      name: Mail Spam Detected
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.4.3.0
      key: mail.spam.detected
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: Mail
      history: 30d
    - uuid: 71f2827827694e27950efdc26b648135
      name: Mail Total Count
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.4.1.0
      key: mail.total.count
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: Mail
      history: 30d
    - uuid: 13e7fa716385460b8280ff5afd54537b
      name: Mail Virus Detected
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.4.5.0
      key: mail.virus.detected
      status: DISABLED
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: Feature
      - tag: Feature
        value: Security
      - tag: Service
        value: Mail
      delay: 2m
      history: 30d
    - uuid: 0ab1942f865947fc9f34d17d4409004d
      name: 'Routing: IP Route Table'
      type: SNMP_AGENT
      snmp_oid: walk[1.3.6.1.2.1.4.21.1.7,1.3.6.1.2.1.4.21.1.1,1.3.6.1.2.1.4.21.1.11]
      key: routing.table.ip
      delay: 10m
      history: 7d
      value_type: TEXT
      trends: '0'
      description: 'SNMP walk of IP routing table showing next hops, destinations, and metrics.


        Monitors:

        - Route convergence

        - Next-hop changes

        - Route metrics

        - Tunnel failover detection

        '
      tags:
      - tag: Component
        value: Routing
    - uuid: ab8294f669e54a40acd47663fafb1a27
      name: Connections - Active
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.1.2.0
      key: sonicwall.connections.active
      value_type: FLOAT
      units: connections
      description: Current active firewall connections
      tags:
      - tag: Metrics
        value: Performance
      triggers:
      - uuid: 15badb8904af4b32bf2779791835105c
        expression: last(/Sonicwall Firewall/sonicwall.connections.active) > {$SONICWALL_DDOS_THRESHOLD}
        name: Possible DDoS Attack
        priority: AVERAGE
        description: Total connections ({ITEM.LASTVALUE}) exceeded threshold ({$SONICWALL_DDOS_THRESHOLD})
        tags:
        - tag: Condition
          value: DDOS-Attack?
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 7f81c6d3652b4dd4a1bb116a75cf95f1
      name: Connections - Max
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.1.1.0
      key: sonicwall.connections.max
      value_type: FLOAT
      units: connections
      description: Maximum no of active firewall connections supported
      tags:
      - tag: Metrics
        value: Performance
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 57a7c37acfc04dfca6944528cebca3c6
      name: Connections - Usage (%)
      type: CALCULATED
      key: sonicwall.connections.usage
      units: '%'
      params: 100 * last(//sonicwall.connections.active) / last(//sonicwall.connections.max)
      tags:
      - tag: Metrics
        value: Performance
      triggers:
      - uuid: 9095dbb337734a4aac65e786e7b728fe
        expression: min(/Sonicwall Firewall/sonicwall.connections.usage,5m)>{$SONICWALL_CONN_USAGE_WARN}
        name: High Connection Usage (>{$SONICWALL_CONN_USAGE_WARN})
        description: Connection table usage exceeded threshold macro {$SONICWALL_CONN_USAGE_WARN} in the last 5 minutes.
        tags:
        - tag: Component
          value: Connections
        - tag: Condition
          value: Threshold
        - tag: Symptoms
          value: High Connection Count
      delay: 1m
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 10e12f7f3d434f9fa8f182223973cc09
      name: Device Administrator
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.4.0
      key: sonicwall.contact
      delay: 5m
      history: 1w
      value_type: CHAR
      trends: '0'
      description: Device Administrator
      inventory_link: CONTACT
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: Component
        value: System
    - uuid: 31e66e3942ff44fb90b81ea85abcd944
      name: CPU Utilisation
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.1.3.0
      key: sonicwall.cpu.utilisation
      units: '%'
      description: Instantaneous CPU Utilisation in percent
      tags:
      - tag: Component
        value: Memory
      - tag: Metrics
        value: Performance
      triggers:
      - uuid: 9f180f268ee14701883cf6bb4aa80635
        expression: avg(/Sonicwall Firewall/sonicwall.cpu.utilisation,5m) > {$SONICWALL_CPU_ERROR}
        name: High CPU Usage (Error)
        priority: HIGH
        description: System processor usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_CPU_ERROR%), on average
          over past 5 minutes
        tags:
        - tag: Condition
          value: Threshold
      - uuid: 7950a7db6ea94a9d981c7de4d92d56b4
        expression: avg(/Sonicwall Firewall/sonicwall.cpu.utilisation,5m) > {$SONICWALL_CPU_WARNING}
        name: High CPU Usage (Warning)
        priority: AVERAGE
        description: System processor usage exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_CPU_WARNING%), on average over
          past 5 minutes
        tags:
        - tag: Condition
          value: Threshold
      delay: 1m
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 5eff14943f004a9b86f02d02684a341e
      name: DPI SSL Connections - Current
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.5.1.0
      key: sonicwall.dpissl.conn.current
      delay: 2m
      value_type: FLOAT
      units: conn
      description: Current active firewall connections
      tags:
      - tag: Metrics
        value: Performance
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 21124dc1a98a472d8ac851dedb3ac6b8
      name: DPI SSL Connections - Max
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.5.3.0
      key: sonicwall.dpissl.conn.max
      delay: 2m
      value_type: FLOAT
      units: conn
      description: Current active firewall connections
      tags:
      - tag: Metrics
        value: Performance
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 409694e436c44019b2292375ca8ecf38
      name: DPI SSL Connections - Usage (%)
      type: CALCULATED
      key: sonicwall.dpissl.conn.usage
      units: '%'
      params: 100 * last(//sonicwall.dpissl.conn.current) / last(//sonicwall.dpissl.conn.max)
      tags:
      - tag: Metrics
        value: Performance
      triggers:
      - uuid: b450096f58104d85a952dc5fb5a1939c
        expression: min(/Sonicwall Firewall/sonicwall.dpissl.conn.usage,5m)>{$SONICWALL_DPISSL_USAGE_WARN}
        name: High DPI-SSL Usage (>{$SONICWALL_DPISSL_USAGE_WARN})
        description: DPI SSL usage exceeded threshold macro {$SONICWALL_DPISSL_USAGE_WARN} in the last 5 minutes.
        tags:
        - tag: Component
          value: Connections
        - tag: Condition
          value: Threshold
        - tag: Symptoms
          value: High Connection Count
      delay: 1m
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 000e78a73db74e568cf407866d5a3113
      name: Device Firmware Version
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.1.0
      key: sonicwall.firmware
      delay: 5m
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Firmware version currently running on the SonicWall device.
      inventory_link: SOFTWARE
      preprocessing:
      - type: REGEX
        parameters:
        - ^.*\((.*)\)$
        - \1
      - type: STR_REPLACE
        parameters:
        - 'SonicOS '
        - ''
      - type: STR_REPLACE
        parameters:
        - 'Enhanced '
        - ''
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: 39f6c0007a104949b105645debe13922
      name: HA Primary Status
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.1.1.0
      key: sonicwall.ha.primary.status
      value_type: FLOAT
      valuemap:
        name: sonicwall.ha.status.valuemap
      preprocessing:
      - type: DISCARD_UNCHANGED
        parameters:
        - ''
      tags:
      - tag: Component
        value: HA
      - tag: Role
        value: Primary
      history: 30d
    - uuid: 95cb2764ee524b4694d0612c9e869292
      name: HA Secondary Status
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.1.2.0
      key: sonicwall.ha.secondary.status
      value_type: FLOAT
      valuemap:
        name: sonicwall.ha.status.valuemap
      preprocessing:
      - type: DISCARD_UNCHANGED
        parameters:
        - ''
      tags:
      - tag: Component
        value: HA
      - tag: Role
        value: Secondary
      history: 30d
    - uuid: 2eba2a5d85e5428d93b7b7d307525c0d
      name: Device Location
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.6.0
      key: sonicwall.location
      delay: 6h
      history: 1w
      value_type: CHAR
      trends: '0'
      description: Location currently running on the SonicWall device.
      inventory_link: LOCATION
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: Component
        value: System
    - uuid: a0a0aa8098a74868ac05aad45fbbe25d
      name: Device Model
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.1.0
      key: sonicwall.model
      delay: 5m
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Model name or identifier of the SonicWall hardware.
      inventory_link: MODEL
      preprocessing:
      - type: REGEX
        parameters:
        - ^(.*?)\s?\(.*\)$
        - \1
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: a22a81fe13e6467197ed76a7d3a99345
      name: Device Name
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.5.0
      key: sonicwall.name
      delay: 6h
      history: 1w
      value_type: CHAR
      trends: '0'
      description: An administratively-assigned name for this managed node.
      inventory_link: NAME
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: Component
        value: System
    - uuid: 2bf7e3a5c8d94f2eb1a6d9e4f7c2b8a5
      name: Device Primary MAC Address
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.2.2.1.6.1
      key: sonicwall.primary.mac
      delay: 1h
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Primary interface MAC address (typically X0/management interface)
      inventory_link: MACADDRESS_A
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: 636c8a8b003d4235bf3b12d76da98bf0
      name: Device Primary Serial
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.2.1.1.2.0
      key: sonicwall.primary.serial
      delay: 5m
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Primary Serial Number
      inventory_link: SERIALNO_A
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: 617a5722949f44a9bd47d2eb3aceaba9
      name: RAM Utilisation
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.1.4.0
      key: sonicwall.ram.utilisation
      units: '%'
      description: Instantaneous RAM Utilisation in percent
      tags:
      - tag: Component
        value: Memory
      - tag: Metrics
        value: Performance
      triggers:
      - uuid: 890e6b3356f445d5b55a0e491c7d2efe
        expression: avg(/Sonicwall Firewall/sonicwall.ram.utilisation,5m) > {$SONICWALL_RAM_ERROR}
        name: High RAM Usage (Error)
        priority: HIGH
        description: System processor usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_RAM_ERROR)%, on average
          over past 5 minutes
        tags:
        - tag: Condition
          value: Threshold
      - uuid: b3a99759295f4ed0a47d88be3b07b6a8
        expression: avg(/Sonicwall Firewall/sonicwall.ram.utilisation,5m) > {$SONICWALL_RAM_WARNING}
        name: High RAM Usage (Warning)
        priority: AVERAGE
        description: System processor usage exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_RAM_WARNING)%, on average over
          past 5 minutes
        tags:
        - tag: Condition
          value: Threshold
      delay: 1m
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: e8866dac9055439ca020af54663cdc3e
      name: Device ROM Version
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.2.1.1.4.0
      key: sonicwall.rom.version
      delay: 5m
      history: 1w
      value_type: TEXT
      trends: '0'
      description: ROM version currently running on the SonicWall device.
      inventory_link: HARDWARE
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: 8d4f6a2b9e5c47f8a3b7e6d1c4f9a2e5
      name: Device Secondary MAC Address
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.2.2.1.6.2
      key: sonicwall.secondary.mac
      delay: 1h
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Secondary interface MAC address (typically X1/WAN interface)
      inventory_link: MACADDRESS_B
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: b616f5b1ee8e48c384221421821c715c
      name: Device Secondary Serial
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.2.1.1.3.0
      key: sonicwall.secondary.serial
      delay: 5m
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Secondary Serial Number
      inventory_link: SERIALNO_B
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 24h
      tags:
      - tag: Component
        value: System
    - uuid: cd5a053b404448d5809621c103573a39
      name: WAN Interfaces
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.8741.1.3.7.1.1.1.3.87.65.78
      key: sonicwall.wan.ports
      delay: 5m
      history: 1w
      value_type: TEXT
      trends: '0'
      description: Physical port assignments for WAN zone (e.g., "X1,X2")
      preprocessing:
      - type: TRIM
        parameters:
        - '"'
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 4h
      tags:
      - tag: Component
        value: Zone
      - tag: Zone
        value: WAN
    - uuid: 27ae43ee1d874829af0ced3313609d6b
      name: Device Temperature
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.99.1.1.1.4.4.0
      key: temperature
      delay: 5m
      status: DISABLED
      units: "\xC2\xB0C"
      tags:
      - tag: Component
        value: Temperature
      triggers:
      - uuid: 0d47b9c4560942a6a4ffd37a2b56f777
        expression: last(/Sonicwall Firewall/temperature) > {$SONICWALL_TEMP_ERROR}
        name: "Device Temperature Critical (>{$SONICWALL_TEMP_ERROR}\xC2\xB0C)"
        status: DISABLED
        priority: HIGH
        description: "Device temperature ({ITEM.LASTVALUE}\xC2\xB0C) exceeded critical threshold ({$SONICWALL_TEMP_ERROR}\xC2\
          \xB0C)"
        tags:
        - tag: Condition
          value: Threshold
      - uuid: 183528caeae54f58a5c4b3f086a412bd
        expression: last(/Sonicwall Firewall/temperature) > {$SONICWALL_TEMP_WARNING}
        name: "Device Temperature Warning (>{$SONICWALL_TEMP_WARNING}\xC2\xB0C)"
        status: DISABLED
        priority: WARNING
        description: "Device temperature ({ITEM.LASTVALUE}\xC2\xB0C) exceeded warning threshold ({$SONICWALL_TEMP_WARNING}\xC2\
          \xB0C)"
        tags:
        - tag: Condition
          value: Threshold
      history: 30d
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
    - uuid: 07050a4878c549e894e016a7fe24181d
      name: Device Uptime
      type: SNMP_AGENT
      snmp_oid: SNMPv2-MIB::sysUpTime.0
      key: uptime
      units: uptime
      description: The time since the network management portion of the system was last re-initialised.
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '0.01'
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - '3600'
      tags:
      - tag: Component
        value: System
      history: 30d
    - uuid: 776cea823ebd460dac46fed8a3338894
      name: 'VPN Policy: SA Table'
      type: SNMP_AGENT
      snmp_oid: walk[1.3.6.1.4.1.8741.1.3.2.1.1]
      key: vpn.policy.sa.table
      delay: 5m
      history: 1h
      value_type: TEXT
      trends: '0'
      description: 'An SNMP walk of the ACTIVE policy-based VPN Security Associations table


        Notice:

        VPN Security Associations (SAs) are frequently renegotiated or re-keyed, which causes the SA index to change. For
        this reason, the polling interval is set to 5 minutes - so if our discovery rule runs, it will have up-to-date SA
        data to begin with. Polling less frequently increases the risk of missing statistics for active policy-based tunnels,
        while polling more frequently may be considered overly aggressive.

        '
      tags:
      - tag: Component
        value: VPN
      - tag: VPN
        value: Policy
    discovery_rules:
    - uuid: 1bc2053096a548fd8045e28e5509115e
      name: BGP Neighbors
      type: SNMP_AGENT
      snmp_oid: discovery[{#BGP_NEIGHBOR},1.3.6.1.2.1.15.3.1.7,{#BGP_STATE},1.3.6.1.2.1.15.3.1.2]
      key: bgp.neighbors.discovery
      delay: 10m
      filter:
        conditions:
        - macro: '{#BGP_STATE}'
          value: ^[1-6]$
          formulaid: A
      description: 'Discover BGP neighbors and their current states.


        Provides per-neighbor monitoring for:

        - Session state changes

        - Route count monitoring

        - Flap detection

        - Convergence tracking

        '
      item_prototypes:
      - uuid: 3de4275b99c64aff9267049b7709337f
        name: 'BGP Neighbor: {#BGP_NEIGHBOR} Routes Received'
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.2.1.15.3.1.10.{#BGP_NEIGHBOR}
        key: bgp.neighbor.routes[{#BGP_NEIGHBOR}]
        delay: 5m
        history: 30d
        trends: 90d
        description: Number of routes received from BGP neighbor
        tags:
        - tag: BGP Neighbor
          value: '{#BGP_NEIGHBOR}'
        - tag: Component
          value: BGP
        trigger_prototypes:
        - uuid: 71286c9f8df94e229b9b489da109779f
          expression: last(/Sonicwall Firewall/bgp.neighbor.routes[{#BGP_NEIGHBOR}]) < {$SONICWALL_BGP_ROUTE_THRESHOLD_CRITICAL}
          name: 'BGP Neighbor: {#BGP_NEIGHBOR} Route Count Critical'
          priority: HIGH
          description: 'BGP neighbor {#BGP_NEIGHBOR} has fewer than {$SONICWALL_BGP_ROUTE_THRESHOLD_CRITICAL} routes.


            This may indicate:

            - Routing table corruption

            - Upstream BGP issues

            - Route-map misconfigurations

            - Network partitioning

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: BGP
          - tag: Condition
            value: Route Loss
        - uuid: 8239ed9f9ef94f339c8c59aea20988af
          expression: 'last(/Sonicwall Firewall/bgp.neighbor.routes[{#BGP_NEIGHBOR}]) < {$SONICWALL_BGP_ROUTE_THRESHOLD_WARNING}

            and last(/Sonicwall Firewall/bgp.neighbor.routes[{#BGP_NEIGHBOR}]) >= {$SONICWALL_BGP_ROUTE_THRESHOLD_CRITICAL}

            '
          name: 'BGP Neighbor: {#BGP_NEIGHBOR} Route Count Low'
          priority: WARNING
          description: 'BGP neighbor {#BGP_NEIGHBOR} has fewer than {$SONICWALL_BGP_ROUTE_THRESHOLD_WARNING} routes.


            Monitor for potential routing issues or upstream changes.

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: BGP
          - tag: Condition
            value: Route Warning
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 2cd3164198b549fe9156f39f6609226f
        name: 'BGP Neighbor: {#BGP_NEIGHBOR} State'
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.2.1.15.3.1.2.{#BGP_NEIGHBOR}
        key: bgp.neighbor.state[{#BGP_NEIGHBOR}]
        delay: 2m
        history: 30d
        trends: 90d
        description: 'BGP neighbor state: 1=idle, 2=connect, 3=active, 4=opensent, 5=openconfirm, 6=established'
        valuemap:
          name: bgp.neighbor.state.valuemap
        tags:
        - tag: BGP Neighbor
          value: '{#BGP_NEIGHBOR}'
        - tag: Component
          value: BGP
        trigger_prototypes:
        - uuid: 60175b8e9ce84d119a8a379ca009669f
          expression: (change(/Sonicwall Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}]) > 0 and count(/Sonicwall Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}],{$SONICWALL_FLAPPING_TIMEFRAME})
            > {$SONICWALL_FLAPPING_CHANGE_THRESHOLD})
          name: 'BGP Neighbor: {#BGP_NEIGHBOR} Flapping Detected'
          priority: WARNING
          description: 'BGP neighbor {#BGP_NEIGHBOR} has changed state more than {$SONICWALL_FLAPPING_CHANGE_THRESHOLD} times
            in {$SONICWALL_FLAPPING_TIMEFRAME}.


            This indicates BGP session instability that can cause:

            - Route flapping

            - Convergence delays

            - Tunnel failover issues

            - Traffic black-holing

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: BGP
          - tag: Condition
            value: Flapping
        - uuid: 5f064a7e9bd84c009489269b9909559f
          expression: 'last(/Sonicwall Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}]) <> 6

            and nodata(/Sonicwall Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}],{$SONICWALL_BGP_NEIGHBOR_TIMEOUT}) = 0

            '
          name: 'BGP Neighbor: {#BGP_NEIGHBOR} Session Down'
          priority: HIGH
          description: 'BGP neighbor {#BGP_NEIGHBOR} is not in Established state (6).


            Current states:

            1=idle, 2=connect, 3=active, 4=opensent, 5=openconfirm, 6=established


            This indicates BGP routing issues that may affect tunnel failover and convergence.

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: BGP
          - tag: Condition
            value: Session Down
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 4ef5386d8ad74bf09378159d8809448f
        name: 'BGP Neighbor: {#BGP_NEIGHBOR} Uptime'
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.2.1.15.3.1.16.{#BGP_NEIGHBOR}
        key: bgp.neighbor.uptime[{#BGP_NEIGHBOR}]
        delay: 5m
        history: 30d
        trends: 90d
        units: uptime
        description: BGP neighbor session uptime in seconds
        tags:
        - tag: BGP Neighbor
          value: '{#BGP_NEIGHBOR}'
        - tag: Component
          value: BGP
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
    - uuid: 58ebb24e494d4e7eb3437d95f9abfe58
      name: Processors
      type: SNMP_AGENT
      snmp_oid: discovery[{#CPUFWID},HOST-RESOURCES-MIB::hrProcessorLoad]
      key: cpu.discovery
      delay: 1h
      description: Discover the processors of the firewall device
      item_prototypes:
      - uuid: 503d76e0ce784d088c7768b3e14e7ff6
        name: CPU Utilisation {#CPUFWID}
        type: SNMP_AGENT
        snmp_oid: HOST-RESOURCES-MIB::hrProcessorLoad.{#CPUFWID}
        key: hrProcessorLoad[{#CPUFWID}]
        units: '%'
        description: The average, over the last minute, of the percentage of time that this processor was not idle. Implementations
          may approximate this one minute smoothing period if necessary.
        tags:
        - tag: Component
          value: System
        - tag: CPU
          value: Utilisation
        trigger_prototypes:
        - uuid: 891cd55755a648caba85846b80759bee
          expression: 'avg(/Sonicwall Firewall/hrProcessorLoad[{#CPUFWID}],5m)>{$SONICWALL_CPU_ERROR}

            and

            count(/Sonicwall Firewall/hrProcessorLoad[{#CPUFWID}],5m,"gt",{$SONICWALL_CPU_ERROR}) > 3

            '
          name: CPU {#CPUFWID} Utilisation over {$SONICWALL_CPU_ERROR}%
          priority: HIGH
          description: CPU {#CPUFWID} on {HOST.NAME} is over {$SONICWALL_CPU_ERROR}%
          tags:
          - tag: Condition
            value: Threshold
        delay: 1m
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      graph_prototypes:
      - uuid: 282f59dcf7854b6cab11bde4636e56f5
        name: Processor Utilisation{#CPUFWID}
        width: '600'
        height: '340'
        ymin_type_1: FIXED
        ymax_type_1: FIXED
        graph_items:
        - color: 1A7C11
          item:
            host: Sonicwall Firewall
            key: hrProcessorLoad[{#CPUFWID}]
    - uuid: e6e32eb374ea4517871ab696cb2917b6
      name: Interfaces (Ethernet)
      type: SNMP_AGENT
      snmp_oid: discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]
      key: ethernet.discovery
      delay: 1h
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFDESCR}'
          value: .*HA-Link*
          operator: NOT_MATCHES_REGEX
          formulaid: A
        - macro: '{#IFDESCR}'
          value: ^.*\(Unassigned\)$
          operator: NOT_MATCHES_REGEX
          formulaid: B
        - macro: '{#IFTYPE}'
          value: ^(6|117|127|128|161|560|561|800)$
          formulaid: C
      description: "Discover physical Ethernet interfaces on the firewall.\n\nThis includes standard RJ-45 interfaces and\
        \ some vendor-specific virtual Ethernet types.\nInterface detection is based on:\n - `ifType = 6` (ethernetCsmacd)\n\
        \ - Extended types such as `117`, `127`, `128`, `161`, `560\xE2\u20AC\u201C561`, `800` (used on various SonicWall\
        \ models)\n\nFiltering is applied to:\n - Exclude HA-link interfaces\n - Exclude unassigned or \"Portshield(ed) To\
        \ Host\" pseudo-interfaces\n\nNote:\n - This rule does not detect LAG (Link Aggregation) interfaces \xE2\u20AC\u201D\
        \ see `Interfaces (LAG/Bonded)` for that.\n - SonicWall sometimes reports bonded or VLAN-tagged interfaces under `ifType=6`;\
        \ rely on `ifDescr` + interface naming to classify appropriately.\n"
      item_prototypes:
      - uuid: ea03a12ce8ce47b0aa0cf8d91ebb623a
        name: 'Interface: {#IFDESCR} Errors In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInErrors.{#SNMPINDEX}
        key: ethernet.ifInErrors[{#IFDESCR}]
        description: Inbound errors on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Ethernet
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 1ea5c9dfb4cd47fab81c6174bd81fa26
          expression: count(/Sonicwall Firewall/ethernet.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2
          name: Interface {#IFDESCR} Inbound Errors
          priority: WARNING
          description: Inbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}
            over the past 5 mins)
          tags:
          - tag: Condition
            value: Threshold
        - uuid: c5fdc6304b3b4b24a51668859dded4ef
          expression: count(/Sonicwall Firewall/ethernet.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2
          name: Interface {#IFDESCR} status changed
          priority: AVERAGE
          manual_close: 'YES'
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 975303619c04411bb9bf189f4c535c5e
        name: 'Interface: {#IFDESCR} Bytes In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInOctets.{#SNMPINDEX}
        key: ethernet.ifInOctets[{#IFDESCR}]
        units: Bps
        description: Incoming traffic on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Ethernet
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: 96fb55e64c97475d80a610214520e718
        name: 'Interface: {#IFDESCR} Errors Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutErrors.{#SNMPINDEX}
        key: ethernet.ifOutErrors[{#IFDESCR}]
        description: Outbound errors on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Ethernet
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: ddc2036479e042f69748eb221cf1aa26
          expression: count(/Sonicwall Firewall/ethernet.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2
          name: Interface {#IFDESCR} Outbound Errors
          priority: WARNING
          description: Outbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}
            over the past 5 mins)
          tags:
          - tag: Condition
            value: Flap/Disconnect/SwitchPort
        history: 30d
      - uuid: 690b15f964de4ab7af94c963249d2816
        name: 'Interface: {#IFDESCR} Bytes Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutOctets.{#SNMPINDEX}
        key: ethernet.ifOutOctets[{#IFDESCR}]
        units: Bps
        description: Outgoing traffic on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Ethernet
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: 36adeb4a0ab14a4ab2daefc352ed1ef5
        name: 'Interface: {#IFDESCR} Status'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOperStatus.{#SNMPINDEX}
        key: ethernet.status[{#IFDESCR}]
        description: Operational status of interface {#IFDESCR}
        valuemap:
          name: sonicwall.interface.status.valuemap
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Ethernet
        - tag: Metrics
          value: State
        history: 30d
      graph_prototypes:
      - uuid: 45a4bba63890410ba1e796a7319d08c7
        name: 'Interface: {#IFDESCR} Traffic'
        graph_items:
        - color: 1A7C11
          item:
            host: Sonicwall Firewall
            key: ethernet.ifInOctets[{#IFDESCR}]
        - sortorder: '1'
          color: 0080FF
          item:
            host: Sonicwall Firewall
            key: ethernet.ifOutOctets[{#IFDESCR}]
        - sortorder: '2'
          drawtype: FILLED_REGION
          color: FF0000
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: ethernet.ifInErrors[{#IFDESCR}]
        - sortorder: '3'
          drawtype: FILLED_REGION
          color: CC6600
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: ethernet.ifOutErrors[{#IFDESCR}]
    - uuid: 0187ded2173647a7a1910004f02ea9e1
      name: Interfaces (Fibre)
      type: SNMP_AGENT
      snmp_oid: discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]
      key: fibre.discovery
      delay: 1h
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFDESCR}'
          value: .*HA-Link*
          operator: NOT_MATCHES_REGEX
          formulaid: A
        - macro: '{#IFDESCR}'
          value: .*Portshield(ed)? (To|Host).*
          operator: NOT_MATCHES_REGEX
          formulaid: B
        - macro: '{#IFDESCR}'
          value: ^.*\(Unassigned\)$
          operator: NOT_MATCHES_REGEX
          formulaid: C
        - macro: '{#IFTYPE}'
          value: ^(39|48|56|195|243|244|559|562)$
          formulaid: D
      description: "Discover fibre-optic or high-speed physical interfaces, typically SFP/SFP+ ports, used for WAN uplinks,\
        \ interconnects, or high-throughput LAN segments.\n\nFibre interface detection is based on `ifType` values such as:\n\
        \ - `39`, `48`, `56` (various Optical types)\n - `195`, `243`, `244` (SONET/SDH, VDSL2, GPON)\n - `559`, `562` (SonicWall-specific\
        \ or reserved high-speed interface types)\n\nFilters are applied to exclude:\n - HA-link ports\n - PortShield(ed)\
        \ pseudo-interfaces\n - Unassigned ports\n\nNote:\n - SonicWall does not consistently separate copper vs fibre via\
        \ `ifType` \xE2\u20AC\u201D verify against `ifDescr` when interface mapping is critical.\n - Some bonded fibre interfaces\
        \ may appear here if not caught by the LAG discovery rule.\n"
      item_prototypes:
      - uuid: 80a6509934c042d18d44c2321c7029a6
        name: 'Interface: {#IFDESCR} Errors In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInErrors.{#SNMPINDEX}
        key: fibre.ifInErrors[{#IFDESCR}]
        description: Inbound errors on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Fibre
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 7050d75c76f5494daa70252deaa640c6
          expression: count(/Sonicwall Firewall/fibre.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2
          name: Interface {#IFDESCR} Inbound Errors
          priority: WARNING
          description: Inbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}/s)
          tags:
          - tag: Condition
            value: Threshold
        - uuid: 0fe58fa2581a4def957450ad5878f92d
          expression: count(/Sonicwall Firewall/fibre.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2
          name: Interface {#IFDESCR} status changed
          priority: AVERAGE
          manual_close: 'YES'
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 08dee29cfa0848e48b06fc2bb4dd932a
        name: 'Interface: {#IFDESCR} Bytes In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInOctets.{#SNMPINDEX}
        key: fibre.ifInOctets[{#IFDESCR}]
        units: Bps
        description: Incoming traffic on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Fibre
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: 33e7a969fbae4305a394d10564bc8e12
        name: 'Interface: {#IFDESCR} Errors Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutErrors.{#SNMPINDEX}
        key: fibre.ifOutErrors[{#IFDESCR}]
        description: Outbound errors on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Fibre
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 45e15536b2fb4f2e9b0078d305d6d4e8
          expression: count(/Sonicwall Firewall/fibre.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2
          name: Interface {#IFDESCR} Outbound Errors
          priority: WARNING
          description: Outbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}/s)
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 34d6bdd82895488bba990f6ebdbda2ed
        name: 'Interface: {#IFDESCR} Bytes Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutOctets.{#SNMPINDEX}
        key: fibre.ifOutOctets[{#IFDESCR}]
        units: Bps
        description: Outgoing traffic on interface {#IFDESCR}
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Fibre
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: 332c1f8ff06248a08e8f619b98729f82
        name: 'Interface: {#IFDESCR} Status'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOperStatus.{#SNMPINDEX}
        key: fibre.status[{#IFDESCR}]
        description: Operational status of interface {#IFDESCR}
        valuemap:
          name: sonicwall.interface.status.valuemap
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: Fibre
        - tag: Metrics
          value: State
        history: 30d
      graph_prototypes:
      - uuid: da4b3b51b35840b7a72ff35943048c5c
        name: 'Fibre Interface: {#IFDESCR} Traffic'
        graph_items:
        - color: 1A7C11
          item:
            host: Sonicwall Firewall
            key: fibre.ifInOctets[{#IFDESCR}]
        - sortorder: '1'
          color: 0080FF
          item:
            host: Sonicwall Firewall
            key: fibre.ifOutOctets[{#IFDESCR}]
        - sortorder: '2'
          drawtype: FILLED_REGION
          color: FF0000
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: fibre.ifInErrors[{#IFDESCR}]
        - sortorder: '3'
          drawtype: FILLED_REGION
          color: CC6600
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: fibre.ifOutErrors[{#IFDESCR}]
    - uuid: 723e5f33af2e4701984d02c9f927ba26
      name: Firewall Stats (FwStats)
      type: SNMP_AGENT
      snmp_oid: discovery[{#INDEX},1.3.6.1.2.1.2.2.1.1.1,{#MODEL},1.3.6.1.2.1.1.1.0]
      key: fwstats.discovery
      delay: 1h
      filter:
        evaltype: AND
        conditions:
        - macro: '{#INDEX}'
          value: ^1$
          formulaid: A
        - macro: '{#MODEL}'
          value: ^(?!.*NSa|NSA).*$
          formulaid: B
      lifetime: 1d
      description: Collects scalar firewall metrics from sonicwallFwStats using synthetic discovery. Only available on some
        models of firewall
      item_prototypes:
      - uuid: 1bd50e81a3644f8b9a1240320dcd555e
        name: Content Filtering Hits [{#INDEX}]
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.9.0
        key: fwstats.sonicCFS[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: Firewall
        - tag: Service
          value: CF
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 88215cb400a44578ae9c9ce5899d2d17
        name: Connnection Cache Entries [{#INDEX}]
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.2.0
        key: fwstats.sonicCurrentConnCacheEntries[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: Firewall
        - tag: Metrics
          value: Performance
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 8075dddd2d4e4ceba3ca21a255c96d2e
        name: CPU Utilisation [{#INDEX}]
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.3.0
        key: fwstats.sonicCurrentCPUUtil[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: System
        - tag: Metrics
          value: Performance
        delay: 1m
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: df750f31668449b09e55c22544c7eb2e
        name: CPU Utilisation [{#INDEX}] - Forward And Inspect
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.8.0
        key: fwstats.sonicCurrentFwdAndInspectCPUUtil[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: System
        - tag: Metrics
          value: Performance
        delay: 1m
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 5af6a549048349efa150c9b33a643d97
        name: CPU Utilisation [{#INDEX}] - Management Plane
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.7.0
        key: fwstats.sonicCurrentManagementCPUUtil[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: System
        - tag: Metrics
          value: Performance
        delay: 1m
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 3e39c1102a09435da7def1f6f7c82d0b
        name: RAM Utilisation [{#INDEX}]
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.5.0
        key: fwstats.sonicCurrentRAMUtil[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: System
        - tag: Metrics
          value: Performance
        trigger_prototypes:
        - uuid: 52f99c32e8f1491691e40c31c519f5d2
          expression: avg(/Sonicwall Firewall/fwstats.sonicCurrentRAMUtil[{#INDEX}],5m) > {$SONICWALL_MEMORY_ERROR}
          name: High Memory Usage (Error) [{#INDEX}]
          priority: HIGH
          description: System memory usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_MEMORY_ERROR}%)
          tags:
          - tag: Condition
            value: Threshold
        - uuid: 7c566e3d0d584c1889b9cd468485ecf4
          expression: avg(/Sonicwall Firewall/fwstats.sonicCurrentRAMUtil[{#INDEX}],5m) > {$SONICWALL_MEMORY_WARNING}
          name: High Memory Usage (Warning) [{#INDEX}]
          priority: AVERAGE
          description: System memory usage exceeded warning threshold ({ITEM.LASTVALUE} > {$SONICWALL_MEMORY_WARNING}%)
          tags:
          - tag: Condition
            value: Threshold
        delay: 1m
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 68433a0bf31442139f9c588683b84825
        name: Max Connection Cache Entries [{#INDEX}]
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.1.0
        key: fwstats.sonicMaxConnCacheEntries[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: System
        - tag: Metrics
          value: Performance
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      - uuid: 91dd0953373049f186a0472510eba808
        name: NAT Translation Count [{#INDEX}]
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.6.0
        key: fwstats.sonicNatTranslationCount[{#INDEX}]
        description: Metrics returned from the sonicwallFwStats table
        tags:
        - tag: Component
          value: Firewall
        - tag: Metrics
          value: Performance
        history: 30d
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
    - uuid: 8857ec72720e45ae9b3c0badc3d8e5f1
      name: Interfaces (LAG/Bonded)
      type: SNMP_AGENT
      snmp_oid: discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFTYPE},IF-MIB::ifType]
      key: lag.discovery
      delay: 1h
      filter:
        conditions:
        - macro: '{#IFTYPE}'
          value: ^(161|166)$
          formulaid: A
      description: "Discover bonded or aggregated interfaces on the firewall, such as Link Aggregation Groups (LAGs) or PortChannel\
        \ interfaces.\n  \nThis rule targets interfaces with:\n - `ifType = 161` (IEEE 802.3ad Link Aggregation)\n - `ifType\
        \ = 166` (MPLS Tunnel \xE2\u20AC\u201D occasionally used for VPN encapsulation in LAG contexts)\n  \nThese interfaces:\n\
        \ - Represent logical bundles of physical links\n - Are often used for uplinks, high-availability paths, or VPN redundancy\
        \  - Report aggregate traffic and error metrics across all member ports\n\n Note:\n - LAG interfaces may coexist with\
        \ Ethernet or Fibre entries; no deduplication is applied.\n - SonicWall interface naming is inconsistent across models\
        \ \xE2\u20AC\u201D validate `ifDescr` labels per deployment.\n"
      item_prototypes:
      - uuid: c72f0151f79c418e89c8838f2d961678
        name: 'LAG: {#IFDESCR} Errors In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInErrors.{#SNMPINDEX}
        key: lag.ifInErrors[{#IFDESCR}]
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: LAG
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 70c4c487c4bf47fbbfa9ef726caec3bc
          expression: count(/Sonicwall Firewall/lag.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2
          name: LAG {#IFDESCR} Inbound Errors
          priority: AVERAGE
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 0ed5af57dfe04b55afc3e7e0db859163
        name: 'LAG: {#IFDESCR} Bytes In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInOctets.{#SNMPINDEX}
        key: lag.ifInOctets[{#IFDESCR}]
        units: Bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: LAG
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: 069d7489a9f244758cc7b6cda5ffa535
        name: 'LAG: {#IFDESCR} Errors Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutErrors.{#SNMPINDEX}
        key: lag.ifOutErrors[{#IFDESCR}]
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: LAG
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 33ed21d43f414eb5a2948c79c0b79c26
          expression: count(/Sonicwall Firewall/lag.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2
          name: LAG {#IFDESCR} Outbound Errors
          priority: AVERAGE
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: b4ba7bc8fbf746cabe9e45187e7410ce
        name: 'LAG: {#IFDESCR} Bytes Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutOctets.{#SNMPINDEX}
        key: lag.ifOutOctets[{#IFDESCR}]
        units: Bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: LAG
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: 196f611499b94fb894049bc6cd2eda70
        name: 'LAG: {#IFDESCR} Status'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOperStatus.{#SNMPINDEX}
        key: lag.status[{#IFDESCR}]
        valuemap:
          name: sonicwall.interface.status.valuemap
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: LAG
        - tag: Metrics
          value: State
        trigger_prototypes:
        - uuid: e9c18edffa4f4676a9326199a9f828c6
          expression: (count(/Sonicwall Firewall/lag.status[{#IFDESCR}],{$SONICWALL_FLAPPING_TIMEFRAME})>1 or change(/Sonicwall
            Firewall/lag.status[{#IFDESCR}])>0) and nodata(/Sonicwall Firewall/lag.status[{#IFDESCR}],120s)=0
          name: LAG {#IFDESCR} status changed
          priority: WARNING
          manual_close: 'YES'
          tags:
          - tag: Condition
            value: Flap/Config
        history: 30d
      graph_prototypes:
      - uuid: 931a7ef6afcc4b9aaa149555942b8df1
        name: 'LAG: {#IFDESCR} Traffic'
        graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: lag.ifInOctets[{#IFDESCR}]
        - sortorder: '1'
          color: 0080FF
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: lag.ifOutOctets[{#IFDESCR}]
        - sortorder: '2'
          drawtype: FILLED_REGION
          color: FF0000
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: lag.ifInErrors[{#IFDESCR}]
        - sortorder: '3'
          drawtype: FILLED_REGION
          color: CC6600
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: lag.ifOutErrors[{#IFDESCR}]
    - uuid: d2640a528715449a88ff9ecbcd2086e5
      name: Interfaces (VLAN)
      type: SNMP_AGENT
      snmp_oid: discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]
      key: vlan.discovery
      delay: 1h
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFTYPE}'
          value: ^(53|135)$
          formulaid: A
      description: "Discover VLAN-tagged interfaces, including both Layer 2 and Layer 3 subinterfaces configured on physical\
        \ or virtual ports.\n\nThis rule targets:\n - `ifType = 53` (propVirtual \xE2\u20AC\u201D common for VLAN-tagged Layer\
        \ 2)\n - `ifType = 135` (l3ipvlan \xE2\u20AC\u201D Layer 3 subinterface with VLAN ID)\n\nThese interfaces typically\
        \ appear as:\n - `X0.V10`, `X2.V50`, etc. (e.g., `interface.vlan`)\n - Tagged subinterfaces used for segmentation,\
        \ guest networks, or zone isolation\n\nNotes:\n - SonicWall reports some VLANs as independent `ifIndex` values, allowing\
        \ direct SNMP polling\n - If these interfaces are not routable, traffic counters may show zero despite being active\n\
        \ - This rule does not apply to VLANs on VTI tunnels or PortShield bridges \xE2\u20AC\u201D use dedicated discovery\
        \ rules for those\n"
      item_prototypes:
      - uuid: 2a15151dc9bb4deaab667f5e44dc963b
        name: 'VLAN: {#IFDESCR} Errors In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInErrors.{#SNMPINDEX}
        key: vlan.ifInErrors[{#IFDESCR}]
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VLAN
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: a62f49f6073740658b7c9b19f3d43ef4
          expression: count(/Sonicwall Firewall/vlan.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_VLAN_WARNING})>2
          name: VLAN {#IFDESCR} Inbound Errors
          priority: WARNING
          description: Inbound errors on VLAN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$SONICWALL_VLAN_WARNING}/s)
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 10866c4d787342cba3ebfa2360488962
        name: 'VLAN: {#IFDESCR} Bytes In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInOctets.{#SNMPINDEX}
        key: vlan.ifInOctets[{#IFDESCR}]
        units: Bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VLAN
        - tag: Metrics
          value: Traffic
        trigger_prototypes:
        - uuid: 84dad1350c2740a1b3e4c298ba98dbee
          expression: avg(/Sonicwall Firewall/vlan.ifInOctets[{#IFDESCR}],5m) <= {$SONICWALL_VLAN_NO_TRAFFIC} and nodata(/Sonicwall
            Firewall/vlan.ifInOctets[{#IFDESCR}],120s)=0
          name: VLAN {#IFDESCR} No Data In
          priority: INFO
          description: The VLAN {#IFDESCR} has had {$SONICWALL_VLAN_NO_TRAFFIC} bytes of traffic Inbound over the past 5mins
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 3ec81e3336ea4d57885ff531ad3630d0
        name: 'VLAN: {#IFDESCR} Errors Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutErrors.{#SNMPINDEX}
        key: vlan.ifOutErrors[{#IFDESCR}]
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VLAN
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: f9492c04fd4c42919b71178695288620
          expression: count(/Sonicwall Firewall/vlan.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_VLAN_WARNING})>2
          name: VLAN {#IFDESCR} Outbound Errors
          priority: WARNING
          description: Outbound errors on VLAN {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_VLAN_WARNING}/s)
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: f82c20ffb87143afb0f0606bfe47f98e
        name: 'VLAN: {#IFDESCR} Bytes Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutOctets.{#SNMPINDEX}
        key: vlan.ifOutOctets[{#IFDESCR}]
        units: Bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VLAN
        - tag: Metrics
          value: Traffic
        trigger_prototypes:
        - uuid: 7f0f471f05204627b58b4017b45c6573
          expression: avg(/Sonicwall Firewall/vlan.ifOutOctets[{#IFDESCR}],5m) <= {$SONICWALL_VLAN_NO_TRAFFIC} and nodata(/Sonicwall
            Firewall/vlan.ifOutOctets[{#IFDESCR}],120s)=0
          name: VLAN {#IFDESCR} No Data Out
          priority: INFO
          description: The VLAN {#IFDESCR} has had {$SONICWALL_VLAN_NO_TRAFFIC} bytes of traffic Outbound over the past 5mins
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 8d5922eadc904e529e9c8f5499c8832c
        name: 'VLAN: {#IFDESCR} Status'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOperStatus.{#SNMPINDEX}
        key: vlan.status[{#IFDESCR}]
        valuemap:
          name: sonicwall.interface.status.valuemap
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VLAN
        - tag: Metrics
          value: State
        history: 30d
      graph_prototypes:
      - uuid: 2b7646f0fbf341c2983e8d62b13562b6
        name: 'VLAN: {#IFDESCR} Traffic'
        graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vlan.ifInOctets[{#IFDESCR}]
        - sortorder: '1'
          color: 0080FF
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vlan.ifOutOctets[{#IFDESCR}]
        - sortorder: '2'
          drawtype: FILLED_REGION
          color: FF0000
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vlan.ifInErrors[{#IFDESCR}]
        - sortorder: '3'
          drawtype: FILLED_REGION
          color: CC6600
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vlan.ifOutErrors[{#IFDESCR}]
    - uuid: ed64d4de43794fc68c4b7d0f8d1455b9
      name: VPN Tunnels (Policy Based)
      type: SNMP_AGENT
      snmp_oid: discovery[{#VPNINDEX},1.3.6.1.4.1.8741.1.3.2.1.1.1.1,{#LOCALONE},1.3.6.1.4.1.8741.1.3.2.1.1.1.3,{#LOCALTWO},1.3.6.1.4.1.8741.1.3.2.1.1.1.4,{#REMOTEONE},1.3.6.1.4.1.8741.1.3.2.1.1.1.5,{#REMOTETWO},1.3.6.1.4.1.8741.1.3.2.1.1.1.6,{#VPNSTATUS},1.3.6.1.4.1.8741.1.3.2.1.1.1.7,{#VPNNAME},1.3.6.1.4.1.8741.1.3.2.1.1.1.14]
      key: vpn.policy.discovery
      delay: 5m
      filter:
        evaltype: AND
        conditions:
        - macro: '{#LOCALONE}'
          value: ^((?!0\.0\.0\.0).)*$
          formulaid: A
        - macro: '{#REMOTEONE}'
          value: ^((?!0\.0\.0\.0).)*$
          formulaid: B
        - macro: '{#VPNNAME}'
          value: '{$SONICWALL_VPN_IGNORE_REGEX}'
          operator: NOT_MATCHES_REGEX
          formulaid: C
      description: 'Discovers VPN tunnels directly via SNMP using stable subnet-pair approach.


        This simplified approach:

        - Uses direct SNMP discovery without complex preprocessing

        - Monitors bytes in/out directly via SNMP OIDs using SA index

        - Eliminates external script dependency

        - Provides stable subnet-pair based item keys


        Benefits:

        - Simpler architecture with direct SNMP monitoring

        - No external script dependencies

        - Uses discovered SA index for direct OID queries

        - Maintains stable subnet-pair identifiers


        Notice:

        VPN Security Associations (SAs) are frequently renegotiated or re-keyed, which causes the SA index to change. For
        this reason, the polling interval is set to 5 minutes. Polling less frequently increases the risk of missing statistics
        for active policy-based tunnels, while polling more frequently may be considered overly aggressive.

        '
      item_prototypes:
      - uuid: c7c78b549316466cb3bb4ddd21048476
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) Bytes In'
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.2.1.1.1.9.{#SNMPINDEX}
        key: vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}]
        delay: 5m
        history: 7d
        trends: 90d
        units: bps
        description: Inbound bytes for VPN tunnel ({#LOCALSUBNET} to {#REMOTESUBNET})
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
          error_handler: CUSTOM_VALUE
          error_handler_params: '0'
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: VPN
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Subnets
          value: '{#LOCALSUBNET}-{#REMOTESUBNET}'
        - tag: VPN Type
          value: Policy
      - uuid: 8359fd27a05146d99f5955ba2f494b8b
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) Bytes Out'
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.2.1.1.1.11.{#SNMPINDEX}
        key: vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}]
        delay: 5m
        history: 7d
        trends: 90d
        units: bps
        description: Outbound bytes for VPN tunnel ({#LOCALSUBNET} to {#REMOTESUBNET})
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
          error_handler: CUSTOM_VALUE
          error_handler_params: '0'
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: VPN
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Subnets
          value: '{#LOCALSUBNET}-{#REMOTESUBNET}'
        - tag: VPN Type
          value: Policy
      - uuid: a9b5c8e2d41f4c6eb7a38f5921046d8a
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) Status'
        type: SNMP_AGENT
        snmp_oid: 1.3.6.1.4.1.8741.1.3.2.1.1.1.8.{#SNMPINDEX}
        key: vpn.policy.status[{#LOCALSUBNET}-{#REMOTESUBNET}]
        delay: 5m
        history: 7d
        description: Status for VPN tunnel ({#LOCALSUBNET} to {#REMOTESUBNET})
        valuemap:
          name: sonicwall.vpn.policy.status.valuemap
        tags:
        - tag: Component
          value: VPN
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Subnets
          value: '{#LOCALSUBNET}-{#REMOTESUBNET}'
        - tag: VPN Type
          value: Policy
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      trigger_prototypes:
      - uuid: 1a669e15dc4a4f379b3d7e854c699a20
        expression: 'max(/Sonicwall Firewall/vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}],1d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}
          and

          max(/Sonicwall Firewall/vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}],1d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}

          '
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) - Idle for 1 day'
        status: DISABLED
        description: "This trigger monitors policy-based VPN tunnel \"{#VPNNAME}\" ({#LOCALSUBNET}-{#REMOTESUBNET}).\nIt fires\
          \ when both inbound and outbound traffic have been below the threshold for a continuous 1-day period.\n  \nNote:\
          \ Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is for debugging purposes and intended to highlight short-term idle tunnels for review.\n\nThis\
          \ trigger requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: Suspected Idle
      - uuid: 2b669e15dc4a4f379b3d7e854c699a21
        expression: 'max(/Sonicwall Firewall/vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}],30d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}
          and

          max(/Sonicwall Firewall/vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}],30d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}

          '
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) - Idle for 1 month'
        status: DISABLED
        priority: WARNING
        description: "This trigger monitors policy-based VPN tunnel \"{#VPNNAME}\" ({#LOCALSUBNET}-{#REMOTESUBNET}).\nIt fires\
          \ when both inbound and outbound traffic have been below the threshold for a continuous 30-day period.\n  \nNote:\
          \ Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is for debugging purposes and intended to highlight daily idle tunnels for review.\n\nThis trigger\
          \ requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: Long Term Idle
      - uuid: 3c669e15dc4a4f379b3d7e854c699a22
        expression: 'max(/Sonicwall Firewall/vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}],7d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}
          and

          max(/Sonicwall Firewall/vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}],7d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}
          and

          nodata(/Sonicwall Firewall/vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}],7d) = 0 and

          nodata(/Sonicwall Firewall/vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}],7d) = 0

          '
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) - Idle for 1 week'
        priority: INFO
        description: "This trigger monitors policy-based VPN tunnel \"{#VPNNAME}\" ({#LOCALSUBNET}-{#REMOTESUBNET}).\nIt fires\
          \ when both inbound and outbound traffic have been below the threshold for a continuous 1-week period.\n  \nNote:\
          \ Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is intended to highlight weekly idle tunnels for review and potential decommissioning.\n\nThis\
          \ trigger requires 7 days of consistent data collection before it can fire, preventing false alarms on newly monitored\
          \ tunnels.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: Idle
      - uuid: 4d669e15dc4a4f379b3d7e854c699a23
        expression: 'max(/Sonicwall Firewall/vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}],365d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}
          and

          max(/Sonicwall Firewall/vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}],365d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}

          '
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) - Idle for 1 year'
        status: DISABLED
        priority: AVERAGE
        description: "This trigger monitors policy-based VPN tunnel \"{#VPNNAME}\" ({#LOCALSUBNET}-{#REMOTESUBNET}).\nIt fires\
          \ when both inbound and outbound traffic have been below the threshold for a continuous 30-day period.\n  \nNote:\
          \ Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is informational and intended to highlight long-term idle tunnels for review and potential decommissioning.\n\
          \nThis trigger requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: No Longer Used
      graph_prototypes:
      - uuid: 08086b07da6b4c23933ab5fb2dfc9d5e
        name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) Traffic'
        graph_items:
        - color: 00FF00
          item:
            host: Sonicwall Firewall
            key: vpn.policy.bytes.in[{#LOCALSUBNET}-{#REMOTESUBNET}]
        - sortorder: '1'
          color: 0080FF
          item:
            host: Sonicwall Firewall
            key: vpn.policy.bytes.out[{#LOCALSUBNET}-{#REMOTESUBNET}]
      preprocessing:
      - type: JAVASCRIPT
        parameters:
        - "// Create SUBNETPAIR macro from existing LLD data\nvar data = JSON.parse(value);\n\nfor (var i = 0; i < data.length;\
          \ i++) {\n    var item = data[i];\n    var localone = item[\"{#LOCALONE}\"] || \"\";\n    var remoteone = item[\"\
          {#REMOTEONE}\"] || \"\";\n    var vpnname = item[\"{#VPNNAME}\"] || \"\";\n    \n    // Create CIDR subnet format\n\
          \    if (localone && remoteone) {\n        item[\"{#LOCALSUBNET}\"] = localone + \"/24\";\n        item[\"{#REMOTESUBNET}\"\
          ] = remoteone + \"/24\";\n    }\n    \n    // Pass through tunnel name\n    if (vpnname) {\n        item[\"{#VPNNAME}\"\
          ] = vpnname;\n    }\n}\n\nreturn JSON.stringify(data);\n"
    - uuid: 5b8828f520044cb4aee1248934790d9b
      name: VPN Tunnels (Route Based)
      type: SNMP_AGENT
      snmp_oid: discovery[{#VPNNAME},1.3.6.1.2.1.2.2.1.2,{#VPNADMINSTATE},1.3.6.1.2.1.2.2.1.7,{#IFTYPE},1.3.6.1.2.1.2.2.1.3,{#VPNOPERSTATE},IF-MIB::ifOperStatus]
      key: vpn.route.discovery
      delay: 1h
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFTYPE}'
          value: ^131$
          formulaid: A
        - macro: '{#VPNADMINSTATE}'
          value: ^1$
          formulaid: B
        - macro: '{#VPNNAME}'
          value: '{$SONICWALL_VPN_IGNORE_REGEX}'
          operator: NOT_MATCHES_REGEX
          formulaid: C
      description: "Discover dynamically instantiated route-based VPN TUNNEL interfaces (ifType=131).\n  \nThese represent\
        \ the runtime IPsec tunnel state associated with route-based VPN SAs. The encryption domain is always 0.0.0.0/0 (match\
        \ any), and SAs are tied to these tunnels.\n  \nThese interfaces provide:\n - Real-time flap monitoring\n - Byte and\
        \ error counters\n - Accurate tunnel usage insights\n  \nThis intentionally overlaps with VTI monitoring. Each layer\
        \ serves a different purpose:\n - VTI: persistent configuration and routing layer\n - TUNNEL: dynamic SA interface\
        \ for traffic visibility\n"
      item_prototypes:
      - uuid: 3c1bb76ca478444db54d7f394e046c23
        name: 'VPN Route: {#VPNNAME} Errors In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInErrors.{#SNMPINDEX}
        key: vpn.route.ifInErrors[{#VPNNAME}]
        units: bps
        description: Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: VPN
        - tag: Metrics
          value: Errors
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Type
          value: Route
        history: 30d
      - uuid: 4a06318935bd4a8d803dd9109db9ba7e
        name: 'VPN Route: {#VPNNAME} Bytes In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInOctets.{#SNMPINDEX}
        key: vpn.route.ifInOctets[{#VPNNAME}]
        units: bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: VPN
        - tag: Metrics
          value: Traffic
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Type
          value: Route
        history: 30d
      - uuid: d203b3c848c04e94aaa799ba6af8dac0
        name: 'VPN Route: {#VPNNAME} Errors Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutErrors.{#SNMPINDEX}
        key: vpn.route.ifOutErrors[{#VPNNAME}]
        units: bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: VPN
        - tag: Metrics
          value: Errors
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Type
          value: Route
        history: 30d
      - uuid: 5c4f71c24d51433fa572275b0726f2f1
        name: 'VPN Route: {#VPNNAME} Bytes Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutOctets.{#SNMPINDEX}
        key: vpn.route.ifOutOctets[{#VPNNAME}]
        units: bps
        description: Bytes Out counter not exposed during testing - Bug in the Sonicwall Firmware?
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: VPN
        - tag: Metrics
          value: Traffic
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Type
          value: Route
        history: 30d
      - uuid: 803ca2150a6940d38363649cfa3e019d
        name: 'VPN Route: {#VPNNAME} Status'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOperStatus.{#SNMPINDEX}
        key: vpn.route.status[{#VPNNAME}]
        valuemap:
          name: sonicwall.vpn.route.status.valuemap
        preprocessing:
        - type: DISCARD_UNCHANGED
          parameters:
          - ''
        tags:
        - tag: Component
          value: VPN
        - tag: VPN Name
          value: '{#VPNNAME}'
        - tag: VPN Type
          value: Route
        trigger_prototypes:
        - uuid: 7e5b193f9d734c2ea2745793eebfe8fc
          expression: '(count(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}],{$SONICWALL_FLAPPING_TIMEFRAME})>1 and change(/Sonicwall
            Firewall/vpn.route.status[{#VPNNAME}])>0)

            and nodata(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}],120s)=0

            '
          name: 'VPN Route: {#VPNNAME} Flapping Detected'
          priority: WARNING
          description: 'The VPN route tunnel "{#VPNNAME}" has changed status more than {$SONICWALL_FLAPPING_CHANGE_THRESHOLD}
            times in the last {$SONICWALL_FLAPPING_TIMEFRAME}.

            This indicates tunnel instability and requires investigation.


            Possible causes:

            - Network connectivity issues

            - SonicWall firmware bugs

            - BGP/routing configuration problems

            - Hardware issues

            - Authentication/certificate problems


            Check tunnel logs and network connectivity to the remote endpoint.

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: VPN
          - tag: Condition
            value: Flapping
          - tag: VPN Type
            value: Route
        history: 30d
      trigger_prototypes:
      - uuid: 1a669e15dc4a4f379b3d7e854c699a10
        expression: 'last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1 and

          max(/Sonicwall Firewall/vpn.route.ifInOctets[{#VPNNAME}],1d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD} and

          max(/Sonicwall Firewall/vpn.route.ifOutOctets[{#VPNNAME}],1d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}

          '
        name: 'VPN Route: {#VPNNAME} - Idle for 1 day'
        status: DISABLED
        description: "This trigger monitors route-based VPN tunnel \"{#VPNNAME}\".\nIt fires when both inbound and outbound\
          \ traffic have been below the threshold for a continuous 1-day period while the tunnel status is Active.\n  \nNote:\
          \ Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is for debugging purposes and intended to highlight short-term idle tunnels for review.\n\nThis\
          \ trigger requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: Suspected Idle
      - uuid: 2b669e15dc4a4f379b3d7e854c699a11
        expression: 'last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1 and

          max(/Sonicwall Firewall/vpn.route.ifInOctets[{#VPNNAME}],30d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD} and

          max(/Sonicwall Firewall/vpn.route.ifOutOctets[{#VPNNAME}],30d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}

          '
        name: 'VPN Route: {#VPNNAME} - Idle for 1 month'
        status: DISABLED
        priority: WARNING
        description: "This trigger monitors route-based VPN tunnel \"{#VPNNAME}\".\nIt fires when both inbound and outbound\
          \ traffic have been below the threshold for a continuous 30-day period while the tunnel status is Active.\n  \n\
          Note: Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is for debugging purposes and intended to highlight daily idle tunnels for review.\n\nThis trigger\
          \ requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: Long Term Idle
      - uuid: 3c669e15dc4a4f379b3d7e854c699a12
        expression: 'last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1 and

          max(/Sonicwall Firewall/vpn.route.ifInOctets[{#VPNNAME}],7d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD} and

          max(/Sonicwall Firewall/vpn.route.ifOutOctets[{#VPNNAME}],7d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD} and

          nodata(/Sonicwall Firewall/vpn.route.ifInOctets[{#VPNNAME}],7d) = 0 and

          nodata(/Sonicwall Firewall/vpn.route.ifOutOctets[{#VPNNAME}],7d) = 0

          '
        name: 'VPN Route: {#VPNNAME} - Idle for 1 week'
        priority: INFO
        description: "This trigger monitors route-based VPN tunnel \"{#VPNNAME}\".\nIt fires when both inbound and outbound\
          \ traffic have been below the threshold for a continuous 1-week period while the tunnel status is Active.\n  \n\
          Note: Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is intended to highlight weekly idle tunnels for review and potential decommissioning.\n\nThis\
          \ trigger requires 7 days of consistent data collection before it can fire, preventing false alarms on newly monitored\
          \ tunnels.\n\nThis trigger requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: Idle
      - uuid: 4d669e15dc4a4f379b3d7e854c699a13
        expression: 'last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1 and

          max(/Sonicwall Firewall/vpn.route.ifInOctets[{#VPNNAME}],365d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD} and

          max(/Sonicwall Firewall/vpn.route.ifOutOctets[{#VPNNAME}],365d) <= {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}

          '
        name: 'VPN Route: {#VPNNAME} - Idle for 1 year'
        status: DISABLED
        priority: AVERAGE
        description: "This trigger monitors route-based VPN tunnel \"{#VPNNAME}\".\nIt fires when both inbound and outbound\
          \ traffic have been below the threshold for a continuous 30-day period while the tunnel status is Active.\n  \n\
          Note: Some tunnels may be configured with keepalives or routing protocols that do not generate significant traffic.\
          \ \nThis trigger is informational and intended to highlight long-term idle tunnels for review and potential decommissioning.\n\
          \nThis trigger requires consistent data - it will not fire if there are gaps in data collection.\n"
        manual_close: 'YES'
        tags:
        - tag: Condition
          value: No Longer Used
      - uuid: b2f59c886b324cd88518d38dca6c0244
        expression: 'avg(/Sonicwall Firewall/vpn.route.ifInErrors[{#VPNNAME}],5m) > {$SONICWALL_VPN_CRITICAL_THRESHOLD} and

          last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1

          '
        name: 'VPN Route: {#VPNNAME} Inbound Errors (Critical)'
        status: DISABLED
        priority: HIGH
        description: 'The VPN tunnel is experiencing a high rate of inbound errors (>{$SONICWALL_VPN_CRITICAL_THRESHOLD} errors/sec
          averaged over 5 minutes).

          This may indicate network issues, MTU problems, encryption failures, or hardware problems.


          Note: This trigger is disabled by default as error counters may not be exposed on all SonicWall firmware versions.

          '
        tags:
        - tag: Condition
          value: Threshold
      - uuid: 0b5b79c341af4a4382c02676b245dd38
        expression: 'avg(/Sonicwall Firewall/vpn.route.ifInErrors[{#VPNNAME}],5m) > {$SONICWALL_VPN_WARNING_THRESHOLD} and

          last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1

          '
        name: 'VPN Route: {#VPNNAME} Inbound Errors (Warning)'
        status: DISABLED
        priority: AVERAGE
        description: 'The VPN tunnel is experiencing elevated inbound errors (>{$SONICWALL_VPN_WARNING_THRESHOLD} errors/sec
          averaged over 5 minutes).

          Monitor for increasing error rates or impact on tunnel performance.


          Note: This trigger is disabled by default as error counters may not be exposed on all SonicWall firmware versions.

          '
        tags:
        - tag: Component
          value: VPN
        - tag: VPN
          value: Route
      - uuid: 1379731bc5b0416abb4fd261fac82c79
        expression: 'avg(/Sonicwall Firewall/vpn.route.ifOutErrors[{#VPNNAME}],5m) > {$SONICWALL_VPN_CRITICAL_THRESHOLD} and

          last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1

          '
        name: 'VPN Route: {#VPNNAME} Outbound Errors (Critical)'
        status: DISABLED
        priority: HIGH
        description: 'The VPN tunnel is experiencing a high rate of outbound errors (>{$SONICWALL_VPN_CRITICAL_THRESHOLD}
          errors/sec averaged over 5 minutes).

          This may indicate network issues, MTU problems, encryption failures, or hardware problems.


          Note: This trigger is disabled by default as error counters may not be exposed on all SonicWall firmware versions.

          '
        tags:
        - tag: Condition
          value: Threshold
      - uuid: e8c4770f6c18443a89d3009bef1a2ce2
        expression: 'avg(/Sonicwall Firewall/vpn.route.ifOutErrors[{#VPNNAME}],5m) > {$SONICWALL_VPN_WARNING_THRESHOLD} and

          last(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}]) = 1

          '
        name: 'VPN Route: {#VPNNAME} Outbound Errors (Warning)'
        status: DISABLED
        priority: AVERAGE
        description: 'The VPN tunnel is experiencing elevated outbound errors (>{$SONICWALL_VPN_WARNING_THRESHOLD} errors/sec
          averaged over 5 minutes).

          Monitor for increasing error rates or impact on tunnel performance.


          Note: This trigger is disabled by default as error counters may not be exposed on all SonicWall firmware versions.

          '
        tags:
        - tag: Condition
          value: Threshold
      graph_prototypes:
      - uuid: dc809c23462c460ebb13a0ade5159b38
        name: 'VPN Route: {#VPNNAME} Traffic'
        graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vpn.route.ifInOctets[{#VPNNAME}]
        - sortorder: '1'
          color: 00BFFF
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vpn.route.ifOutOctets[{#VPNNAME}]
        - sortorder: '2'
          drawtype: FILLED_REGION
          color: FF0000
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vpn.route.ifInErrors[{#VPNNAME}]
        - sortorder: '3'
          drawtype: FILLED_REGION
          color: CC6600
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vpn.route.ifOutErrors[{#VPNNAME}]
    - uuid: 934a1ea08f044e449d8d69bba309a9bf
      name: VPN Tunnel Pairs
      type: SNMP_AGENT
      snmp_oid: discovery[{#VPNNAME},1.3.6.1.2.1.2.2.1.2,{#VPNADMINSTATE},1.3.6.1.2.1.2.2.1.7,{#IFTYPE},1.3.6.1.2.1.2.2.1.3,{#VPNOPERSTATE},IF-MIB::ifOperStatus]
      key: vpn.tunnel.pairs.discovery
      delay: 1h
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFTYPE}'
          value: ^131$
          formulaid: A
        - macro: '{#VPNADMINSTATE}'
          value: ^1$
          formulaid: B
        - macro: '{#VPNNAME}'
          value: .*(TUN[0-9]+|_PRI|_SEC|PRIMARY|BACKUP|[0-9]+).*
          formulaid: C
      description: "Discovers VPN tunnels with redundancy pair naming patterns.\n\nIdentifies tunnels with names containing:\n\
        - TUN followed by numbers (TUN0, TUN1, TUN2, etc.)\n- _PRI or _SEC suffixes  \n- PRIMARY or BACKUP suffixes\n- Numeric\
        \ suffixes\n\nThis enables monitoring of individual tunnels in redundancy pairs.\n"
      item_prototypes:
      - uuid: a45b2fb190154f559e8e7abcb409c9cf
        name: 'VPN Tunnel Pair: {#VPNPAIR} Status Monitor'
        type: CALCULATED
        key: vpn.tunnel.pair.status[{#VPNPAIR}]
        delay: 5m
        history: 7d
        trends: 90d
        params: last(//vpn.route.status[{#VPNNAME}])
        description: 'Individual tunnel status from discovered VPN tunnel pairs.


          This monitors the operational status of each tunnel that matches

          the redundancy pair naming patterns, providing visibility into

          tunnel availability for failover scenarios.

          '
        tags:
        - tag: Component
          value: VPN
        - tag: Pair Name
          value: '{#VPNPAIR}'
        - tag: Tunnel Type
          value: Redundancy Pair
        trigger_prototypes:
        - uuid: b56c30c291264f669f8f8bccb509dadf
          expression: last(/Sonicwall Firewall/vpn.tunnel.pair.status[{#VPNPAIR}]) = 0
          name: 'VPN Tunnel Pair: {#VPNPAIR} - All Tunnels Down'
          priority: DISASTER
          description: 'Both tunnels in pair {#VPNPAIR} are down, indicating complete connectivity loss.


            This is a critical failover scenario requiring immediate attention.

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: VPN
          - tag: Condition
            value: Complete Failure
          - tag: Pair Name
            value: '{#VPNPAIR}'
        - uuid: c67d41d392374c779080acecc609ebef
          expression: '(last(/Sonicwall Firewall/vpn.tunnel.pair.status[{#VPNPAIR}]) = 1 or last(/Sonicwall Firewall/vpn.tunnel.pair.status[{#VPNPAIR}])
            = 10)

            and change(/Sonicwall Firewall/vpn.tunnel.pair.status[{#VPNPAIR}]) <> 0

            '
          name: 'VPN Tunnel Pair: {#VPNPAIR} - Failover Detected'
          priority: WARNING
          description: 'Tunnel failover detected in pair {#VPNPAIR}.


            Status meanings:

            - 1 = Primary only (secondary failed)

            - 10 = Secondary only (primary failed)

            - 11 = Both active (normal)


            Investigate the failed tunnel and BGP convergence.

            '
          manual_close: 'YES'
          tags:
          - tag: Component
            value: VPN
          - tag: Condition
            value: Failover
          - tag: Pair Name
            value: '{#VPNPAIR}'
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
      preprocessing:
      - type: JAVASCRIPT
        parameters:
        - "// Group tunnel names into pairs based on naming patterns\nvar data = JSON.parse(value);\nvar pairs = {};\n\nfor\
          \ (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var vpnname = item[\"{#VPNNAME}\"] || \"\";\n\
          \    \n    // Skip if no VPN name\n    if (!vpnname) continue;\n    \n    var pairBase = \"\";\n    \n    // Handle\
          \ TUNx patterns (TUN0->TUN, TUN1->TUN, etc.)\n    if (vpnname.match(/TUN[0-9]+/)) {\n        pairBase = vpnname.replace(/TUN[0-9]+/,\
          \ \"TUN\");\n    }\n    // Handle _PRI/_SEC patterns\n    else if (vpnname.match(/_PRI$|_SEC$/)) {\n        pairBase\
          \ = vpnname.replace(/_PRI$|_SEC$/, \"\");\n    }\n    // Handle PRIMARY/BACKUP patterns\n    else if (vpnname.match(/PRIMARY$|BACKUP$/))\
          \ {\n        pairBase = vpnname.replace(/PRIMARY$|BACKUP$/, \"\");\n    }\n    // Handle numeric suffixes (SITE1->SITE,\
          \ SITE2->SITE)\n    else if (vpnname.match(/[0-9]+$/)) {\n        pairBase = vpnname.replace(/[0-9]+$/, \"\");\n\
          \    }\n    \n    // Only add if we found a valid pair pattern\n    if (pairBase) {\n        var pairKey = pairBase\
          \ + \"_PAIR\";\n        if (!pairs[pairKey]) {\n            pairs[pairKey] = {\n                \"{#VPNPAIR}\":\
          \ pairBase,\n                \"{#TUNNELS}\": []\n            };\n        }\n        pairs[pairKey][\"{#TUNNELS}\"\
          ].push(vpnname);\n    }\n}\n\n// Convert to array and filter pairs with 2+ members\nvar result = [];\nfor (var key\
          \ in pairs) {\n    if (pairs[key][\"{#TUNNELS}\"].length >= 2) {\n        result.push(pairs[key]);\n    }\n}\n\n\
          return JSON.stringify(result);\n"
    - uuid: f6bb4d46dd22461c83472971b98a07c2
      name: Interfaces (VTI)
      type: SNMP_AGENT
      snmp_oid: discovery[{#VTINAME},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]
      key: vti.discovery
      delay: 1h
      filter:
        conditions:
        - macro: '{#IFTYPE}'
          value: ^(131)$
          formulaid: A
      description: "Discover route-based VPN interfaces (ifType=131).\n  \nThese interfaces represent Virtual Tunnel Interfaces\
        \ (VTI) \xE2\u20AC\u201D persistent Layer-3 interfaces configured with IPs and routed using static or dynamic protocols\
        \ (e.g., BGP).\n  \nVTIs are the configuration layer and always exist. However, traffic counters may be idle if tunnels\
        \ are unused.\n  \nNote: These are distinct from the tunnel interfaces associated with active IPsec Security Associations\
        \ (SAs).\nDo not assume this discovery overlaps with route-based TUNNEL metrics; especially with more than one Phase\
        \ 2 SA.\n"
      item_prototypes:
      - uuid: c07868e00c92478a92098e28c7ef58fb
        name: 'VTI: {#VTINAME} Bytes In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInOctets.{#SNMPINDEX}
        key: vti.bytesIn[{#VTINAME}]
        units: Bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VTI
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: b50e7769e7384bc190dc24773b45a2c4
        name: 'VTI: {#VTINAME} Bytes Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutOctets.{#SNMPINDEX}
        key: vti.bytesOut[{#VTINAME}]
        units: Bps
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VTI
        - tag: Metrics
          value: Traffic
        history: 30d
      - uuid: f6aee31a88024fb490f2b94098327380
        name: 'VTI: {#VTINAME} Errors In'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifInErrors.{#SNMPINDEX}
        key: vti.errorsIn[{#VTINAME}]
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VTI
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 36326c71d1654a30aa3fbad79539eeda
          expression: count(/Sonicwall Firewall/vti.errorsIn[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_ERROR})>2
          name: 'VTI: {#VTINAME} Inbound Errors'
          priority: HIGH
          tags:
          - tag: Condition
            value: Threshold
        - uuid: bc04567371fe42b7839411dfc8da4f50
          expression: count(/Sonicwall Firewall/vti.errorsIn[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_WARNING_THRESHOLD})>2
          name: 'VTI: {#VTINAME} Inbound Warning'
          priority: AVERAGE
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 09ffdad6ae16442a9b10ba37c2b89842
        name: 'VTI: {#VTINAME} Errors Out'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOutErrors.{#SNMPINDEX}
        key: vti.errorsOut[{#VTINAME}]
        preprocessing:
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VTI
        - tag: Metrics
          value: Errors
        trigger_prototypes:
        - uuid: 893bc0b990d64e118039f0d8e6b6bbf0
          expression: count(/Sonicwall Firewall/vti.errorsOut[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_ERROR})>2
          name: 'VTI: {#VTINAME} Outbound Errors'
          priority: HIGH
          tags:
          - tag: Condition
            value: Threshold
        - uuid: f6c4bd1e1ccb48e9a86586b9ff5c2a5f
          expression: count(/Sonicwall Firewall/vti.errorsOut[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_WARNING_THRESHOLD})>2
          name: 'VTI: {#VTINAME} Outbound Warning'
          priority: AVERAGE
          tags:
          - tag: Condition
            value: Threshold
        history: 30d
      - uuid: 7b173c18fc024e99a84e389f9706e21a
        name: 'VTI: {#VTINAME} Status'
        type: SNMP_AGENT
        snmp_oid: IF-MIB::ifOperStatus.{#SNMPINDEX}
        key: vti.ifOperStatus[{#VTINAME}]
        valuemap:
          name: sonicwall.vpn.route.status.valuemap
        preprocessing:
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - '3600'
        tags:
        - tag: Component
          value: Interface
        - tag: Interface
          value: VTI
        - tag: Metrics
          value: State
        trigger_prototypes:
        - uuid: f094bd2abb4a40a48fdfdf1aa71cb382
          expression: (count(/Sonicwall Firewall/vti.ifOperStatus[{#VTINAME}],{$SONICWALL_FLAPPING_TIMEFRAME})>1 or change(/Sonicwall
            Firewall/vti.ifOperStatus[{#VTINAME}])>0) and nodata(/Sonicwall Firewall/vti.ifOperStatus[{#VTINAME}],120s)=0
          name: 'VTI: {#VTINAME} status changed'
          priority: AVERAGE
          manual_close: 'YES'
          tags:
          - tag: Condition
            value: Config
        history: 30d
      graph_prototypes:
      - uuid: ac9b24f725a5471d9f3befefa3a5f43a
        name: 'VTI: {#VTINAME} Traffic'
        graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vti.bytesIn[{#VTINAME}]
        - sortorder: '1'
          color: 0080FF
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vti.bytesOut[{#VTINAME}]
        - sortorder: '2'
          drawtype: FILLED_REGION
          color: FF0000
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vti.errorsIn[{#VTINAME}]
        - sortorder: '3'
          drawtype: FILLED_REGION
          color: CC6600
          calc_fnc: ALL
          item:
            host: Sonicwall Firewall
            key: vti.errorsOut[{#VTINAME}]
    tags:
    - tag: Author
      value: Simon Jackson
    - tag: Vendor
      value: Sonicwall
    macros:
    - macro: '{$SNMP_AUTH_KEY}'
      description: SNMPv3 authentication key for secure SNMP communication
    - macro: '{$SNMP_AUTH_METHOD}'
      value: SHA
      description: SNMPv3 authentication method (SHA, MD5)
    - macro: '{$SNMP_AUTH_TYPE}'
      value: AUTH+PRIV
      description: SNMPv3 authentication type (AUTH+PRIV for maximum security)
    - macro: '{$SNMP_AUTH_USER}'
      description: SNMPv3 username for authentication
    - macro: '{$SNMP_PRIV_KEY}'
      description: SNMPv3 privacy key for encryption
    - macro: '{$SNMP_PRIV_METHOD}'
      value: AES
      description: SNMPv3 privacy method (AES, DES)
    - macro: '{$SONICWALL_ASW_SCAN_TIME_THRESHOLD}'
      value: '30'
      description: Trigger threshold for Gateway Anti-Spyware scan time (seconds).
    - macro: '{$SONICWALL_ASW_THREAT_THRESHOLD}'
      value: '10'
      description: Threshold for detected Gateway Anti-Spyware threat count.
    - macro: '{$SONICWALL_BGP_NEIGHBOR_TIMEOUT}'
      value: '180'
      description: Time in seconds before considering BGP neighbor down/unreachable.
    - macro: '{$SONICWALL_BGP_ROUTE_THRESHOLD_CRITICAL}'
      value: '10'
      description: Critical minimum BGP routes per neighbor (possible routing table corruption).
    - macro: '{$SONICWALL_BGP_ROUTE_THRESHOLD_WARNING}'
      value: '50'
      description: Minimum expected BGP routes per neighbor before warning (route flap protection).
    - macro: '{$SONICWALL_CONN_USAGE_WARN}'
      value: '90'
      description: Warning threshold for connection table usage percentage. Trigger activates if usage exceeds this value.
    - macro: '{$SONICWALL_CPU_ERROR}'
      value: '90'
      description: CPU usage (%) that triggers an error-level alert.
    - macro: '{$SONICWALL_CPU_WARNING}'
      value: '80'
      description: CPU usage (%) that triggers a warning-level alert.
    - macro: '{$SONICWALL_DDOS_THRESHOLD}'
      value: '50000'
      description: Threshold for total detected DDoS packets before triggering an alert.
    - macro: '{$SONICWALL_DISK_ERROR}'
      value: '90'
      description: Disk usage (%) that triggers an error-level alert.
    - macro: '{$SONICWALL_DISK_WARNING}'
      value: '80'
      description: Disk usage (%) that triggers a warning-level alert.
    - macro: '{$SONICWALL_DPISSL_USAGE_WARN}'
      value: '95'
      description: Warning threshold for DPI SSL usage percentage. Trigger activates if usage exceeds this value.
    - macro: '{$SONICWALL_FLAPPING_CHANGE_THRESHOLD}'
      value: '3'
      description: Number of state changes within the flapping detection timeframe before triggering flapping alerts.
    - macro: '{$SONICWALL_FLAPPING_TIMEFRAME}'
      value: 15m
      description: Timeframe for detecting BGP/VPN flapping behavior (e.g., 15m, 30m, 1h).
    - macro: '{$SONICWALL_GAV_VIRUS_THRESHOLD}'
      value: '5'
      description: Threshold for detected viruses by Gateway Anti-Virus before triggering an alert.
    - macro: '{$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD}'
      value: '375000'
      description: Minimum expected cluster role status value to indicate active HA state. Adjust per firewall model.
    - macro: '{$SONICWALL_HA_ANOMOLY_LOW_THRESHOLD}'
      value: '500'
      description: Threshold below which HA secondary state is considered anomalous.
    - macro: '{$SONICWALL_IDS_DETECTION_THRESHOLD}'
      value: '10'
      description: Threshold for IDS attack detections per minute to trigger alerts. Represents average attacks/minute over
        5 minutes
    - macro: '{$SONICWALL_INTERFACE_ERROR}'
      value: '10'
      description: Threshold for interface input/output errors before triggering an alert.
    - macro: '{$SONICWALL_IPS_ATTACK_THRESHOLD}'
      value: '10'
      description: Threshold for IPS attack detections per minute to trigger alerts. Represents average attacks/minute over
        5 minutes.
    - macro: '{$SONICWALL_MEMORY_ERROR}'
      value: '90'
      description: Memory usage (%) that triggers an error-level alert.
    - macro: '{$SONICWALL_MEMORY_WARNING}'
      value: '80'
      description: Memory usage (%) that triggers a warning-level alert.
    - macro: '{$SONICWALL_SWAP_WARNING}'
      value: '70'
      description: Swap usage (%) that triggers a warning-level alert.
    - macro: '{$SONICWALL_TEMP_ERROR}'
      value: '70'
      description: "Temperature (\xC2\xB0C) that triggers an error-level alert."
    - macro: '{$SONICWALL_TEMP_WARNING}'
      value: '60'
      description: "Temperature (\xC2\xB0C) that triggers a warning-level alert."
    - macro: '{$SONICWALL_TUNNEL_FAILOVER_DETECTION}'
      value: '300'
      description: Time in seconds to detect tunnel failover scenarios between TUN0/TUN1 pairs.
    - macro: '{$SONICWALL_VLAN_ERROR}'
      value: '10'
      description: Threshold for input/output errors on VLAN interfaces.
    - macro: '{$SONICWALL_VLAN_WARNING}'
      value: '10'
      description: Threshold for input/output warnings on VLAN interfaces.
    - macro: '{$SONICWALL_VPN_CRITICAL_THRESHOLD}'
      value: '1000'
      description: Threshold for VPN tunnel error rate (errors per second) that triggers a critical alert.
    - macro: '{$SONICWALL_VPN_ERROR}'
      value: '5'
      description: Threshold for input/output errors on VPN interfaces before triggering an error-level alert.
    - macro: '{$SONICWALL_VPN_IGNORE_REGEX}'
      value: ^(?i:BACKEND|TEST|MONITORING).*
      description: Regex to exclude VPN tunnels (by name) from discovery. Adjust for tunnel naming conventions.
    - macro: '{$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}'
      value: '1'
      description: Minimum expected average VPN traffic (bps) over 3 hours before considering a tunnel idle.
    - macro: '{$SONICWALL_VPN_TRAFFIC_IDLE_TIMEFRAME}'
      value: 7d
      description: Timeframe for monitoring VPN tunnel idle status. Adjust based on business requirements (e.g., 1h, 7d, 30d).
    - macro: '{$SONICWALL_VPN_WARNING_THRESHOLD}'
      value: '100'
      description: Threshold for VPN tunnel error rate (errors per second) that triggers a warning alert.
    dashboards:
    - uuid: abbbec0248734fc58ae96712a5cf32e6
      name: SonicWALL Firewalls
      pages:
      - name: Cluster
        widgets:
        - type: problemsbysv
          width: '36'
          height: '1'
          hide_header: 'YES'
          fields:
          - type: STRING
            name: reference
            value: YKUZB
        - type: svggraph
          name: Activity
          y: '1'
          width: '36'
          height: '3'
          fields:
          - type: INTEGER
            name: ds.0.aggregate_function
            value: '5'
          - type: INTEGER
            name: ds.0.aggregate_grouping
            value: '1'
          - type: STRING
            name: ds.0.aggregate_interval
            value: 1m
          - type: STRING
            name: ds.0.color
            value: 00FFBF
          - type: STRING
            name: ds.0.data_set_label
            value: 'Traffic: Inbound'
          - type: INTEGER
            name: ds.0.fill
            value: '1'
          - type: STRING
            name: ds.0.items.0
            value: 'Interface: * Bytes In'
          - type: STRING
            name: ds.0.items.1
            value: 'LAG: * Bytes In'
          - type: INTEGER
            name: ds.0.transparency
            value: '3'
          - type: INTEGER
            name: ds.1.aggregate_function
            value: '5'
          - type: INTEGER
            name: ds.1.aggregate_grouping
            value: '1'
          - type: STRING
            name: ds.1.aggregate_interval
            value: 1m
          - type: STRING
            name: ds.1.color
            value: 0080FF
          - type: STRING
            name: ds.1.data_set_label
            value: 'Traffic: Outbound'
          - type: INTEGER
            name: ds.1.fill
            value: '1'
          - type: STRING
            name: ds.1.items.0
            value: 'Interface: * Bytes Out'
          - type: STRING
            name: ds.1.items.1
            value: 'LAG: * Bytes Out'
          - type: INTEGER
            name: ds.1.transparency
            value: '3'
          - type: INTEGER
            name: legend_lines
            value: '2'
          - type: INTEGER
            name: legend_statistic
            value: '1'
          - type: STRING
            name: reference
            value: NEFMN
          - type: INTEGER
            name: righty
            value: '0'
          - type: INTEGER
            name: simple_triggers
            value: '1'
        - type: item
          name: Primary
          y: '4'
          width: '10'
          fields:
          - type: INTEGER
            name: decimal_places
            value: '0'
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: sonicwall.ha.primary.status
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: units_bold
            value: '0'
          - type: INTEGER
            name: units_show
            value: '0'
        - type: item
          name: Secondary
          y: '6'
          width: '10'
          fields:
          - type: INTEGER
            name: decimal_places
            value: '0'
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: sonicwall.ha.secondary.status
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: units_bold
            value: '0'
          - type: INTEGER
            name: units_show
            value: '0'
        - type: svggraph
          name: HA Member Sync
          x: '10'
          y: '4'
          width: '26'
          height: '4'
          fields:
          - type: STRING
            name: ds.0.color
            value: 00FF00
          - type: INTEGER
            name: ds.0.fill
            value: '1'
          - type: STRING
            name: ds.0.items.0
            value: HA Primary Status
          - type: INTEGER
            name: ds.0.transparency
            value: '3'
          - type: STRING
            name: ds.1.color
            value: 00BFFF
          - type: INTEGER
            name: ds.1.fill
            value: '1'
          - type: STRING
            name: ds.1.items.0
            value: HA Secondary Status
          - type: INTEGER
            name: ds.1.transparency
            value: '3'
          - type: INTEGER
            name: legend_lines
            value: '2'
          - type: INTEGER
            name: legend_statistic
            value: '1'
          - type: STRING
            name: reference
            value: QKEVM
          - type: INTEGER
            name: righty
            value: '0'
        - type: honeycomb
          name: Important Info
          x: '36'
          width: '20'
          fields:
          - type: STRING
            name: items.0
            value: Device Firmware Version
          - type: STRING
            name: items.1
            value: Device Model
          - type: STRING
            name: items.2
            value: Device ROM Version
          - type: STRING
            name: items.3
            value: Device Temperature
          - type: STRING
            name: primary_label
            value: '{ITEM.NAME}'
          - type: STRING
            name: reference
            value: BFIFR
        - type: gauge
          x: '36'
          y: '2'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: sonicwall.cpu.utilisation
          - type: STRING
            name: max
            value: '100'
          - type: STRING
            name: min
            value: '0'
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '3'
          - type: INTEGER
            name: show.2
            value: '4'
          - type: INTEGER
            name: show.3
            value: '5'
        - type: gauge
          x: '36'
          y: '4'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: sonicwall.connections.usage
          - type: STRING
            name: max
            value: '100'
          - type: STRING
            name: min
            value: '0'
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '4'
          - type: INTEGER
            name: show.2
            value: '5'
        - type: gauge
          x: '46'
          y: '2'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: sonicwall.ram.utilisation
          - type: STRING
            name: max
            value: '100'
          - type: STRING
            name: min
            value: '0'
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '3'
          - type: INTEGER
            name: show.2
            value: '4'
          - type: INTEGER
            name: show.3
            value: '5'
        - type: gauge
          x: '46'
          y: '4'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: sonicwall.dpissl.conn.usage
          - type: STRING
            name: max
            value: '100'
          - type: STRING
            name: min
            value: '0'
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '4'
          - type: INTEGER
            name: show.2
            value: '5'
      - name: Interfaces
        widgets:
        - type: honeycomb
          name: Interface Status
          width: '15'
          height: '14'
          fields:
          - type: STRING
            name: items.0
            value: '* Status'
          - type: INTEGER
            name: item_tags.0.operator
            value: '1'
          - type: STRING
            name: item_tags.0.tag
            value: Component
          - type: STRING
            name: item_tags.0.value
            value: Interface
          - type: STRING
            name: primary_label
            value: '{{ITEM.NAME}.regsub("^Interface: (.+) Status$", "\1")}'
          - type: STRING
            name: primary_label_color
            value: '666699'
          - type: INTEGER
            name: show.0
            value: '1'
          - type: STRING
            name: thresholds.0.color
            value: FF465C
          - type: STRING
            name: thresholds.0.threshold
            value: '0'
          - type: STRING
            name: thresholds.1.color
            value: 80FF00
          - type: STRING
            name: thresholds.1.threshold
            value: '1'
        - type: graphprototype
          name: 'Interface: Traffic'
          x: '15'
          width: '48'
          height: '14'
          fields:
          - type: INTEGER
            name: columns
            value: '1'
          - type: GRAPH_PROTOTYPE
            name: graphid.0
            value:
              host: Sonicwall Firewall
              name: 'Interface: {#IFDESCR} Traffic'
          - type: STRING
            name: reference
            value: CAPHR
          - type: INTEGER
            name: rows
            value: '2'
      - name: VLANs
        widgets:
        - type: honeycomb
          name: VLAN Errors
          width: '19'
          height: '14'
          fields:
          - type: INTEGER
            name: interpolation
            value: '1'
          - type: STRING
            name: items.0
            value: 'VLAN: * Errors *'
          - type: INTEGER
            name: item_tags.0.operator
            value: '1'
          - type: STRING
            name: item_tags.0.tag
            value: Interface
          - type: STRING
            name: item_tags.0.value
            value: VLAN
          - type: STRING
            name: primary_label
            value: '{{ITEM.NAME}.regsub("^(VPN|VTI|VLAN|Interface|PortShield): (.+?) (Bytes|Errors|Status).*$", "\2")}'
          - type: STRING
            name: primary_label_color
            value: '666699'
          - type: STRING
            name: reference
            value: SVIZL
          - type: STRING
            name: secondary_label_color
            value: '666699'
          - type: INTEGER
            name: secondary_label_decimal_places
            value: '0'
          - type: INTEGER
            name: secondary_label_units_show
            value: '0'
          - type: STRING
            name: thresholds.0.color
            value: 00FF00
          - type: STRING
            name: thresholds.0.threshold
            value: '0'
          - type: STRING
            name: thresholds.1.color
            value: FFFF00
          - type: STRING
            name: thresholds.1.threshold
            value: '1'
          - type: STRING
            name: thresholds.2.color
            value: FF8000
          - type: STRING
            name: thresholds.2.threshold
            value: '10'
          - type: STRING
            name: thresholds.3.color
            value: FF465C
          - type: STRING
            name: thresholds.3.threshold
            value: '100'
          - type: STRING
            name: thresholds.4.color
            value: FF0000
          - type: STRING
            name: thresholds.4.threshold
            value: '1000'
        - type: graphprototype
          name: 'VLAN: Traffic'
          x: '19'
          width: '39'
          height: '14'
          fields:
          - type: INTEGER
            name: columns
            value: '1'
          - type: GRAPH_PROTOTYPE
            name: graphid.0
            value:
              host: Sonicwall Firewall
              name: 'VLAN: {#IFDESCR} Traffic'
          - type: STRING
            name: reference
            value: AGVQQ
          - type: INTEGER
            name: rows
            value: '3'
      - name: BGP
        widgets:
        - type: honeycomb
          name: BGP Neighbor States
          width: '12'
          height: '6'
          fields:
          - type: STRING
            name: items.0
            value: 'BGP Neighbor: * State'
          - type: INTEGER
            name: item_tags.0.operator
            value: '1'
          - type: STRING
            name: item_tags.0.tag
            value: Component
          - type: STRING
            name: item_tags.0.value
            value: BGP
          - type: STRING
            name: primary_label
            value: '{{ITEM.NAME}.regsub("^BGP Neighbor: (.+) State$", "\1")}'
          - type: STRING
            name: thresholds.0.color
            value: FF465C
          - type: STRING
            name: thresholds.0.threshold
            value: '1'
          - type: STRING
            name: thresholds.1.color
            value: FFE082
          - type: STRING
            name: thresholds.1.threshold
            value: '4'
          - type: STRING
            name: thresholds.2.color
            value: 80FF00
          - type: STRING
            name: thresholds.2.threshold
            value: '6'
        - type: problems
          y: '6'
          width: '48'
          height: '6'
          fields:
          - type: INTEGER
            name: show_tags
            value: '2'
          - type: INTEGER
            name: tags.0.operator
            value: '0'
          - type: STRING
            name: tags.0.tag
            value: Component
          - type: STRING
            name: tags.0.value
            value: BGP
        - type: gauge
          name: Session Uptime %
          x: '12'
          width: '17'
          height: '6'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.session.uptime
          - type: STRING
            name: max
            value: '604800'
          - type: STRING
            name: min
            value: '0'
          - type: STRING
            name: units
            value: '%'
        - type: item
          name: BGP Neighbours
          x: '29'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.neighbors.states
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '4'
          - type: STRING
            name: units
            value: states
        - type: item
          name: BGP Received Routes Count
          x: '29'
          y: '2'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.routes.received
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '4'
        - type: item
          name: BGP Session Uptime
          x: '29'
          y: '4'
          width: '10'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.session.uptime
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '4'
          - type: STRING
            name: units
            value: uptime
        - type: problems
          name: BGP Flapping Detection
          x: '39'
          width: '9'
          fields:
          - type: STRING
            name: problem
            value: Flapping
          - type: INTEGER
            name: show_tags
            value: '2'
          - type: INTEGER
            name: tags.0.operator
            value: '0'
          - type: STRING
            name: tags.0.tag
            value: Component
          - type: STRING
            name: tags.0.value
            value: BGP
        - type: item
          name: BGP Update Messages
          x: '39'
          y: '2'
          width: '9'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.routes.received
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '3'
          - type: INTEGER
            name: show.2
            value: '4'
        - type: item
          name: Total Messages Received
          x: '39'
          y: '4'
          width: '9'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.messages.total.received
          - type: INTEGER
            name: show.0
            value: '2'
          - type: INTEGER
            name: show.1
            value: '4'
          - type: STRING
            name: units
            value: messages
      - name: VPNs (Policy)
        widgets:
        - type: honeycomb
          name: VPN Policy Status
          width: '21'
          height: '14'
          fields:
          - type: STRING
            name: items.0
            value: '* Status'
          - type: INTEGER
            name: item_tags.0.operator
            value: '1'
          - type: STRING
            name: item_tags.0.tag
            value: Component
          - type: STRING
            name: item_tags.0.value
            value: VPNPolicy
          - type: INTEGER
            name: maintenance
            value: '1'
          - type: STRING
            name: primary_label
            value: '{{ITEM.NAME}.regsub("^VPN Policy: (.+) Status$", "\1")}'
          - type: INTEGER
            name: primary_label_bold
            value: '1'
          - type: STRING
            name: primary_label_color
            value: '666699'
          - type: INTEGER
            name: primary_label_size
            value: '40'
          - type: INTEGER
            name: show.0
            value: '1'
          - type: STRING
            name: thresholds.0.color
            value: 80FF00
          - type: STRING
            name: thresholds.0.threshold
            value: '1'
          - type: STRING
            name: thresholds.1.color
            value: FF465C
          - type: STRING
            name: thresholds.1.threshold
            value: '2'
        - type: graphprototype
          name: 'VPN Policy: Traffic'
          x: '21'
          width: '51'
          height: '9'
          fields:
          - type: INTEGER
            name: columns
            value: '1'
          - type: GRAPH_PROTOTYPE
            name: graphid.0
            value:
              host: Sonicwall Firewall
              name: 'VPN Policy: {#VPNNAME} ({#LOCALSUBNET}-{#REMOTESUBNET}) Traffic'
          - type: STRING
            name: reference
            value: ICZFU
          - type: INTEGER
            name: rows
            value: '2'
        - type: problems
          name: 'VPN Policy: Problems'
          x: '21'
          y: '9'
          width: '51'
          height: '5'
          fields:
          - type: INTEGER
            name: show
            value: '2'
          - type: INTEGER
            name: tags.0.operator
            value: '1'
          - type: STRING
            name: tags.0.tag
            value: Component
          - type: STRING
            name: tags.0.value
            value: VPNPolicy
      - name: VPNs (VTI)
        widgets:
        - type: honeycomb
          name: VPN Route Status
          width: '21'
          height: '14'
          fields:
          - type: STRING
            name: items.0
            value: '* Status'
          - type: INTEGER
            name: item_tags.0.operator
            value: '1'
          - type: STRING
            name: item_tags.0.tag
            value: Component
          - type: STRING
            name: item_tags.0.value
            value: VPNRoute
          - type: INTEGER
            name: maintenance
            value: '1'
          - type: STRING
            name: primary_label
            value: '{{ITEM.NAME}.regsub("^VPN Route: (.+) Status$", "\1")}'
          - type: INTEGER
            name: primary_label_bold
            value: '1'
          - type: STRING
            name: primary_label_color
            value: '666699'
          - type: INTEGER
            name: primary_label_size
            value: '40'
          - type: INTEGER
            name: show.0
            value: '1'
          - type: STRING
            name: thresholds.0.color
            value: 80FF00
          - type: STRING
            name: thresholds.0.threshold
            value: '1'
          - type: STRING
            name: thresholds.1.color
            value: FF465C
          - type: STRING
            name: thresholds.1.threshold
            value: '2'
        - type: item
          x: '12'
          y: '17'
          width: '6'
          height: '3'
          fields:
          - type: STRING
            name: description
            value: BGP Session Uptime
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.session.uptime
          - type: INTEGER
            name: show.0
            value: '3'
          - type: STRING
            name: units
            value: sessions
        - type: item
          x: '20'
          y: '17'
          width: '6'
          height: '3'
          fields:
          - type: STRING
            name: description
            value: BGP Total Messages
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.messages.total.received
          - type: INTEGER
            name: show.0
            value: '3'
          - type: STRING
            name: units
            value: messages
        - type: svggraph
          name: 'VPN Route: Traffic In/Out'
          x: '21'
          width: '51'
          height: '5'
          fields:
          - type: STRING
            name: ds.0.color
            value: 00FF80
          - type: INTEGER
            name: ds.0.fill
            value: '1'
          - type: STRING
            name: ds.0.items.0
            value: 'VPN Route: * Bytes In'
          - type: INTEGER
            name: ds.0.transparency
            value: '3'
          - type: STRING
            name: ds.1.color
            value: 8000FF
          - type: INTEGER
            name: ds.1.fill
            value: '1'
          - type: STRING
            name: ds.1.items.0
            value: 'VPN Route: * Bytes Out'
          - type: INTEGER
            name: ds.1.transparency
            value: '3'
          - type: INTEGER
            name: legend_lines
            value: '8'
          - type: INTEGER
            name: righty
            value: '0'
        - type: svggraph
          name: 'VPN Route: Errors In/Out'
          x: '21'
          y: '5'
          width: '51'
          height: '4'
          fields:
          - type: STRING
            name: ds.0.color
            value: FF8000
          - type: INTEGER
            name: ds.0.fill
            value: '1'
          - type: STRING
            name: ds.0.items.0
            value: 'VPN Route: * Errors In'
          - type: INTEGER
            name: ds.0.transparency
            value: '3'
          - type: INTEGER
            name: ds.0.type
            value: '2'
          - type: INTEGER
            name: ds.0.width
            value: '2'
          - type: STRING
            name: ds.1.color
            value: FF0000
          - type: INTEGER
            name: ds.1.fill
            value: '1'
          - type: STRING
            name: ds.1.items.0
            value: 'VPN Route: * Errors Out'
          - type: INTEGER
            name: ds.1.transparency
            value: '3'
          - type: INTEGER
            name: ds.1.type
            value: '2'
          - type: INTEGER
            name: ds.1.width
            value: '2'
          - type: INTEGER
            name: legend
            value: '0'
          - type: INTEGER
            name: righty
            value: '0'
        - type: problems
          name: 'VPN Route: Problems'
          x: '21'
          y: '9'
          width: '51'
          height: '5'
          fields:
          - type: INTEGER
            name: tags.0.operator
            value: '1'
          - type: STRING
            name: tags.0.tag
            value: Component
          - type: STRING
            name: tags.0.value
            value: VPNRoute
        - type: item
          x: '24'
          y: '20'
          width: '12'
          height: '6'
          fields:
          - type: STRING
            name: description
            value: BGP Session Activity Data
          - type: ITEM
            name: itemid.0
            value:
              host: Sonicwall Firewall
              key: bgp.session.uptime
          - type: INTEGER
            name: show.0
            value: '4'
          - type: STRING
            name: units
            value: sessions
    valuemaps:
    - uuid: d78e52e493644deb9181bdcdda09faff
      name: bgp.neighbor.state.valuemap
      mappings:
      - value: '1'
        newvalue: Idle
      - value: '2'
        newvalue: Connect
      - value: '3'
        newvalue: Active
      - value: '4'
        newvalue: OpenSent
      - value: '5'
        newvalue: OpenConfirm
      - value: '6'
        newvalue: Established
    - uuid: ccaf690dc4e045c8946a7ef3e93e305b
      name: sonicwall.ha.status.valuemap
      mappings:
      - value: '0'
        newvalue: Standalone
      - value: '100000'
        newvalue: Active
      - value: '125000'
        newvalue: Active
      - value: '375000'
        newvalue: Active
      - value: '625000'
        newvalue: Active
      - value: '875000'
        newvalue: Idle
      - value: '1000000'
        newvalue: Failed
    - uuid: fe8ad4c4a6d94b878754ccb0b6cf6985
      name: sonicwall.interface.status.valuemap
      mappings:
      - value: '1'
        newvalue: Up
      - value: '2'
        newvalue: Down
      - value: '3'
        newvalue: Testing
      - value: '4'
        newvalue: Unknown
      - value: '5'
        newvalue: Dormant
      - value: '6'
        newvalue: Not Present
      - value: '7'
        newvalue: Lower Layer Down
    - uuid: 5cd6b38b9d8a4c8888a5e47f89b8f239
      name: sonicwall.vpn.policy.status.valuemap
      mappings:
      - value: '1'
        newvalue: Active
      - value: '2'
        newvalue: Inactive
    - uuid: 89f83c1dbeb34b9daec9e5ac34faf7e0
      name: sonicwall.vpn.route.status.valuemap
      mappings:
      - value: '1'
        newvalue: Up
      - value: '2'
        newvalue: Down
      - value: '3'
        newvalue: Testing
      - value: '4'
        newvalue: Unknown
      - value: '5'
        newvalue: Dormant
      - value: '6'
        newvalue: Not Present
      - value: '7'
        newvalue: Lower Layer Down
