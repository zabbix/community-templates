zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: b6ee040cfe17488c87d6c332fe44f12e
      name: 'Grandstream GWN'
  templates:
    - uuid: f4c539fedde84ec1917067890a73fd83
      template: Grandstream_GWN_AP_SNMP
      name: 'Grandstream GWN AP SNMP'
      description: |
        Full SNMP template for Grandstream GWN Access Points.
        Base scalars + IF-MIB + LLD (Radios, WLAN/SSIDs, Clients).
        Network metrics at 30s. Uses host SNMP credentials (no {$SNMP_COMMUNITY} macro).
      groups:
        - name: 'Grandstream GWN'
      items:
        - uuid: f1d385d7f0c6411e9bf4cdb2c7e66557
          name: 'GWN IP Address'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.42397.1.1.2.5.0
          key: gwn.device.ip
          value_type: TEXT
        - uuid: cdd46ab8610f4f5a8e9a1e51373f5997
          name: 'GWN Device MAC'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.42397.1.1.2.3.0
          key: gwn.device.mac
          value_type: TEXT
        - uuid: c614954eb035489f93764dace4604a51
          name: 'GWN Device Model'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.42397.1.1.2.1.0
          key: gwn.device.model
          value_type: TEXT
        - uuid: 212cb03163434b939cbc36f83e753e97
          name: 'GWN Device Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.42397.1.1.2.2.0
          key: gwn.device.name
          value_type: TEXT
        - uuid: 9c3ef1d000774d84a1a34cd0f77cec22
          name: 'GWN Device Uptime (seconds)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.42397.1.1.2.6.0
          key: gwn.device.uptime.sec
          delay: 30s
          trends: 30d
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
        - uuid: 2b1208e555a44ed2947ff0d64823d40a
          name: 'GWN Firmware Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.42397.1.1.2.4.0
          key: gwn.device.version
          value_type: TEXT
        - uuid: a54a250739e4488eb91aaa78523b3f5a
          name: 'System Description'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysDescr.0'
          key: system.descr
          value_type: TEXT
        - uuid: 3253aaf9f64a499e8b156aca5474fdab
          name: 'System Name'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysName.0'
          key: system.name
          value_type: TEXT
        - uuid: 1d37037fd85449ab8dc02f9f9f3126ac
          name: 'System ObjectID'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysObjectID.0'
          key: system.objectid
          value_type: TEXT
        - uuid: 2ecaa4d424024abca2ebc690448a4e28
          name: 'System Uptime (seconds)'
          type: SNMP_AGENT
          snmp_oid: 'DISMAN-EVENT-MIB::sysUpTimeInstance'
          key: system.uptime.sec
          delay: 30s
          trends: 30d
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
      discovery_rules:
        - uuid: d0e5b0a1c2d34a36b7d8e9fa0b1c2d3e
          name: 'Clients (LLD)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CLIENT.MAC}, 1.3.6.1.4.1.42397.1.1.5.1.1.2, {#CLIENT.ESSID}, 1.3.6.1.4.1.42397.1.1.5.1.1.3]'
          key: gwn.client.discovery
          item_prototypes:
            - uuid: 8e8bf3d0e3c145f8a4cbe6d5a7f3a2d1
              name: 'Client {#CLIENT.MAC}: ESSID'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.5.1.1.3.{#SNMPINDEX}'
              key: 'gwn.client.essid["{#SNMPINDEX}"]'
              delay: 30s
              value_type: TEXT
            - uuid: 4cf9f9a2c3b04b0a84a3f3b3c6d5e7f9
              name: 'Client {#CLIENT.MAC}: RSSI (dBm)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.5.1.1.4.{#SNMPINDEX}'
              key: 'gwn.client.rssi["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: dBm
              trigger_prototypes:
                - uuid: 4de2b9c6a5f144f69d4b8a8a9d5b2a0f
                  expression: 'avg(/Grandstream_GWN_AP_SNMP/gwn.client.rssi["{#SNMPINDEX}"],10m)<{$GWN_CLIENT_RSSI_WARN}'
                  name: 'Client {#CLIENT.MAC}: low RSSI'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 3ae6b5c4d3e24c2b8f7a6d5c4b3a2918
              name: 'Client {#CLIENT.MAC}: Rx Bits/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.5.1.1.6.{#SNMPINDEX}'
              key: 'gwn.client.rx.bps["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
            - uuid: 0d4c3b2a1f4e4e1b9a8c7d6e5f4a3b2c
              name: 'Client {#CLIENT.MAC}: Tx Bits/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.5.1.1.5.{#SNMPINDEX}'
              key: 'gwn.client.tx.bps["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
        - uuid: a1a9f2697a3b43bba15b4df6a12a0e10
          name: 'Radios (LLD)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#RADIO.NAME}, 1.3.6.1.4.1.42397.1.1.3.1.1.3]'
          key: gwn.radio.discovery
          item_prototypes:
            - uuid: 7c6a8a3f9b7b44f685b236e2237c3a73
              name: 'Radio {#RADIO.NAME}: Channel'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.3.1.1.5.{#SNMPINDEX}'
              key: 'gwn.radio.channel["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
            - uuid: 9f6d90b0b4d34f9598e4977dc3f6f6f5
              name: 'Radio {#RADIO.NAME}: Rx Bits/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.3.1.1.15.{#SNMPINDEX}'
              key: 'gwn.radio.rx.bps["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
            - uuid: 3cccfbd4723c4d69b8a8b4b33c0d6d43
              name: 'Radio {#RADIO.NAME}: Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.3.1.1.10.{#SNMPINDEX}'
              key: 'gwn.radio.status["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
            - uuid: 6a0a8a2f9b7341d1a05e2b701d6a860a
              name: 'Radio {#RADIO.NAME}: Tx Bits/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.3.1.1.14.{#SNMPINDEX}'
              key: 'gwn.radio.tx.bps["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
            - uuid: 5b38f3c0f9e14e60a5e3e63b2b1bd014
              name: 'Radio {#RADIO.NAME}: Tx Drops/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.3.1.1.16.{#SNMPINDEX}'
              key: 'gwn.radio.tx.drops["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              preprocessing:
                - type: CHANGE_PER_SECOND
              trigger_prototypes:
                - uuid: 1f1a9d2b3c4d43d7a8a9b6f6c5d4e3f2
                  expression: 'avg(/Grandstream_GWN_AP_SNMP/gwn.radio.tx.drops["{#SNMPINDEX}"],5m)>{$GWN_RADIO_DROPS_WARN}'
                  name: 'Radio {#RADIO.NAME}: high TX drops'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: f2b9e888cb5c4863a7a9b6a7f2e1b0ae
              name: 'Radio {#RADIO.NAME}: Tx Power (dBm)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.3.1.1.6.{#SNMPINDEX}'
              key: 'gwn.radio.txpower["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: dBm
        - uuid: 0e7d7e2a8c1f4b75a4b64bdb8a3e22d1
          name: 'WLAN/SSID (LLD)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#WLAN.ESSID}, 1.3.6.1.4.1.42397.1.1.4.1.1.2, {#WLAN.BSSID}, 1.3.6.1.4.1.42397.1.1.4.1.1.3]'
          key: gwn.wlan.discovery
          item_prototypes:
            - uuid: 7d6e5c4b3a2f489ba1d2c3b4e5f60718
              name: 'WLAN {#WLAN.ESSID}: BSSID'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.4.1.1.3.{#SNMPINDEX}'
              key: 'gwn.wlan.bssid["{#SNMPINDEX}"]'
              delay: 30s
              value_type: TEXT
            - uuid: 0b1d2a0f9e6c47b8a9d2f2b0c6e0d1f2
              name: 'WLAN {#WLAN.ESSID}: ESSID'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.4.1.1.2.{#SNMPINDEX}'
              key: 'gwn.wlan.essid["{#SNMPINDEX}"]'
              delay: 30s
              value_type: TEXT
            - uuid: 6c0fb0c0ddf449349a5b2b0a5ea2b1e5
              name: 'WLAN {#WLAN.ESSID}: Rx Bits/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.4.1.1.5.{#SNMPINDEX}'
              key: 'gwn.wlan.rx.bps["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
            - uuid: 5ed1b8a7a3c944b09c03c7b2e2a3d3e5
              name: 'WLAN {#WLAN.ESSID}: Tx Bits/s'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.42397.1.1.4.1.1.4.{#SNMPINDEX}'
              key: 'gwn.wlan.tx.bps["{#SNMPINDEX}"]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
        - uuid: 9f4a1f7a4a9b4d8da3e30f3a6a1a5e3a
          name: 'Interfaces (IF-MIB)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR}, ifDescr]'
          key: if.discovery
          delay: 30s
          description: 'Interface discovery via IF-MIB.'
          item_prototypes:
            - uuid: 2bcb4a6c9a4b4edda3c2a1d3e4f5a6b7
              name: 'Interface {#IFDESCR}: IN Discards'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInDiscards.{#SNMPINDEX}'
              key: 'net.if.in[ifInDiscards.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
            - uuid: 5d9b5b6e3f2a4fc5af2e7d3a3f64b2f4
              name: 'Interface {#IFDESCR}: IN Errors'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'net.if.in[ifInErrors.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
            - uuid: 5e5e5e1f5c3b4a7cb8a23e6fbcf7a6d6
              name: 'Interface {#IFDESCR}: IN Octets'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'net.if.in[ifInOctets.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
            - uuid: e7a4c4b7b1a84f3d8c2a3f4e5a6b7c8d
              name: 'Interface {#IFDESCR}: OUT Discards'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutDiscards.{#SNMPINDEX}'
              key: 'net.if.out[ifOutDiscards.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
            - uuid: 44f7f6d4c6a54373b1a5d4b7b6f3e5a6
              name: 'Interface {#IFDESCR}: OUT Errors'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'net.if.out[ifOutErrors.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
            - uuid: 63a0c5c4a9b641fdb2d6d0c6d2b2a3c3
              name: 'Interface {#IFDESCR}: OUT Octets'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'net.if.out[ifOutOctets.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
            - uuid: 6d8e0ad4c3b14f66a1e6b7c8d9e0f1a2
              name: 'Interface {#IFDESCR}: Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              delay: 30s
              trends: 30d
              trigger_prototypes:
                - uuid: 6fd5d4d7c8a642a8afa1f62b1e7f1a22
                  expression: '(last(/Grandstream_GWN_AP_SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Grandstream_GWN_AP_SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1'
                  name: 'Interface {#IFDESCR}: status changed'
                  priority: HIGH
                  manual_close: 'YES'
      macros:
        - macro: '{$GWN_CLIENT_RSSI_WARN}'
          value: '-75'
          description: 'RSSI warning threshold in dBm (avg over 10m).'
        - macro: '{$GWN_RADIO_DROPS_WARN}'
          value: '50'
          description: 'Radio TX drops/s warning threshold (avg 5m).'
