zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: c5381dc540504dbba10e2d300554e4cd
      name: Firewall
  templates:
    - uuid: 70bea07f3fbf4af0bf65b40690311461
      template: 'Watchguard Firewall'
      name: 'Watchguard Firewall'
      description: |
        ## Overview
        This template provides comprehensive monitoring for WatchGuard Firebox appliances using SNMPv2/v3 protocol. It delivers complete visibility into system health, network performance, VPN tunnels, high availability status, and hardware components across physical and virtual firewall deployments.
        
        ## Core Features
        - **Multi-Protocol Support**: SNMPv2 (validated) / SNMPv3 (partial validation)
        - **Hardware Monitoring**: CPU, memory, disk, temperature, fan, and PSU status
        - **Network Performance**: Interface traffic, errors, VLAN monitoring with auto-discovery
        - **VPN Monitoring**: BoVPN and Gateway VPN tunnel statistics and state tracking
        - **High Availability**: Cluster synchronisation, member health, and failover monitoring
        - **Security Features**: Application Control, Content Filtering, and licensing status
        - **Proactive Alerting**: 50+ triggers with configurable thresholds
        - **Rich Visualisation**: 25+ graphs with traffic overlays and trend analysis
        
        ## Monitoring Components
        
        ### Items (Base Metrics)
        - **System Information**: 
          * Device uptime, firmware version, serial number
          * Feature key expiry dates (Application Control, Content Filtering, Gateway AV)
          * SNMP system description and location
        - **Licensing Status**:
          * Application Control, Content Filtering, Gateway AV enabled states
          * Feature expiry tracking with advance warning triggers
        - **Cluster/HA Status**:
          * Primary/secondary member hardware health
          * Cluster enabled state and synchronisation status
          * Member role identification and failover detection
        - **VPN Master Items**:
          * BoVPN interface table (raw SNMP data)
          * Gateway VPN SA table (security association data)
          * Policy-based VPN subnet pair mapping
        
        ### Discovery Rules (8 Active Rules)
        - **Network Interfaces (Multiple Types)**: 
          * Ethernet Interfaces: Physical RJ-45 and copper ports (ifType=6, excluding VLANs)
          * Fiber Interfaces: SFP/SFP+ fiber optic connections (ifType=56)
          * VLAN Interfaces: Virtual LAN sub-interfaces (ifType=6 with naming patterns)
          * BoVPN Interfaces: Virtual Tunnel Interfaces (ifType=131)
          * Filter: Configurable interface exclusion regex for HA-Link and unused ports
          * Update: Hourly discovery with 2-minute traffic and error monitoring
        - **BGP Routing Protocol**:
          * Discovery: Dynamic BGP neighbor identification and session monitoring
          * Metrics: Session state, routes received, peer uptime, convergence tracking
          * Update: 10-minute discovery with real-time session and routing monitoring
        - **VPN Tunnels (Dual Monitoring Approaches)**:
          * Update: Hourly discovery with real-time traffic monitoring
        - **Gateway VPN Policies**: 
          * Discovery: Policy-based tunnels via SA table analysis
          * Filter: Subnet pair exclusion regex
          * Update: Dependent items with 5-minute master updates
        - **CPU Processors**: 
          * Discovery: Multi-core processor enumeration
          * Metrics: Per-core utilisation percentage
          * Update: Hourly discovery with 5-minute utilisation polling
        - **Disk Partitions**: 
          * Discovery: Storage volumes (/var, /, /boot, /tmp)
          * Metrics: Used/total space, utilisation percentage
          * Update: Hourly discovery with 30-minute usage polling
        - **Hardware Sensors** (Firmware Limited):
          * Fan Sensors: Speed (RPM) and status monitoring (disabled - v12.10+ limitation)
          * Power Supplies: Status and fault detection (disabled - v12.10+ limitation)
          * Temperature Sensors: Thermal monitoring with thresholds (disabled - v12.10+ limitation)
        
        ### Item Prototypes (Per Discovery Instance)
        - **BGP Routing Metrics**:
          * Session Management: Neighbor state, session uptime, connection stability
          * Route Analysis: Routes received, prefix tracking, convergence monitoring
          * Performance: Update processing, route flap detection, peer responsiveness
        - **Network Interface Metrics (Type-Specific)**:
          * Ethernet Traffic: Physical interface throughput and error monitoring
          * Fiber Traffic: High-speed optical interface performance tracking
          * VLAN Traffic: Virtual interface segmentation and utilization analysis
          * Error Detection: Type-specific error counters with threshold alerting
          * Status Monitoring: Operational state tracking across all interface types
        - **BoVPN Tunnel Metrics**:
          * Traffic: Encrypted tunnel throughput (in/out bytes/packets)
          * Errors: Tunnel-specific error counters and rates
          * Status: Tunnel operational state and administrative status
          * Health: Connection stability and flap detection
        - **Gateway VPN Policy Metrics**:
          * Traffic: Policy-based tunnel throughput per subnet pair
          * Session: Active security association tracking
          * Identification: Tunnel naming and CIDR subnet mapping
          * Persistence: Stable monitoring across tunnel renegotiation
        - **Hardware Performance Metrics**:
          * CPU: Per-processor utilisation with threshold alerting
          * Storage: Partition usage with capacity planning triggers
          * Sensors: Temperature, fan speed, PSU status (when firmware supports)
        
        ### Trigger Prototypes (Proactive Alerting)
        - **BGP Routing Triggers**:
          * Route Count Thresholds: Critical and warning alerts for route table changes
          * Session State Changes: BGP neighbor up/down detection and flap monitoring
          * Connection Stability: Peer session instability with configurable thresholds
        - **Network Interface Triggers (Type-Aware)**:
          * Interface State Changes: Type-specific alerting for Ethernet, Fiber, VLAN interfaces
          * High Error Rates: Interface-type-optimized thresholds for error detection
          * Traffic Anomalies: Performance alerts tailored to interface capabilities
        - **VPN Tunnel Triggers**:
          * Tunnel State Changes: BoVPN tunnel up/down detection
          * Connection Flapping: Tunnel instability detection with hysteresis
          * Traffic Interruption: Policy-based VPN flow monitoring
        - **System Health Triggers**:
          * CPU High Utilisation: Per-processor threshold alerting
          * Storage Capacity: Disk usage warnings and critical alerts
          * Cluster Synchronisation: HA member health and sync status
          * Hardware Faults: Temperature, fan, and PSU status monitoring
        - **Security Feature Triggers**:
          * Feature Expiry: Advance warning for license expiration
          * Service Availability: Application Control and Content Filtering status
        
        ### Graph Prototypes (Visual Analytics)
        - **BGP Performance Graphs**:
          * Route Tracking: BGP neighbor route count trends and stability analysis
          * Session State History: BGP neighbor state transitions and uptime monitoring
          * Convergence Analysis: Routing stability and peer relationship health
        - **Network Performance Graphs (Type-Specific)**:
          * Ethernet Traffic: Physical interface throughput with error overlay visualization
          * Fiber Traffic: High-speed optical interface performance and utilization trends
          * VLAN Traffic: Virtual interface segmentation analysis and capacity planning
          * Error Analysis: Interface-type-specific error tracking with threshold indicators
        - **VPN Performance Graphs**:
          * BoVPN Throughput: Tunnel-specific traffic analysis with bidirectional flow
          * Gateway VPN Traffic: Policy-based tunnel performance per subnet pair
          * Aggregated VPN: Combined tunnel traffic for capacity planning
        - **System Performance Graphs**:
          * CPU Utilisation: Multi-processor performance trending
          * Storage Usage: Partition utilisation with growth projections
          * Hardware Health: Temperature trends and fan performance (when available)
        - **High Availability Graphs**:
          * Cluster Status: Member health and synchronisation trending
          * Failover Events: HA transition analysis and recovery metrics
        
        ## Dashboard Integration
        
        ### Executive Overview Page
        - **System Status Widget**: Device uptime, firmware version, cluster role
        - **Health Summary Widget**: Overall system health with traffic light indicators
        - **License Status Widget**: Feature expiry countdown with renewal alerts
        - **Performance KPIs**: CPU, memory, and storage utilisation gauges
        
        ### Network Infrastructure Page
        - **Ethernet Interface Widget**: Physical port status matrix with traffic indicators
        - **Fiber Interface Widget**: High-speed optical interface performance overview
        - **VLAN Interface Widget**: Virtual network segmentation and traffic analysis
        - **Interface Type Comparison**: Multi-type interface performance dashboard
        - **Traffic Heat Map**: Network utilization analysis with interface-type categorization
        
        ### BGP Routing Page
        - **BGP Neighbor Widget**: Dynamic peer discovery with session state visualization
        - **Route Analysis Dashboard**: Route count tracking, convergence monitoring, and table growth
        - **BGP Session History**: Peer state transitions and connection stability metrics
        - **Routing Performance**: Update processing and network convergence analysis
        
        ### VPN Monitoring Page
        - **Tunnel Status Matrix**: BoVPN and Gateway VPN operational overview
        - **VPN Throughput Widget**: Combined tunnel traffic with peak analysis
        - **Policy Performance**: Gateway VPN subnet pair traffic breakdown
        - **Connection Stability**: Tunnel flap detection and uptime statistics
        
        ### Infrastructure Health Page
        - **Hardware Status Widget**: CPU, storage, temperature overview
        - **Capacity Planning**: Growth projections for CPU and storage resources
        - **Alert Summary**: Active triggers with severity classification
        - **Maintenance Calendar**: License expiry and recommended update scheduling
        
        ### High Availability Page
        - **Cluster Overview Widget**: HA member status and role assignment
        - **Synchronisation Health**: Real-time sync status and lag indicators
        - **Failover History**: HA transition events and recovery metrics
        - **Member Comparison**: Performance differential between cluster nodes
        
        ## Supported Platforms
        - **WatchGuard Firebox M Series**: M370, M470, M570, M670, M4800, M5800
        - **Firebox T Series**: T15, T35, T55 (partial hardware sensor support)
        - **Virtual Appliances**: Firebox Cloud and VMware deployments
        - **High Availability**: Active/passive 2-node clusters with full monitoring
        - **Firmware Versions**: v12.1+ (validated), v11.12+ (community reported)
        
        ## Technical Requirements
        - **SNMP Configuration**: SNMPv2c (recommended) or SNMPv3 with read-only access
        - **Network Access**: Management interface accessibility from Zabbix proxy/server
        - **Firmware Dependencies**: Some hardware sensors require v12.11+ (currently limited)
        - **Performance Impact**: Polling optimised for minimal device overhead (<1% CPU)
        - **Discovery Efficiency**: Staged discovery with smart filtering to reduce noise
        
        ## Implementation Notes
        - **VPN Limitations**: Dynamic Mobile VPN sessions not fully supported
        - **Hardware Sensors**: Fan, temperature, and PSU monitoring disabled due to firmware limitations in v12.10+
        - **SNMP Security**: Template supports both community strings and SNMPv3 authentication
        - **Scalability**: Tested with 50+ concurrent firewall monitoring instances
        - **Integration**: Compatible with Zabbix 6.0+ and all standard notification channels
        
        **Template Author**: Simon Jackson (@sjackson0109)  
        **Version**: 2.1 | **Last Updated**: February 2026 | **License**: GPLv3
      vendor:
        name: WatchGuard
        version: 12.x
      groups:
        - name: Firewall
      items:
        - uuid: 01631f0dd4ee4fb294b78656cae137d6
          name: 'Application Control Enabled'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.4.3.0
          key: appcontrol.status
          delay: 1h
          history: 30d
          value_type: FLOAT
          status: DISABLED
          valuemap:
            name: feature.status.valuemap
          tags:
            - tag: Component
              value: Licensing
        - uuid: 114315b387144adeb928ffd6b187f140
          name: 'FireCluster Primary Member Hardware Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.5.0
          key: 'cluster.hardware.health[primary]'
          history: 30d
          description: 'Hardware health status of the Primary FireCluster member'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 2b8be0c8e690433485d0c092f2797414
              expression: 'min(/Watchguard Firewall/cluster.hardware.health[primary],5m)<100'
              name: 'FireCluster Primary Member Hardware Health Problem'
              priority: HIGH
              description: 'Primary FireCluster member hardware health status is not OK. Possible hardware issue.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: e5a476b52d8d422da9f9d0c55b2de2c3
          name: 'FireCluster Secondary Member Hardware Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.11.0
          key: 'cluster.hardware.health[secondary]'
          history: 30d
          description: 'Hardware health status of the Secondary FireCluster member'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: f5488d9e48b8497c82a3e047fcec78b0
              expression: 'min(/Watchguard Firewall/cluster.hardware.health[secondary],5m)<100'
              name: 'FireCluster Secondary Member Hardware Health Problem'
              priority: HIGH
              description: 'Secondary FireCluster member hardware health status is not OK. Possible hardware issue.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: f143cb6474e343c0b4d3af8481fdb991
          name: 'FireCluster Primary Member Interface Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.6.0
          key: 'cluster.interface.health[primary]'
          history: 30d
          description: 'Interface (Port) health status of the Primary FireCluster member'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: a36e7dc9d8b74e08beaa7a60e3070150
              expression: 'min(/Watchguard Firewall/cluster.interface.health[primary],5m)<100'
              name: 'FireCluster Primary Member Interface Health Problem'
              priority: HIGH
              description: 'Primary FireCluster member interface (port) health status is not OK. Link/port issues suspected.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 3aa7127f6c6d4fc0b41f53ef57e68bc1
          name: 'FireCluster Secondary Member Interface Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.12.0
          key: 'cluster.interface.health[secondary]'
          history: 30d
          description: 'Interface (Port) health status of the Secondary FireCluster member'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 81f1cfc6a9eb4260af02a199da4f2c8f
              expression: 'min(/Watchguard Firewall/cluster.interface.health[secondary],5m)<100'
              name: 'FireCluster Secondary Member Interface Health Problem'
              priority: WARNING
              description: 'Secondary FireCluster member interface (port) health status is not OK. Secondary link/port may have issues.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 14096a620e294fe192b5717da09b9af8
          name: 'FireCluster Primary Member Role'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.3.0
          key: 'cluster.role[primary]'
          delay: 5m
          history: 30d
          description: 'Cluster Member Role'
          valuemap:
            name: member.role.valuemap
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 7598eecfb9d44707a111a8f1f7f10dad
              expression: 'min(/Watchguard Firewall/cluster.role[primary],5m)<>2 and min(/Watchguard Firewall/cluster.role[primary],5m)<>3'
              name: 'FireCluster Role Unexpected or Unstable'
              priority: WARNING
              description: 'Cluster member is neither Master nor Standby. May be stuck in reboot, transition state, or out of sync.'
              tags:
                - tag: Component
                  value: HA
                - tag: Type
                  value: RoleState
        - uuid: 086bd2fdd99843039fc5b04c68153225
          name: 'FireCluster Secondary Member Role'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.9.0
          key: 'cluster.role[secondary]'
          delay: 5m
          history: 30d
          description: 'Cluster Member Role'
          valuemap:
            name: member.role.valuemap
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 213bbdbfa19547fd8f1ab113ec090b04
              expression: 'min(/Watchguard Firewall/cluster.role[secondary],5m)<>2 and min(/Watchguard Firewall/cluster.role[secondary],5m)<>3'
              name: 'FireCluster Role Unexpected or Unstable'
              priority: WARNING
              description: 'Cluster member is neither Master nor Standby. May be stuck in reboot, transition state, or out of sync.'
              tags:
                - tag: Component
                  value: HA
                - tag: Type
                  value: RoleState
        - uuid: 7635cc08a4d548b3a439f042050dffe8
          name: 'FireCluster Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.1.0
          key: cluster.status
          delay: 5m
          history: 30d
          value_type: FLOAT
          valuemap:
            name: cluster.status.valuemap
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
        - uuid: 9e291445b25c49009f02b0ebf8221c28
          name: 'Cluster Synchronisation Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.5.0
          key: cluster.sync.status
          history: 30d
          value_type: FLOAT
          units: '%'
          description: 'Reports the synchronisation percentage between FireCluster nodes (0├óΓé¼ΓÇ£100%). Available only  if FireCluster is enabled. A persistent value below 100% indicates configuration or state mismatch between cluster  members.'
          valuemap:
            name: cluster.sync.valuemap
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: b1d90c34321d4c9f91da6e1c1eb14542
              expression: 'min(/Watchguard Firewall/cluster.sync.status,5m)<>100'
              name: 'Cluster Synchronisation Issue Detected'
              priority: HIGH
              description: 'FireCluster nodes are not fully synchronised. Possible configuration divergence, failover event, or cluster instability.'
              tags:
                - tag: Component
                  value: HA
                - tag: EventType
                  value: SyncIssue
        - uuid: d369bbd462a4401a9fb30f1484a75709
          name: 'FireCluster Primary Member System Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.4.0
          key: 'cluster.system.health[primary]'
          history: 30d
          description: 'System health status of the Primary FireCluster member'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 35619e3ccfb04aa6b0f8b8b1cadfd774
              expression: 'min(/Watchguard Firewall/cluster.system.health[primary],5m)<100'
              name: 'FireCluster Primary Member System Health Problem'
              priority: HIGH
              description: 'Primary FireCluster member system health status is not OK. Investigate potential failures.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 76fc99ec79c74197a1ee02f8c374f32f
          name: 'FireCluster Secondary Member System Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.10.0
          key: 'cluster.system.health[secondary]'
          history: 30d
          description: 'System health status of the Secondary FireCluster member'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 916d7c58f9af49c48622f5da3e63c78e
              expression: 'min(/Watchguard Firewall/cluster.system.health[secondary],5m)<100'
              name: 'FireCluster Secondary Member System Health Problem'
              priority: HIGH
              description: 'Secondary FireCluster member system health status is not OK. Investigate potential failures.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 7bf47d4cf3f0427c90077b3070d9ae01
          name: 'Active Connections'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.1.0
          key: connections.active
          history: 30d
          value_type: FLOAT
          units: connections
          description: 'Current active firewall connections'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          triggers:
            - uuid: b29b0981202f43dfa0f9fed286962c04
              expression: 'last(/Watchguard Firewall/connections.active) > {$WATCHGUARD_MAX_CONNECTIONS}'
              name: 'Possible DDoS Attack'
              priority: AVERAGE
              description: 'Total connections ({ITEM.LASTVALUE}) exceeded threshold ({$WATCHGUARD_MAX_CONNECTIONS})'
              tags:
                - tag: Component
                  value: Connections
        - uuid: e756a8c29bf64b5bb507238cd6314304
          name: 'Connection Rate'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.2.0
          key: connections.rate
          history: 30d
          value_type: FLOAT
          units: conn/s
          description: 'Current connection rate'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Metrics
              value: Traffic
        - uuid: 0a7d17d617f849748f83fcf2521f54b5
          name: 'Device Description'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysDescr.0'
          key: description
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'A textual description of the entity.  This value should include the full name and version identification of the system''s hardware type, software operating-system, and networking software.'
          inventory_link: HARDWARE
          tags:
            - tag: Component
              value: General
        - uuid: 47ecd8643eb14dce951d3e7204b377ec
          name: 'GAV Update'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.3.0
          key: gav.version
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Gateway AV service last update time'
          preprocessing:
            - type: REGEX
              parameters:
                - '<gav_version:[\d\.]+>\((.*?)\)'
                - \1
          tags:
            - tag: Component
              value: Licensing
          triggers:
            - uuid: c7c34885066042268335c60f4ac48bff
              expression: 'length(last(/Watchguard Firewall/gav.version))=0'
              name: 'Antivirus (GAV) Disabled, Not Installed or No Updating'
              priority: WARNING
        - uuid: 48704d5ad2654eaeadfe1060259f5888
          name: 'IPS Update'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.4.0
          key: ips.version
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'IPS service last update time'
          preprocessing:
            - type: REGEX
              parameters:
                - '<ips_version:[\d\.]+>\((.*?)\)'
                - \1
          tags:
            - tag: Component
              value: Licensing
          triggers:
            - uuid: 78e413ece3b74e3d8d0e0b4bde05e3ed
              expression: 'length(last(/Watchguard Firewall/ips.version))=0'
              name: 'Intrusion Protection System (IPS) Disabled, Not Installed or No Updating'
              priority: WARNING
        - uuid: 529287f4ce164be1be0a1eabead176a5
          name: 'Device Location'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysLocation.0'
          key: location
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'The physical location of this node (e.g., `telephone closet, 3rd floor'').  If the location is unknown, the value is the zero-length string.'
          inventory_link: LOCATION
          tags:
            - tag: Component
              value: General
        - uuid: 3fb0eec716ee423a819486947d8666d0
          name: 'Device Model'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysDescr.0'
          key: model
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Model name or identifier of the WatchGuard hardware.'
          inventory_link: MODEL
          tags:
            - tag: Component
              value: General
        - uuid: 5f9f37467ceb4deba44592bed7bff233
          name: 'Device Name'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysName.0'
          key: name
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'An administratively-assigned name for this managed node. By convention, this is the node''s fully-qualified domain name.  If the name is unknown, the value is the zero-length string.'
          inventory_link: NAME
          tags:
            - tag: Component
              value: General
        - uuid: 9ae35f6ab16d42ae84acc6bb6b91316f
          name: 'Traffic: Inbound'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.5.0
          key: traffc_inbound
          history: 30d
          value_type: FLOAT
          units: bps
          description: 'Total inbound traffic'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Metrics
              value: Traffic
        - uuid: 276ee8e2402e4b799d1bbb52110559f9
          name: 'Traffic: Outbound'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.6.0
          key: traffc_outbound
          history: 30d
          value_type: FLOAT
          units: bps
          description: 'Total outbound traffic'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Metrics
              value: Traffic
        - uuid: 9d37f216afb040ae85a1f6dfda360251
          name: 'Device Uptime'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysUpTime.0'
          key: uptime
          delay: '30'
          history: 1w
          units: uptime
          description: 'The time since the network management portion of the system was last re-initialised.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: General
        - uuid: 923e85e3335046db9f3078f89cf5f1d2
          name: 'VPN Policy: SA Table'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.3097.6.5.1.2.1]'
          key: vpn.policy.sa.table.raw
          delay: 30s
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Raw SNMP walk of the VPN Policy Security Association table. Used as master item for dependent VPN policy monitoring.'
          tags:
            - tag: Component
              value: VPN
        - uuid: 46eeebe15b3a40779bd76821e2ee5c2e
          name: 'System CPU Utilisation'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.77.0
          key: watchguard.system.cpu.util
          history: 30d
          units: '%'
          description: 'CPU utilisation percentage over the last 1 minute.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          triggers:
            - uuid: 5646e63dd8e4497a9e4ceebbaf85f756
              expression: 'avg(/Watchguard Firewall/watchguard.system.cpu.util,3m) > 90'
              name: 'High CPU Usage (>90%) Detected (3 minutes)'
              priority: HIGH
              description: 'The CPU utilisation has been above 90% consistently for the past 3 minutes. Check for overloaded processes, traffic spikes, or potential system resource exhaustion.'
              tags:
                - tag: Resource
                  value: CPU
        - uuid: 626d070250584ec5970fd97e87a00abf
          name: 'WatchGuard System Current Time'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.1.0
          key: watchguard.system.currenttime
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'var timestamp=parseInt(value);if(isNaN(timestamp))throw ''Invalid timestamp'';var date=new Date(timestamp*1000);return date.getUTCFullYear()+''-''+(''0''+(date.getUTCMonth()+1)).slice(-2)+''-''+(''0''+date.getUTCDate()).slice(-2)+'' ''+(''0''+date.getUTCHours()).slice(-2)+'':''+(''0''+date.getUTCMinutes()).slice(-2)+'':''+(''0''+date.getUTCSeconds()).slice(-2);'
        - uuid: 13f42e02f8a44c1396c7bfe6b30b4c21
          name: 'Device Firmware'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.1.0
          key: watchguard.system.firmware
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Firmware version currently running on the Watchguard gateway device.'
          preprocessing:
            - type: REGEX
              parameters:
                - '<sysa:([^>]+)>'
                - \1
          tags:
            - tag: Component
              value: General
        - uuid: 5ba25820fe984afd8bf91795045186b7
          name: 'LiveSecurity Expires'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.5.0
          key: watchguard.system.livesecurityexp
          delay: 1h
          history: 30d
          value_type: CHAR
          trends: '0'
          description: 'Expiration date of the LiveSecurity Support Subscription.'
          preprocessing:
            - type: REGEX
              parameters:
                - '<feature key>\(LIVESECURITY:\s(.*?)\)'
                - \1
        - uuid: 45b6065d71e249d9a8052cbe9b5bf8a3
          name: 'System Total Bytes Received (bps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.9.0
          key: watchguard.system.total_recv_bps
          delay: 30s
          history: 30d
          units: bps
          description: 'Total number of bytes received, converted to bits per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
        - uuid: 631a3f97f1554ab3b9640ec3afef657c
          name: 'System Total Packets Received (pps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.11.0
          key: watchguard.system.total_recv_pps
          delay: 30s
          history: 30d
          units: pps
          description: 'Total number of packets received, converted to packets per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
        - uuid: 67255bac37514d2cbedf7ea210c817e7
          name: 'System Total Bytes Sent (bps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.8.0
          key: watchguard.system.total_send_bps
          delay: 30s
          history: 30d
          units: bps
          description: 'Total number of bytes sent, converted to bits per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
        - uuid: e87fe62f46544b6d8a9faf2b1c3d7b0b
          name: 'System Total Packets Sent (pps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.10.0
          key: watchguard.system.total_send_pps
          delay: 30s
          history: 30d
          units: pps
          description: 'Total number of packets sent, converted to packets per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
      discovery_rules:
        - uuid: 1b553dfbef0b4849b4f51e0bc81594f9
          name: 'BGP Neighbors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#BGP_NEIGHBOR},1.3.6.1.2.1.15.3.1.7,{#BGP_STATE},1.3.6.1.2.1.15.3.1.2]'
          key: bgp.neighbors.discovery
          delay: 10m
          filter:
            conditions:
              - macro: '{#BGP_STATE}'
                value: '^[1-6]$'
                formulaid: A
          description: |
            Discover BGP neighbors and their current states.
            Provides per-neighbor monitoring for: - Session state changes - Route count monitoring - Flap detection - Convergence tracking
            Uses standard BGP-4 MIB (RFC 4273) OIDs that should be supported on WatchGuard Fireboxes with BGP routing enabled. States: 1=idle, 2=connect, 3=active, 4=opensent, 5=openconfirm, 6=established
          item_prototypes:
            - uuid: 2c553dfbef0b4849b4f51e0bc815950a
              name: 'BGP Neighbor: {#BGP_NEIGHBOR} Routes Received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.15.3.1.10.{#BGP_NEIGHBOR}'
              key: 'bgp.neighbor.routes[{#BGP_NEIGHBOR}]'
              delay: 5m
              history: 30d
              trends: 90d
              description: 'Number of routes received from BGP neighbor'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: 'BGP Neighbor'
                  value: '{#BGP_NEIGHBOR}'
                - tag: Component
                  value: BGP
                - tag: InterfaceType
                  value: BGP
              trigger_prototypes:
                - uuid: 3d553dfbef0b4849b4f51e0bc815951b
                  expression: 'last(/Watchguard Firewall/bgp.neighbor.routes[{#BGP_NEIGHBOR}]) < {$WATCHGUARD_BGP_ROUTE_THRESHOLD_CRITICAL:10}'
                  name: 'BGP Neighbor: {#BGP_NEIGHBOR} Route Count Critical'
                  priority: HIGH
                  description: |
                    BGP neighbor {#BGP_NEIGHBOR} has fewer than {$WATCHGUARD_BGP_ROUTE_THRESHOLD_CRITICAL:10} routes.
                    This may indicate: - Routing table corruption - Upstream BGP issues - Route-map misconfigurations - Network partitioning
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: BGP
                    - tag: Condition
                      value: 'Route Loss'
                - uuid: 4e553dfbef0b4849b4f51e0bc815952c
                  expression: 'last(/Watchguard Firewall/bgp.neighbor.routes[{#BGP_NEIGHBOR}]) < {$WATCHGUARD_BGP_ROUTE_THRESHOLD_WARNING:50} and last(/Watchguard Firewall/bgp.neighbor.routes[{#BGP_NEIGHBOR}]) >= {$WATCHGUARD_BGP_ROUTE_THRESHOLD_CRITICAL:10}'
                  name: 'BGP Neighbor: {#BGP_NEIGHBOR} Route Count Low'
                  priority: WARNING
                  description: |
                    BGP neighbor {#BGP_NEIGHBOR} has fewer than {$WATCHGUARD_BGP_ROUTE_THRESHOLD_WARNING:50} routes.
                    Monitor for potential routing issues or upstream changes.
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: BGP
                    - tag: Condition
                      value: 'Route Warning'
            - uuid: 5f553dfbef0b4849b4f51e0bc815953d
              name: 'BGP Neighbor: {#BGP_NEIGHBOR} State'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.15.3.1.2.{#BGP_NEIGHBOR}'
              key: 'bgp.neighbor.state[{#BGP_NEIGHBOR}]'
              delay: 2m
              history: 30d
              trends: 90d
              description: 'BGP neighbor state: 1=idle, 2=connect, 3=active, 4=opensent, 5=openconfirm, 6=established'
              valuemap:
                name: bgp.neighbor.state.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: 'BGP Neighbor'
                  value: '{#BGP_NEIGHBOR}'
                - tag: Component
                  value: BGP
                - tag: InterfaceType
                  value: BGP
              trigger_prototypes:
                - uuid: 60653dfbef0b4849b4f51e0bc815954e
                  expression: '(change(/Watchguard Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}]) > 0 and count(/Watchguard Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}],{$WATCHGUARD_FLAPPING_TIMEFRAME:"30m"}) > {$WATCHGUARD_FLAPPING_CHANGE_THRESHOLD:5})'
                  name: 'BGP Neighbor: {#BGP_NEIGHBOR} Flapping Detected'
                  priority: WARNING
                  description: |
                    BGP neighbor {#BGP_NEIGHBOR} has changed state more than {$WATCHGUARD_FLAPPING_CHANGE_THRESHOLD:5} times in {$WATCHGUARD_FLAPPING_TIMEFRAME:"30m"}.
                    This indicates BGP session instability that can cause: - Route flapping - Convergence delays - Tunnel failover issues - Traffic black-holing
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: BGP
                    - tag: Condition
                      value: Flapping
                - uuid: 71653dfbef0b4849b4f51e0bc815955f
                  expression: 'last(/Watchguard Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}]) <> 6 and nodata(/Watchguard Firewall/bgp.neighbor.state[{#BGP_NEIGHBOR}],{$WATCHGUARD_BGP_NEIGHBOR_TIMEOUT:"10m"}) = 0'
                  name: 'BGP Neighbor: {#BGP_NEIGHBOR} Session Down'
                  priority: HIGH
                  description: |
                    BGP neighbor {#BGP_NEIGHBOR} is not in Established state (6).
                    Current states: 1=idle, 2=connect, 3=active, 4=opensent, 5=openconfirm, 6=established
                    This indicates BGP routing issues that may affect tunnel failover and convergence.
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: BGP
                    - tag: Condition
                      value: 'Session Down'
            - uuid: 82653dfbef0b4849b4f51e0bc8159560
              name: 'BGP Neighbor: {#BGP_NEIGHBOR} Uptime'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.15.3.1.16.{#BGP_NEIGHBOR}'
              key: 'bgp.neighbor.uptime[{#BGP_NEIGHBOR}]'
              delay: 5m
              history: 30d
              trends: 90d
              units: uptime
              description: 'BGP neighbor session uptime in seconds'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: 'BGP Neighbor'
                  value: '{#BGP_NEIGHBOR}'
                - tag: Component
                  value: BGP
                - tag: InterfaceType
                  value: BGP
          graph_prototypes:
            - uuid: 93653dfbef0b4849b4f51e0bc8159571
              name: 'BGP Neighbor: {#BGP_NEIGHBOR} Routes Received'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bgp.neighbor.routes[{#BGP_NEIGHBOR}]'
            - uuid: a4653dfbef0b4849b4f51e0bc8159582
              name: 'BGP Neighbor: {#BGP_NEIGHBOR} State History'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bgp.neighbor.state[{#BGP_NEIGHBOR}]'
        - uuid: fa8bb6e2d1f644cb8c83bb07368d9d0d
          name: 'VPN Tunnels (Route Based) - BoVPNs'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: bovpn.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFDESCR}'
                value: '{$BoVPN_IGNORE_REGEX}'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#IFTYPE}'
                value: ^131$
                formulaid: B
          description: 'Firebox v12.11 firmware resolves the discovery of BoVPN interfaces, that contain a logical Interface (Virtual Tunnel Interface), these are detected as {#IFTYPE=^131}.'
          item_prototypes:
            - uuid: 3825d5cb56b441a7a9d26c9af97c81d4
              name: 'BoVPN: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'bovpn.ifInErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Inbound errors on BoVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: BoVPN
              trigger_prototypes:
                - uuid: cbaaacd3b2144964915fa569fea949bb
                  expression: 'avg(/Watchguard Firewall/bovpn.ifInErrors[{#IFDESCR}],300s) > {$BOVPN_ERROR_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors In'
                  priority: HIGH
                  description: 'Inbound errors on BoVPN {#IFDESCR} exceeded critical threshold ({ITEM.LASTVALUE} > {$BOVPN_ERROR_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
                - uuid: 10651d67459a40adb0466aec7537e284
                  expression: 'avg(/Watchguard Firewall/bovpn.ifInErrors[{#IFDESCR}],300s) > {$BOVPN_WARNING_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors In'
                  priority: WARNING
                  description: 'Inbound errors on BoVPN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$BOVPN_WARNING_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
            - uuid: 4a5b0b9e96574bba8ad34e9bb9721d98
              name: 'BoVPN: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'bovpn.ifInOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Incoming traffic on boVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: BoVPN
            - uuid: f750d8e05ca54716ad71706ddceade21
              name: 'BoVPN: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'bovpn.ifOperStatus[{#IFDESCR}]'
              history: 30d
              description: 'Operational status of BoVPN {#IFDESCR}'
              valuemap:
                name: interface.status.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: BoVPN
              trigger_prototypes:
                - uuid: 9ce65072570a4ddf823a63e1ccd86298
                  expression: 'last(/Watchguard Firewall/bovpn.ifOperStatus[{#IFDESCR}],#1)<>last(/Watchguard Firewall/bovpn.ifOperStatus[{#IFDESCR}],#5:now-5m)=1'
                  name: 'BoVPN {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: BoVPN
            - uuid: 9eb3a3b320694e8b9b03ee60f7fe35c6
              name: 'BoVPN: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'bovpn.ifOutErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Outbound errors on BoVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: BoVPN
              trigger_prototypes:
                - uuid: 34f1ab6cacf4415aa23c0d8d3cd12d12
                  expression: 'avg(/Watchguard Firewall/bovpn.ifOutErrors[{#IFDESCR}],300s) > {$BOVPN_ERROR_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors Out'
                  priority: HIGH
                  description: 'Outbound errors on BoVPN {#IFDESCR} exceeded critical threshold ({ITEM.LASTVALUE} > {$BOVPN_ERROR_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
                - uuid: 12a75b598cad4476b170b0720064eb1a
                  expression: 'avg(/Watchguard Firewall/bovpn.ifOutErrors[{#IFDESCR}],300s) > {$BOVPN_WARNING_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors Out'
                  priority: WARNING
                  description: 'Outbound errors on BoVPN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$BOVPN_WARNING_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
            - uuid: 2b9d96f7cffc4b06a50f264788a3542f
              name: 'BoVPN: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'bovpn.ifOutOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Outgoing traffic on boVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: BoVPN
          graph_prototypes:
            - uuid: 5a0eb594d92f4ea89047fe130d8bec86
              name: 'BoVPN: {#IFDESCR} Traffic'
              graph_items:
                - color: 00FF00
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: 0080FF
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: CC6600
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifOutErrors[{#IFDESCR}]'
        - uuid: d08266c54b8340dfbe79b7fc198e7135
          name: Processors
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrProcessorLoad]'
          key: cpu.discovery
          delay: 1h
          description: 'Discover the processors of the firewall device'
          item_prototypes:
            - uuid: a14697b5314449cba012621e3233ccbb
              name: 'Processor Utilisation {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrProcessorLoad.{#SNMPINDEX}'
              key: 'hrProcessorLoad[{#SNMPINDEX}]'
              history: 30d
              units: '%'
              description: 'The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: CPU
              trigger_prototypes:
                - uuid: 8d877b6be7de4f35976e80c447681379
                  expression: 'last(/Watchguard Firewall/hrProcessorLoad[{#SNMPINDEX}],#1:now-300s)>{$WATCHGUARD_CPU_HIGH}'
                  name: 'Firebox CPU {#SNMPINDEX} Utilisation over {$WATCHGUARD_CPU_HIGH}%'
                  priority: WARNING
                  description: 'Firebox Master CPU on {HOST.NAME} is over {$WATCHGUARD_CPU_HIGH}%'
                  tags:
                    - tag: Value
                      value: '{ITEM.VALUE}'
                - uuid: 09f704b658ec46ba8787211659adc66c
                  expression: 'last(/Watchguard Firewall/hrProcessorLoad[{#SNMPINDEX}],#1:now-300s)>{$WATCHGUARD_CPU_LOW}'
                  name: 'Firebox CPU {#SNMPINDEX} Utilisation over {$WATCHGUARD_CPU_LOW}%'
                  priority: AVERAGE
                  description: 'Firebox Master CPU on {HOST.NAME} is over {$WATCHGUARD_CPU_LOW}%'
                  manual_close: 'YES'
                  tags:
                    - tag: Value
                      value: '{ITEM.VALUE}'
          graph_prototypes:
            - uuid: e108e4fbf3074c6fb907630bf1a4a090
              name: 'Processor Utilisation{#SNMPINDEX}'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'hrProcessorLoad[{#SNMPINDEX}]'
        - uuid: 4aecb006c90142bea79bfae5a1da5dac
          name: 'Disk Partitions'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrStorageDescr]'
          key: disk.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SNMPVALUE}'
                value: ^(/var|/|/boot|/tmp)$
                formulaid: A
          item_prototypes:
            - uuid: 9ee5bab46a4e4ead913110ab4ff1bbf5
              name: 'Description of storage {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrStorageDescr.{#SNMPINDEX}'
              key: 'hrStorageDescr[{#SNMPVALUE}]'
              delay: 6h
              history: 30d
              value_type: CHAR
              trends: '0'
              description: 'A description of the type and instance of the storage described by this entry.'
              tags:
                - tag: Component
                  value: Disk
            - uuid: d922bb9b39e342ddbf5a515fb89fac07
              name: 'Total disk space on {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrStorageSize.{#SNMPINDEX}'
              key: 'hrStorageSize[{#SNMPVALUE}]'
              delay: 5m
              history: 30d
              units: B
              description: 'total disk space in bytes.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '10240'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Disk
            - uuid: 1d90884e06d040d1924a511e2deae73d
              name: 'Used disk space on {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrStorageUsed.{#SNMPINDEX}'
              key: 'hrStorageUsed[{#SNMPVALUE}]'
              delay: 5m
              history: 30d
              units: B
              description: 'Used disk space in bytes.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '10240'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Disk
          trigger_prototypes:
            - uuid: fc92586b426f452fb52d1651869c3333
              expression: '(last(/Watchguard Firewall/hrStorageUsed[{#SNMPVALUE}]) / last(/Watchguard Firewall/hrStorageSize[{#SNMPVALUE}])) * 100 > {$WATCHGUARD_DISK_LOW}'
              name: 'ALARM: Disk {#SNMPVALUE} utilisation above {$WATCHGUARD_DISK_LOW}%'
              priority: WARNING
            - uuid: 350e4b4d1ab44c39a8ab44646dabb578
              expression: '(last(/Watchguard Firewall/hrStorageUsed[{#SNMPVALUE}]) / last(/Watchguard Firewall/hrStorageSize[{#SNMPVALUE}])) * 100 > {$WATCHGUARD_DISK_HIGH}'
              name: 'WARNING: Disk {#SNMPVALUE} utilisation above {$WATCHGUARD_DISK_HIGH}%'
              priority: HIGH
          graph_prototypes:
            - uuid: 937ac52180a942408ab3fc921532ce33
              name: 'Disk space usage {#SNMPVALUE}'
              width: '600'
              height: '340'
              yaxismax: '0'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'hrStorageSize[{#SNMPVALUE}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'hrStorageUsed[{#SNMPVALUE}]'
        - uuid: 30253dfbef0b4849b4f51e0bc815934a
          name: 'Interfaces (Ethernet)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: ethernet.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFDESCR}'
                value: '.*\..*|.*VLAN.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#IFTYPE}'
                value: ^6$
                formulaid: B
          description: |
            Discover Ethernet interfaces (ifType = 6).
            Filters out VLAN sub-interfaces (containing dots or "VLAN" in name) to focus on physical Ethernet ports. WatchGuard incorrectly reports VLANs as ifType=6 instead of ifType=135, so we use interface naming patterns to differentiate physical interfaces from VLAN sub-interfaces.
          item_prototypes:
            - uuid: 7d1ebdc1c66e45a4b6a8db1bb4b2be1c
              name: 'Interface: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'ethernet.ifInErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Inbound errors on Ethernet interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Ethernet
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 348b07d008854b899f9e94659405877f
                  expression: 'last(/Watchguard Firewall/ethernet.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'Ethernet {#IFDESCR} Inbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Ethernet
                    - tag: Metrics
                      value: Errors
                    - tag: Symptoms
                      value: Config/AllowedVLANTagging/UpstreamTagging
                - uuid: 1b9e2bce98494c6ebb34a9442aede8f6
                  expression: 'last(/Watchguard Firewall/ethernet.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'Ethernet {#IFDESCR} Inbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Ethernet
                    - tag: Metrics
                      value: Errors
                    - tag: Symptoms
                      value: Config/AllowedVLANTagging/UpstreamTagging
            - uuid: 1bbe4491bab148d398ce4868d20fa140
              name: 'Interface: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'ethernet.ifInOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Incoming traffic on Ethernet interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Ethernet
                - tag: Metrics
                  value: Traffic
            - uuid: f750d8e05ca54716ad71706ddceade1e
              name: 'Interface: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'ethernet.ifOperStatus[{#IFDESCR}]'
              history: 30d
              description: 'Operational status of Ethernet interface {#IFDESCR}'
              valuemap:
                name: interface.status.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
              trigger_prototypes:
                - uuid: 9ce65072570a4ddf823a63e1ccd86295
                  expression: '(last(/Watchguard Firewall/ethernet.ifOperStatus[{#IFDESCR}],#1)<>last(/Watchguard Firewall/ethernet.ifOperStatus[{#IFDESCR}],#2))=1'
                  name: 'Ethernet {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: Interface
                      value: Status
                    - tag: InterfaceType
                      value: Ethernet
                    - tag: Symptoms
                      value: Flap/Disconnect/SwitchPort
            - uuid: a460f11b55cf4d21a102846183d4656e
              name: 'Interface: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'ethernet.ifOutErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Outbound errors on Ethernet interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Errors
                - tag: InterfaceType
                  value: Ethernet
              trigger_prototypes:
                - uuid: f89b807cae944a04acf7148e07389325
                  expression: 'last(/Watchguard Firewall/ethernet.ifOutErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'Ethernet {#IFDESCR} Outbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Ethernet
                    - tag: Metrics
                      value: Errors
                    - tag: Symptoms
                      value: Config/AllowedVLANTagging/UpstreamTagging
                - uuid: 77dbcf41ef124a97b5b05b9e2807ccfb
                  expression: 'last(/Watchguard Firewall/ethernet.ifOutErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'Ethernet {#IFDESCR} Outbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Ethernet
                    - tag: Metrics
                      value: Errors
                    - tag: Symptoms
                      value: Config/AllowedVLANTagging/UpstreamTagging
            - uuid: 2b9d96f7cffc4b06a50f264788a3542c
              name: 'Interface: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'ethernet.ifOutOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Outgoing traffic on Ethernet interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Ethernet
                - tag: Metrics
                  value: Traffic
          graph_prototypes:
            - uuid: 3d0f28c28e8149edaaad34aacca27515
              name: 'Ethernet: {#IFDESCR} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'ethernet.ifOperStatus[{#IFDESCR}]'
            - uuid: 441c90eb2707495a8fffb78efc4bdba5
              name: 'Ethernet: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'ethernet.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'ethernet.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'ethernet.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'ethernet.ifOutErrors[{#IFDESCR}]'
        - uuid: 99d69c506b1f41f1816fea394fb29fde
          name: 'Fan Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPINDEX},1.3.6.1.4.1.3097.6.3.2.1.1]'
          key: fan.discovery
          delay: 1h
          status: DISABLED
          filter:
            conditions:
              - macro: '{#FAN_TYPE}'
                value: fan
                formulaid: A
          description: |
            Firebox v12.10 does not expose FAN Index, FAN Speed, or FAN Health metrics over SNMPv2/3. Their published
            MIB pack suggests this should be available. Likely a bug in the firmware.
          item_prototypes:
            - uuid: d7c819753c1949359cfadc15a78e13d1
              name: 'Fan {#FAN_NAME} Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.3.2.1.3.{#SNMPINDEX}'
              key: 'fan.speed[{#FAN_NAME}]'
              delay: 5m
              history: 30d
              value_type: FLOAT
              units: RPM
              description: 'Rotation speed for fan {#FAN_NAME}'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Fan
              trigger_prototypes:
                - uuid: d78a3ac9a76541fcbac5dc278a3a198f
                  expression: 'last(/Watchguard Firewall/fan.speed[{#FAN_NAME}]) < {$WATCHGUARD_FAN_MIN_SPEED}'
                  name: 'Low Fan Speed on {#FAN_NAME}'
                  priority: WARNING
                  description: 'Fan {#FAN_NAME} speed is below minimum threshold ({ITEM.LASTVALUE} < {$WATCHGUARD_FAN_MIN_SPEED} RPM)'
                  tags:
                    - tag: Component
                      value: Fan
            - uuid: d96ba1d905a34d20bd3ff96703b2aa04
              name: 'Fan {#FAN_NAME} Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.3.2.1.4.{#SNMPINDEX}'
              key: 'fan.status[{#FAN_NAME}]'
              delay: 5m
              history: 30d
              value_type: FLOAT
              description: 'Operational status for fan {#FAN_NAME} (0 = normal, 1 = warning, 2 = critical)'
              valuemap:
                name: fan.status.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Fan
                - tag: Fan
                  value: Status
              trigger_prototypes:
                - uuid: 88dbf85421c1499091853fa6d555c0de
                  expression: 'last(/Watchguard Firewall/fan.status[{#FAN_NAME}]) > 0'
                  name: 'Fan {#FAN_NAME} Status Alert'
                  priority: WARNING
                  description: 'Fan {#FAN_NAME} reports non-normal status (Value: {ITEM.LASTVALUE})'
                  tags:
                    - tag: Component
                      value: Fan
                    - tag: Fan
                      value: Status
          graph_prototypes:
            - uuid: a679223d23974611b13d25a26f16980e
              name: 'Fan Speed Trend - {#FAN_NAME}'
              graph_items:
                - color: 0000FF
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fan.speed[{#FAN_NAME}]'
        - uuid: 4e353dfbef0b4849b4f51e0bc815942c
          name: 'Interfaces (Fiber)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: fiber.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFTYPE}'
                value: ^56$
                formulaid: A
          description: |
            Discover fiber optic interfaces (ifType = 56).
            These are dedicated fiber interfaces typically found on higher-end WatchGuard models with SFP/SFP+ ports for high-speed WAN or LAN connections.
          item_prototypes:
            - uuid: 5f353dfbef0b4849b4f51e0bc815943d
              name: 'Fiber: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'fiber.ifInErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Inbound errors on fiber interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Fiber
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 60453dfbef0b4849b4f51e0bc815944e
                  expression: 'last(/Watchguard Firewall/fiber.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'Fiber {#IFDESCR} Inbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Fiber
                    - tag: Metrics
                      value: Errors
                - uuid: 71453dfbef0b4849b4f51e0bc815945f
                  expression: 'last(/Watchguard Firewall/fiber.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'Fiber {#IFDESCR} Inbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Fiber
                    - tag: Metrics
                      value: Errors
            - uuid: 82453dfbef0b4849b4f51e0bc8159460
              name: 'Fiber: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'fiber.ifInOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Incoming traffic on fiber interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Fiber
                - tag: Metrics
                  value: Traffic
            - uuid: 93453dfbef0b4849b4f51e0bc8159471
              name: 'Fiber: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'fiber.ifOperStatus[{#IFDESCR}]'
              history: 30d
              description: 'Operational status of fiber interface {#IFDESCR}'
              valuemap:
                name: interface.status.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Fiber
              trigger_prototypes:
                - uuid: a4453dfbef0b4849b4f51e0bc8159482
                  expression: '(last(/Watchguard Firewall/fiber.ifOperStatus[{#IFDESCR}],#1)<>last(/Watchguard Firewall/fiber.ifOperStatus[{#IFDESCR}],#2))=1'
                  name: 'Fiber {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: Interface
                      value: Status
                    - tag: InterfaceType
                      value: Fiber
            - uuid: b5453dfbef0b4849b4f51e0bc8159493
              name: 'Fiber: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'fiber.ifOutErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Outbound errors on fiber interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Errors
                - tag: InterfaceType
                  value: Fiber
              trigger_prototypes:
                - uuid: c6453dfbef0b4849b4f51e0bc81594a4
                  expression: 'last(/Watchguard Firewall/fiber.ifOutErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'Fiber {#IFDESCR} Outbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Fiber
                    - tag: Metrics
                      value: Errors
                - uuid: d7453dfbef0b4849b4f51e0bc81594b5
                  expression: 'last(/Watchguard Firewall/fiber.ifOutErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'Fiber {#IFDESCR} Outbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: Fiber
                    - tag: Metrics
                      value: Errors
            - uuid: e8453dfbef0b4849b4f51e0bc81594c6
              name: 'Fiber: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'fiber.ifOutOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Outgoing traffic on fiber interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: Fiber
                - tag: Metrics
                  value: Traffic
          graph_prototypes:
            - uuid: f9453dfbef0b4849b4f51e0bc81594d7
              name: 'Fiber: {#IFDESCR} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fiber.ifOperStatus[{#IFDESCR}]'
            - uuid: 0a553dfbef0b4849b4f51e0bc81594e8
              name: 'Fiber: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fiber.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fiber.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fiber.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fiber.ifOutErrors[{#IFDESCR}]'
        - uuid: 8d357e4124b942139b0bec1be7683d9e
          name: 'VPN Tunnels (Policy Based) - GwVPNs'
          type: DEPENDENT
          key: gwvpn.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SUBNETPAIR}'
                value: '{$VPN_POLICY_IGNORE_REGEX}'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          lifetime: 1d
          description: |
            WatchGuard VPN Policy discovery using master SA table approach.
            Discovers stable subnet-pairs from\
                    \ the SA table master item, providing:
            - Stable tunnel identification using CIDR subnet pairs
            - Persistence across\
                    \ tunnel renegotiation/rekey events  
            - Reliable tunnel name retrieval when available
            - Efficient polling with 5m                  \ master item updates
            
            This follows the same proven architecture as SonicWall VPN Policy monitoring.
          item_prototypes:
            - uuid: 80cbecccd49c492183c93cf674032333
              name: 'Gateway VPN: {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] Bytes In'
              type: DEPENDENT
              key: 'vpn.policy.bytesIn[{#SUBNETPAIR}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              description: 'Inbound traffic for VPN policy {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}]'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'var subnetPair = "{#SUBNETPAIR}"; var mapping = JSON.parse(value); if (mapping[subnetPair] && mapping[subnetPair].bytesIn) { return mapping[subnetPair].bytesIn; } return "0"; // Return 0 if not found '
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              master_item:
                key: vpn.policy.sa.table.raw
              tags:
                - tag: Component
                  value: GwVPN
                - tag: 'VPN Name'
                  value: '{#VPNNAME}'
                - tag: 'VPN Subnets'
                  value: '{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}'
                - tag: 'VPN Type'
                  value: 'VPN Policy'
            - uuid: 5b0daab671554cfe8c0a7a796ac84542
              name: 'Gateway VPN: {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] Bytes Out'
              type: DEPENDENT
              key: 'vpn.policy.bytesOut[{#SUBNETPAIR}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              description: 'Outbound traffic for VPN policy {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}]'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'var subnetPair = "{#SUBNETPAIR}"; var mapping = JSON.parse(value); if (mapping[subnetPair] && mapping[subnetPair].bytesOut) { return mapping[subnetPair].bytesOut; } return "0"; // Return 0 if not found '
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              master_item:
                key: vpn.policy.sa.table.raw
              tags:
                - tag: Component
                  value: GwVPN
                - tag: 'VPN Name'
                  value: '{#VPNNAME}'
                - tag: 'VPN Subnets'
                  value: '{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}'
                - tag: 'VPN Type'
                  value: 'VPN Policy'
            - uuid: e6c8bb5a293c4f1ba7b0f6c52ff147c6
              name: 'Gateway VPN: {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] Status'
              type: CALCULATED
              key: 'vpn.policy.status[{#SUBNETPAIR}]'
              history: 7d
              trends: 90d
              params: 'max(/Watchguard Firewall/vpn.policy.bytesIn[{#SUBNETPAIR}],1m)>0 or max(/Watchguard Firewall/vpn.policy.bytesOut[{#SUBNETPAIR}],1m)>0'
              description: 'Active status for VPN policy {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] (1=active, 0=inactive)'
              valuemap:
                name: vpn.status
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: GwVPN
                - tag: 'VPN Name'
                  value: '{#VPNNAME}'
                - tag: 'VPN Subnets'
                  value: '{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}'
                - tag: 'VPN Type'
                  value: 'VPN Policy'
          trigger_prototypes:
            - uuid: ea501e1e0f9a4c62abb872512d507c19
              expression: 'last(/Watchguard Firewall/vpn.policy.status[{#SUBNETPAIR}])=0 and max(/Watchguard Firewall/vpn.policy.bytesIn[{#SUBNETPAIR}],24h)<=1 and max(/Watchguard Firewall/vpn.policy.bytesOut[{#SUBNETPAIR}],24h)<=1'
              name: 'Gateway VPN: {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] Idle for 24 hours'
              priority: WARNING
              description: 'No traffic detected for VPN policy {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] in the last  24 hours'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: GwVPN
                - tag: Condition
                  value: Idle
                - tag: 'VPN Name'
                  value: '{#VPNNAME}'
                - tag: 'VPN Type'
                  value: 'VPN Policy'
          graph_prototypes:
            - uuid: 94c42e99a42f4e9d9392c8aa4e517bfb
              name: 'Gateway VPN: {#VPNNAME} [{#LOCALCIDR}├óΓÇáΓÇ¥{#REMOTECIDR}] Traffic'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              graph_items:
                - color: 00FF00
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vpn.policy.bytesIn[{#SUBNETPAIR}]'
                - sortorder: '1'
                  color: 0080FF
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vpn.policy.bytesOut[{#SUBNETPAIR}]'
          master_item:
            key: vpn.policy.sa.table.raw
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |2
                   var mapping = JSON.parse(value); var discovered = [];
                  for (var key in mapping) { var tunnel = mapping[key]; discovered.push({ "{#SUBNETPAIR}": key, "{#VPNNAME}": tunnel.name || "Unnamed", "{#LOCALCIDR}": tunnel.localCIDR, "{#REMOTECIDR}": tunnel.remoteCIDR, "{#LOCALONE}": tunnel.localStart, "{#LOCALTWO}": tunnel.localEnd, "{#REMOTEONE}": tunnel.remoteStart, "{#REMOTETWO}": tunnel.remoteEnd }); }
                  return JSON.stringify(discovered); 
        - uuid: 0fe9ccfaff514ddc95c8484e0eee14a5
          name: 'Power Supplies'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#PSU_NAME},1.3.6.1.4.1.3097.6.4.2.1.1]'
          key: psu.discovery
          delay: 1h
          status: DISABLED
          description: 'Currently, as of firebox v12.10 firmware, the SNMP OID published in their MIB pack, is NOT exposed over SNMPv2/v3 - suggesting this is a bug in the FW firmware.'
          item_prototypes:
            - uuid: f168009628b849788bea5a086d6f635f
              name: 'Power Supply {#PSU_NAME} Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.4.2.1.2.{#SNMPINDEX}'
              key: 'psu.status[{#PSU_NAME}]'
              history: 30d
              value_type: FLOAT
              valuemap:
                name: psu.status.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: PSU
              trigger_prototypes:
                - uuid: e7994f58fe0f451b90276ffdbc4d19bb
                  expression: 'min(/Watchguard Firewall/psu.status[{#PSU_NAME}],5m)<>1'
                  name: 'Power Supply {#PSU_NAME} Fault Detected'
                  priority: HIGH
                  description: 'Power supply {#PSU_NAME} is reporting a fault or has been disconnected.'
                  tags:
                    - tag: Component
                      value: Power
        - uuid: 36f6c341b9af4ccb9641fc003968f837
          name: 'Temperature Sensors'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.1
          key: temp.discovery
          delay: 1h
          status: DISABLED
          filter:
            conditions:
              - macro: '{#SENSOR_TYPE}'
                value: temperature
                formulaid: A
          description: 'Currently, as of firebox v12.10 firmware, the SNMP OID published in their MIB pack, is NOT exposed over SNMPv2/v3 - suggesting this is a bug in the FW firmware.'
          item_prototypes:
            - uuid: 6bbe24e86cca4734b9435ded3b63a957
              name: 'Temperature Sensor {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.3.1.{#SNMPINDEX}'
              key: 'temperature.sensor[{#SENSOR_NAME}]'
              delay: 5m
              history: 30d
              value_type: FLOAT
              units: ├é┬░C
              description: 'Temperature reading from {#SENSOR_NAME} sensor'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Temp
              trigger_prototypes:
                - uuid: b86cb876da87465f8ccc9b7bbf9141d1
                  expression: 'last(/Watchguard Firewall/temperature.sensor[{#SENSOR_NAME}]) > {$WATCHGUARD_TEMP_CRITICAL}'
                  name: 'Critical Temperature on {#SENSOR_NAME}'
                  priority: HIGH
                  description: 'Temperature sensor {#SENSOR_NAME} is above critical threshold ({ITEM.LASTVALUE} > {$WATCHGUARD_TEMP_CRITICAL}├é ┬░C)'
                  tags:
                    - tag: Component
                      value: Temperature
                - uuid: dc6ffe6c7e1f47c48f691e3494a7d8d5
                  expression: 'last(/Watchguard Firewall/temperature.sensor[{#SENSOR_NAME}]) > {$WATCHGUARD_TEMP_WARNING}'
                  name: 'High Temperature Warning on {#SENSOR_NAME}'
                  priority: WARNING
                  description: 'Temperature sensor {#SENSOR_NAME} is above warning threshold ({ITEM.LASTVALUE} > {$WATCHGUARD_TEMP_WARNING}├é ┬░C)'
                  tags:
                    - tag: Component
                      value: Temperature
          graph_prototypes:
            - uuid: cf89c10b5d2b46ccb24cc4a6d6067852
              name: 'Temperature Trend - {#SENSOR_NAME}'
              graph_items:
                - color: FF0000
                  item:
                    host: 'Watchguard Firewall'
                    key: 'temperature.sensor[{#SENSOR_NAME}]'
        - uuid: 31253dfbef0b4849b4f51e0bc815935b
          name: 'Interfaces (VLAN)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: vlan.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFDESCR}'
                value: '.*\\..*|.*VLAN.*'
                formulaid: A
              - macro: '{#IFTYPE}'
                value: ^6$
                formulaid: B
          description: |
            Discover VLAN sub-interfaces (ifType = 6 with naming patterns).
            WatchGuard incorrectly reports VLANs as ifType=6 instead of ifType=135. This discovery rule identifies VLAN interfaces by looking for naming patterns containing dots (sub-interfaces) or "VLAN" in the interface description.
          item_prototypes:
            - uuid: 82253dfbef0b4849b4f51e0bc815936c
              name: 'VLAN: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vlan.ifInErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Inbound errors on VLAN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: VLAN
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 93253dfbef0b4849b4f51e0bc815937d
                  expression: 'last(/Watchguard Firewall/vlan.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'VLAN {#IFDESCR} Inbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: VLAN
                    - tag: Metrics
                      value: Errors
                - uuid: a4253dfbef0b4849b4f51e0bc815938e
                  expression: 'last(/Watchguard Firewall/vlan.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'VLAN {#IFDESCR} Inbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: VLAN
                    - tag: Metrics
                      value: Errors
            - uuid: b5253dfbef0b4849b4f51e0bc815939f
              name: 'VLAN: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'vlan.ifInOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Incoming traffic on VLAN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: VLAN
                - tag: Metrics
                  value: Traffic
            - uuid: c6253dfbef0b4849b4f51e0bc81593a0
              name: 'VLAN: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'vlan.ifOperStatus[{#IFDESCR}]'
              history: 30d
              description: 'Operational status of VLAN interface {#IFDESCR}'
              valuemap:
                name: interface.status.valuemap
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: VLAN
              trigger_prototypes:
                - uuid: d7253dfbef0b4849b4f51e0bc81593b1
                  expression: '(last(/Watchguard Firewall/vlan.ifOperStatus[{#IFDESCR}],#1)<>last(/Watchguard Firewall/vlan.ifOperStatus[{#IFDESCR}],#2))=1'
                  name: 'VLAN {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: Interface
                      value: Status
                    - tag: InterfaceType
                      value: VLAN
            - uuid: e8253dfbef0b4849b4f51e0bc81593c2
              name: 'VLAN: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vlan.ifOutErrors[{#IFDESCR}]'
              delay: 2m
              history: 30d
              description: 'Outbound errors on VLAN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Errors
                - tag: InterfaceType
                  value: VLAN
              trigger_prototypes:
                - uuid: f9253dfbef0b4849b4f51e0bc81593d3
                  expression: 'last(/Watchguard Firewall/vlan.ifOutErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'VLAN {#IFDESCR} Outbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: VLAN
                    - tag: Metrics
                      value: Errors
                - uuid: 0a353dfbef0b4849b4f51e0bc81593e4
                  expression: 'last(/Watchguard Firewall/vlan.ifOutErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'VLAN {#IFDESCR} Outbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Component
                      value: Interface
                    - tag: InterfaceType
                      value: VLAN
                    - tag: Metrics
                      value: Errors
            - uuid: 1b353dfbef0b4849b4f51e0bc81593f5
              name: 'VLAN: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'vlan.ifOutOctets[{#IFDESCR}]'
              history: 30d
              units: Bps
              description: 'Outgoing traffic on VLAN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
              tags:
                - tag: Component
                  value: Interface
                - tag: InterfaceType
                  value: VLAN
                - tag: Metrics
                  value: Traffic
          graph_prototypes:
            - uuid: 2c353dfbef0b4849b4f51e0bc815940a
              name: 'VLAN: {#IFDESCR} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vlan.ifOperStatus[{#IFDESCR}]'
            - uuid: 3d353dfbef0b4849b4f51e0bc815941b
              name: 'VLAN: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vlan.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vlan.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vlan.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'vlan.ifOutErrors[{#IFDESCR}]'
      tags:
        - tag: Author
          value: 'Simon Jackson'
        - tag: Vendor
          value: Watchguard
      macros:
        - macro: '{$BOVPN_ERROR_THRESHOLD}'
          value: '10'
          description: 'Threshold for BoVPN tunnel input/output errors triggering a critical-level alert.'
        - macro: '{$BOVPN_IGNORE_REGEX}'
          value: '^(?i:BACKEND|TEST|MONITORING).*'
          description: 'Regex to exclude BoVPN tunnels from discovery or alerting based on name.'
        - macro: '{$BOVPN_WARNING_THRESHOLD}'
          value: '1'
          description: 'Threshold for BoVPN tunnel input/output errors triggering a warning-level alert.'
        - macro: '{$GWVPN_ERROR_THRESHOLD}'
          value: '1000000'
          description: 'Threshold in bits per second for gateway VPN traffic triggering an error-level alert.'
        - macro: '{$GWVPN_IGNORE_REGEX}'
          value: '^(?i:*172.16.8.2*|*192.168.1.[6|8]*'
          description: 'Regex to exclude gateway VPN tunnels from triggers based on remote IP/subnet patterns.'
        - macro: '{$GWVPN_WARNING_THRESHOLD}'
          value: '100000'
          description: 'Threshold in bits per second for gateway VPN traffic triggering a warning-level alert.'
        - macro: '{$VPN_POLICY_ERROR_THRESHOLD}'
          value: '10'
          description: 'Threshold for VPN policy tunnel errors triggering a critical-level alert.'
        - macro: '{$VPN_POLICY_IGNORE_REGEX}'
          value: '^(?i:TEST|MONITORING|BACKEND).*'
          description: 'Regex to exclude VPN policy tunnels from discovery based on tunnel name patterns.'
        - macro: '{$VPN_POLICY_WARNING_THRESHOLD}'
          value: '1'
          description: 'Threshold for VPN policy tunnel errors triggering a warning-level alert.'
        - macro: '{$WATCHGUARD_CACHED_THRESHOLD}'
          value: '99'
          description: 'Threshold for memory cache utilisation percentage before alerting.'
        - macro: '{$WATCHGUARD_CLUSTER_HEALTH_PERCENT}'
          value: '90'
          description: 'Minimum expected FireCluster sync health percentage.'
        - macro: '{$WATCHGUARD_CPU_HIGH}'
          value: '90'
          description: 'CPU usage (%) threshold for critical alert.'
        - macro: '{$WATCHGUARD_CPU_LOW}'
          value: '70'
          description: 'CPU usage (%) threshold for warning alert.'
        - macro: '{$WATCHGUARD_DISK_HIGH}'
          value: '90'
          description: 'Disk usage (%) threshold for critical alert.'
        - macro: '{$WATCHGUARD_DISK_LOW}'
          value: '80'
          description: 'Disk usage (%) threshold for warning alert.'
        - macro: '{$WATCHGUARD_FAN_MIN_SPEED}'
          value: '2000'
          description: 'Minimum expected fan speed (RPM) before triggering an alert.'
        - macro: '{$WATCHGUARD_HIGH_THROUGHPUT}'
          value: '1000000000'
          description: 'Threshold in bits per second used to detect high-throughput interfaces or VPNs.'
        - macro: '{$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
          value: '1000'
          description: 'Threshold for interface errors that triggers a critical alert.'
        - macro: '{$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
          value: '100'
          description: 'Threshold for interface errors that triggers a warning alert.'
        - macro: '{$WATCHGUARD_MAX_CONNECTIONS}'
          value: '50000'
          description: 'Maximum allowed concurrent connections before triggering an alert.'
        - macro: '{$WATCHGUARD_SWAP_THRESHOLD}'
          value: '99'
          description: 'Swap usage (%) threshold before triggering a critical alert.'
        - macro: '{$WATCHGUARD_TEMP_CRITICAL}'
          value: '70'
          description: 'Temperature (├é┬░C) threshold for critical alert.'
        - macro: '{$WATCHGUARD_TEMP_WARNING}'
          value: '60'
          description: 'Temperature (├é┬░C) threshold for warning alert.'
      dashboards:
        - uuid: e056d7d058ee45309c64875fb4bfd5e1
          name: 'Watchguard Firebox'
          pages:
            - name: Cluster
              widgets:
                - type: problemsbysv
                  width: '30'
                  height: '1'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: reference
                      value: GZKAM
                    - type: INTEGER
                      name: show_timeline
                      value: '0'
                - type: honeycomb
                  name: 'Important Info'
                  'y': '1'
                  width: '30'
                  height: '3'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Cluster Synchronisation Status'
                    - type: STRING
                      name: items.1
                      value: 'Device Firmware'
                    - type: STRING
                      name: items.2
                      value: 'GAV Update'
                    - type: STRING
                      name: items.3
                      value: 'IPS Update'
                    - type: STRING
                      name: items.4
                      value: 'LiveSecurity Expires'
                    - type: STRING
                      name: items.5
                      value: 'Device Uptime'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: ZTIWL
                - type: svggraph
                  name: Traffic
                  'y': '4'
                  width: '45'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '0'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Traffic: Inbound'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '0'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Traffic: Outbound'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: CIYCM
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: item
                  name: 'Connection Rate'
                  x: '30'
                  width: '8'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Watchguard Firewall'
                        key: connections.rate
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: /s
                - type: item
                  name: 'Active Connections'
                  x: '30'
                  'y': '2'
                  width: '8'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Watchguard Firewall'
                        key: connections.active
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                - type: honeycomb
                  name: 'FireCluster Roles'
                  x: '38'
                  width: '7'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'FireCluster * Member Role'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: HA
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^FireCluster (Primary|Secondary) Member Role$", "\1")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: FUODG
                    - type: STRING
                      name: secondary_label_color
                      value: '666699'
                    - type: INTEGER
                      name: secondary_label_size
                      value: '36'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFE082
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
                - type: svggraph
                  name: 'FireCluster Health'
                  x: '45'
                  width: '22'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FFBF
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'FireCluster Primary Member * Health'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 00BFFF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'FireCluster Secondary Member * Health'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '6'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: GWZXM
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: gauge
                  x: '45'
                  'y': '4'
                  width: '14'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Watchguard Firewall'
                        key: watchguard.system.cpu.util
                    - type: STRING
                      name: max
                      value: '100'
                    - type: STRING
                      name: min
                      value: '0'
            - name: Interfaces
              widgets:
                - type: honeycomb
                  name: 'Interface Status'
                  width: '15'
                  height: '14'
                  fields:
                    - type: INTEGER
                      name: evaltype_item
                      value: '2'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: Interface
                    - type: INTEGER
                      name: item_tags.1.operator
                      value: '0'
                    - type: STRING
                      name: item_tags.1.tag
                      value: InterfaceType
                    - type: STRING
                      name: item_tags.1.value
                      value: 'Ethernet,Fiber'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^(Ethernet|Fiber): (.+) Status$", "\2")}}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: LDBGC
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                - type: graphprototype
                  name: 'Ethernet: Traffic'
                  x: '15'
                  width: '48'
                  height: '7'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Watchguard Firewall'
                        name: 'Ethernet: {#IFDESCR} Traffic'
                    - type: STRING
                      name: reference
                      value: RAKFC
                - type: graphprototype
                  name: 'Fiber: Traffic'
                  x: '15'
                  'y': '7'
                  width: '48'
                  height: '7'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Watchguard Firewall'
                        name: 'Fiber: {#IFDESCR} Traffic'
                    - type: STRING
                      name: reference
                      value: EKVFJ
            - name: VLANs
              widgets:
                - type: honeycomb
                  name: VLANStatus
                  width: '15'
                  height: '14'
                  fields:
                    - type: INTEGER
                      name: evaltype_item
                      value: '2'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: Interface
                    - type: INTEGER
                      name: item_tags.1.operator
                      value: '0'
                    - type: STRING
                      name: item_tags.1.tag
                      value: InterfaceType
                    - type: STRING
                      name: item_tags.1.value
                      value: VLAN
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^VLAN: (.+) Status$", "\2")}}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: ZXCXQ
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                - type: graphprototype
                  name: 'VLAN: Traffic'
                  x: '15'
                  width: '48'
                  height: '14'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Watchguard Firewall'
                        name: 'VLAN: {#IFDESCR} Traffic'
                    - type: STRING
                      name: reference
                      value: YZFUI
                    - type: INTEGER
                      name: rows
                      value: '2'
            - name: BGP
              widgets:
                - type: honeycomb
                  name: 'BGP Neighbor States'
                  width: '14'
                  height: '6'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'BGP Neighbor: * State'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '0'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: BGP
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^BGP Neighbor: (.+) State$", "\1")}'
                    - type: STRING
                      name: reference
                      value: RQVRY
                    - type: STRING
                      name: thresholds.0.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFD54F
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '4'
                    - type: STRING
                      name: thresholds.2.color
                      value: 0EC9AC
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '6'
                - type: problems
                  'y': '6'
                  width: '49'
                  height: '6'
                  fields:
                    - type: STRING
                      name: reference
                      value: PLXAK
                    - type: INTEGER
                      name: show_tags
                      value: '2'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: Component
                    - type: STRING
                      name: tags.0.value
                      value: BGP
                - type: gauge
                  name: 'Session Uptime %'
                  x: '14'
                  width: '11'
                  height: '6'
                  fields:
                    - type: STRING
                      name: itemid._reference
                      value: RQVRY._itemid
                    - type: STRING
                      name: max
                      value: '604800'
                    - type: STRING
                      name: min
                      value: '0'
                - type: item
                  name: 'BGP Neighbors'
                  x: '25'
                  width: '12'
                  fields:
                    - type: STRING
                      name: itemid._reference
                      value: RQVRY._itemid
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: states
                - type: item
                  name: 'BGP Neighbors'
                  x: '25'
                  'y': '2'
                  width: '12'
                  fields:
                    - type: STRING
                      name: itemid._reference
                      value: RQVRY._itemid
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: states
                - type: item
                  name: 'BGP Session Uptime'
                  x: '25'
                  'y': '4'
                  width: '12'
                  fields:
                    - type: STRING
                      name: itemid._reference
                      value: RQVRY._itemid
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: states
                - type: problems
                  name: 'BGP Flapping Detection'
                  x: '37'
                  width: '12'
                  fields:
                    - type: STRING
                      name: problem
                      value: Flapping
                    - type: STRING
                      name: reference
                      value: IMEVV
                    - type: INTEGER
                      name: show_tags
                      value: '2'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: Component
                    - type: STRING
                      name: tags.0.value
                      value: BGP
                - type: item
                  name: 'BGP Update Messages'
                  x: '37'
                  'y': '2'
                  width: '12'
                  fields:
                    - type: STRING
                      name: itemid._reference
                      value: RQVRY._itemid
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: states
                - type: item
                  name: 'Total Messages'
                  x: '37'
                  'y': '4'
                  width: '12'
                  fields:
                    - type: STRING
                      name: itemid._reference
                      value: RQVRY._itemid
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: states
            - name: 'Branch Office VPNs'
              widgets:
                - type: honeycomb
                  name: 'BoVPN Statuses'
                  width: '21'
                  height: '14'
                  fields:
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: BoVPN
                    - type: INTEGER
                      name: maintenance
                      value: '1'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^BoVPN: (.+) Status$", "\1")}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: INTEGER
                      name: primary_label_size
                      value: '50'
                    - type: STRING
                      name: reference
                      value: JWFEG
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                - type: svggraph
                  name: 'BoVPN: Bytes In/Out'
                  x: '21'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'BoVPN: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 0080FF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'BoVPN: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: STRING
                      name: reference
                      value: TJAWZ
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'BoVPN: Errors In/Out'
                  x: '21'
                  'y': '5'
                  width: '51'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF8000
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'BoVPN: * Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.0.type
                      value: '2'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: ds.1.color
                      value: FF0000
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'BoVPN: * Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.1.type
                      value: '2'
                    - type: INTEGER
                      name: ds.1.width
                      value: '2'
                    - type: INTEGER
                      name: legend
                      value: '0'
                    - type: STRING
                      name: reference
                      value: JAFCO
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: problems
                  name: 'BoVPN: Problems'
                  x: '21'
                  'y': '9'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: problem
                      value: Errors
                    - type: STRING
                      name: reference
                      value: FRTVH
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '1'
                    - type: STRING
                      name: tags.0.tag
                      value: Component
                    - type: STRING
                      name: tags.0.value
                      value: BoVPN
            - name: 'Gateway VPNs'
              widgets:
                - type: honeycomb
                  name: 'GwVPN Tunnels (unsupported)'
                  width: '21'
                  height: '14'
                  fields:
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: GwVPN
                    - type: INTEGER
                      name: maintenance
                      value: '1'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^GwVPN: (.+) Status$", "\1")}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: INTEGER
                      name: primary_label_size
                      value: '50'
                    - type: STRING
                      name: reference
                      value: GBEEE
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                - type: svggraph
                  name: 'GwVPN Bytes In/Out'
                  x: '21'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'GwVPN * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 0080FF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'GwVPN * Bytes In'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: STRING
                      name: reference
                      value: NSARR
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'GwVPN: Errors In/Out'
                  x: '21'
                  'y': '5'
                  width: '51'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF0000
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'GwVPN * Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.0.type
                      value: '2'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: ds.1.color
                      value: CC6600
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'GwVPN * Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.1.type
                      value: '2'
                    - type: INTEGER
                      name: ds.1.width
                      value: '2'
                    - type: INTEGER
                      name: legend
                      value: '0'
                    - type: STRING
                      name: reference
                      value: LCHQX
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: problems
                  name: 'GwVPN: Problems'
                  x: '21'
                  'y': '9'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: problem
                      value: Errors
                    - type: STRING
                      name: reference
                      value: YIALR
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '1'
                    - type: STRING
                      name: tags.0.tag
                      value: Component
                    - type: STRING
                      name: tags.0.value
                      value: GwVPN
      valuemaps:
        - uuid: b5653dfbef0b4849b4f51e0bc8159593
          name: bgp.neighbor.state.valuemap
          mappings:
            - value: '1'
              newvalue: Idle
            - value: '2'
              newvalue: Connect
            - value: '3'
              newvalue: Active
            - value: '4'
              newvalue: OpenSent
            - value: '5'
              newvalue: OpenConfirm
            - value: '6'
              newvalue: Established
        - uuid: 71a060a54ea2489b9997531e0de28103
          name: cluster.status.valuemap
          mappings:
            - value: '0'
              newvalue: N/A
            - value: '1'
              newvalue: Clustered
            - value: '2'
              newvalue: Standalone
        - uuid: bbe748f3a1a7405ab4c1e49d4e4eb75f
          name: cluster.sync.valuemap
          mappings:
            - value: '0'
              newvalue: 'Not Synchronised'
            - value: '1'
              newvalue: Synchronised
        - uuid: cddcb4c626d641759b26f30d7c8d129b
          name: fan.status.valuemap
          mappings:
            - value: '1'
              newvalue: OK
            - value: '2'
              newvalue: Fault
            - value: '3'
              newvalue: 'Not Present'
        - uuid: ba5c23563caa4ec1aaf4657ccb304f23
          name: feature.status.valuemap
          mappings:
            - value: '0'
              newvalue: Disabled
            - value: '1'
              newvalue: Enabled
        - uuid: 839e718ef97f40659f422cf5f603b17b
          name: interface.status.valuemap
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
            - value: '4'
              newvalue: Unknown
            - value: '5'
              newvalue: Dormant
            - value: '6'
              newvalue: 'Not Present'
            - value: '7'
              newvalue: 'Lower Layer Down'
        - uuid: e75ad32d175e4bc882730f78a60ae7f6
          name: member.role.valuemap
          mappings:
            - value: '1'
              newvalue: Rebooting
            - value: '2'
              newvalue: Standby
            - value: '3'
              newvalue: Master
        - uuid: 1ee381ecbce64a3eb2c75d9e4205954d
          name: psu.status.valuemap
          mappings:
            - value: '1'
              newvalue: OK
            - value: '2'
              newvalue: Fault
            - value: '3'
              newvalue: 'Not Present'
        - uuid: aea608b253de4ba3a5a1366a370d646e
          name: vpn.status
          mappings:
            - value: '0'
              newvalue: Inactive
            - value: '1'
              newvalue: Active
        - uuid: 5f8e92a4d7c149b8a6e3f5c2b1d4e7a9
          name: 'VPN Status'
          mappings:
            - value: '0'
              newvalue: Inactive
            - value: '1'
              newvalue: Active
