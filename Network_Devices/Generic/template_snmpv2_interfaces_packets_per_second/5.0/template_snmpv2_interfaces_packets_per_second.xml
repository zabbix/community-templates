<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:54:03Z</date><groups><group><name>Templates</name></group></groups><templates><template><template>SNMPv2 Interfaces packets per second</template><name>SNMPv2 Interfaces packets per second</name><description>## Description

Template adds items for measuring switchport unicast, broadcast and multicast packets per second.

## Overview

Template SNMPv2 Interfaces packets per second


Discover interfaces and creates items for inbound and outbound unicast packets, multicast packets, and broadcast packets.


Creates trigger to warining about high input broadcast. Can be adjusted WARNING\_BROADCAST\_PPS


 



## Author

Kari Karvonen

</description><groups><group><name>Templates</name></group></groups><applications><application><name>Interfaces pps</name></application></applications><discovery_rules><discovery_rule><name>Network interfaces pps</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid><key>net.discover.pps</key><delay>1h</delay><filter><conditions><condition><macro>{#IFADMINSTATUS}</macro><value>(1|3)</value><formulaid>A</formulaid></condition><condition><macro>{#IFOPERSTATUS}</macro><value>(1|2|3|4|5|7)</value><formulaid>B</formulaid></condition></conditions></filter><description>You may also consider using IF-MIB::ifType or IF-MIB::ifAlias for discovery depending on your filtering needs.</description><item_prototypes><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Inbound broadcast rate</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCInBroadcastPkts.{#SNMPINDEX}</snmp_oid><key>ifHCInBroadcastPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><description>The number of received broadcast packets per second</description><applications><application><name>Interfaces pps</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step></preprocessing><trigger_prototypes><trigger_prototype><expression>{avg(1)}&gt;={$WARNING_BROADCAST_PPS}</expression><name>Interface Interface {#IFNAME}({#IFALIAS}): high Inbound brodcast rate</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Inbound multicast rate</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCInMulticastPkts.{#SNMPINDEX}</snmp_oid><key>ifHCInMulticastPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><description>The number of received multicast packets per second</description><applications><application><name>Interfaces pps</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step></preprocessing></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Inbound total rate</name><type>CALCULATED</type><key>ifHCInTotalPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><params>last(&quot;ifHCInUcastPkts[{#IFNAME}]&quot;,0)+last(&quot;ifHCInMulticastPkts[{#IFNAME}]&quot;,0)+last(&quot;ifHCInBroadcastPkts[{#IFNAME}]&quot;,0)</params><applications><application><name>Interfaces pps</name></application></applications></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Inbound unicast rate</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCInUcastPkts.{#SNMPINDEX}</snmp_oid><key>ifHCInUcastPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><description>The number of received unicast packets per second</description><applications><application><name>Interfaces pps</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step></preprocessing><request_method>POST</request_method></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Outbound broadcast rate</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCOutBroadcastPkts.{#SNMPINDEX}</snmp_oid><key>ifHCOutBroadcastPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><description>The number of outgoing broadcast packets per second</description><applications><application><name>Interfaces pps</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step></preprocessing></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Outbound multicast rate</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCOutMulticastPkts.{#SNMPINDEX}</snmp_oid><key>ifHCOutMulticastPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><description>The number of outgoing multicast packets per second</description><applications><application><name>Interfaces pps</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step></preprocessing></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Outbound total rate</name><type>CALCULATED</type><key>ifHCOutTotalPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><params>last(&quot;ifHCOutUcastPkts[{#IFNAME}]&quot;,0)+last(&quot;ifHCOutMulticastPkts[{#IFNAME}]&quot;,0)+last(&quot;ifHCOutBroadcastPkts[{#IFNAME}]&quot;,0)</params><applications><application><name>Interfaces pps</name></application></applications></item_prototype><item_prototype><name>Interface {#IFNAME}({#IFALIAS}): Outbound unicast rate</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCOutUcastPkts.{#SNMPINDEX}</snmp_oid><key>ifHCOutUcastPkts[{#IFNAME}]</key><history>1w</history><units>pps</units><description>The number of outgoing unicast packets per second</description><applications><application><name>Interfaces pps</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step></preprocessing><request_method>POST</request_method></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>Interface {#IFNAME}({#IFALIAS}): Inbound packet rate</name><height>400</height><type>STACKED</type><ymin_type_1>FIXED</ymin_type_1><graph_items><graph_item><color>199C0D</color><item><host>SNMPv2 Interfaces packets per second</host><key>ifHCInUcastPkts[{#IFNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>F63100</color><item><host>SNMPv2 Interfaces packets per second</host><key>ifHCInMulticastPkts[{#IFNAME}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>2774A4</color><item><host>SNMPv2 Interfaces packets per second</host><key>ifHCInBroadcastPkts[{#IFNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><name>Interface {#IFNAME}({#IFALIAS}): Outbound packet rate on interface</name><height>400</height><type>STACKED</type><ymin_type_1>FIXED</ymin_type_1><graph_items><graph_item><color>F7941D</color><item><host>SNMPv2 Interfaces packets per second</host><key>ifHCOutUcastPkts[{#IFNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>FC6EA3</color><item><host>SNMPv2 Interfaces packets per second</host><key>ifHCOutMulticastPkts[{#IFNAME}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>6C59DC</color><item><host>SNMPv2 Interfaces packets per second</host><key>ifHCOutBroadcastPkts[{#IFNAME}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><request_method>POST</request_method></discovery_rule></discovery_rules><macros><macro><macro>{$WARNING_BROADCAST_PPS}</macro><value>10</value><description>pps to trigger warning</description></macro></macros></template></templates></zabbix_export>
