{
    "zabbix_export": {
        "version": "7.0",
        "template_groups": [
            {
                "uuid": "36bff6c29af64692839d077febfc7079",
                "name": "Templates/Network devices"
            }
        ],
        "templates": [
            {
                "uuid": "81c83de6990f4ca693b38df46a2b26a1",
                "template": "Template Aruba ClearPass by HTTP",
                "name": "Template Aruba ClearPass by HTTP",
                "description": "This template expects an API user with \"client_secret\" as the authentication method.\n\nThe following macros are mandatory:\n\n{$CPPM_API_CLIENT}\n{$CPPM_API_FQDN}\n{$CPPM_API_SECRET}\n\nPlease take care to set the discovery interval below the authentication time for the API Client user.",
                "groups": [
                    {
                        "name": "Templates/Network devices"
                    }
                ],
                "discovery_rules": [
                    {
                        "uuid": "eea3cf10c34d4233b897f911d06339c2",
                        "name": "CPPM token discovery",
                        "type": "HTTP_AGENT",
                        "key": "cppm.certificates.discovery.token",
                        "delay": "{$CPPM_DISCOVERY_UPDATE_INTERVAL}",
                        "lifetime": "30d",
                        "enabled_lifetime_type": "DISABLE_NEVER",
                        "description": "This discovery rule doesn't do a lot of discovering.\n\nIt's main use is logging in to the API, retrieving the OAUTH \"Bearer\" token and updating the data retrieval item's authorization header with this token.\n\nThe update interval should be below the API client login expiry ( which is 8 hours by default).\n\nThis template expects an API user with \"client_secret\" as the authentication method.",
                        "item_prototypes": [
                            {
                                "uuid": "4a17bd6b568c421f910706fc82d02c31",
                                "name": "CPPM HTTPS_ECC certificate expiry",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.expiry[https_ecc,{#DUMMY}]",
                                "delay": "0",
                                "units": "s",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'HTTPS(ECC)')].expiry_date"
                                        ]
                                    },
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "/*\nThis script converts the certificate expiry date to the number\nof seconds left before expiry.\n\nSteps:\n* Convert date/time string to ISO 8601, discard the timezone.\n* Parse the converted date/time.\n* Substract the current date/time from the expiry date/time and.\n* Convert the differrence from milliseconds to seconds.\n*/\n\n// Pad a number with a leading zero if < 10.\nfunction pad(n) {\n    return (n < 10) ? (\"0\" + n) : n;\n}\n\n// Convert month name to month number.\nfunction month_to_number(month) {\n  return('January___February__March_____April_____May_______June______July______August____September_October___November__December__'.indexOf(month) / 10 + 1)\n}\n\n// Extract date/time from a string in the format: [\"Jul 29, 2025 10:23:34 CEST\"].\n// We'll ignore the timezone.\nparsed = value.match(/^\\[\"(\\w+)\\s+(\\d+),\\s+(\\d+)\\s+(\\d\\d:\\d\\d:\\d\\d)/);\n\nyyyy = parsed[3];\nmm = pad(month_to_number(parsed[1]));\ndd = parsed[2];\nhhhhhh = parsed[4];\n\n// Construct ISO 8601 datetime format.\niso_date = yyyy + \"-\" + mm + \"-\" + dd + \"T\" + hhhhhh\n\n// Current date/time.\nnow = new Date()\n// Substract current date/time from expiry and divide by 1000.\ndiff = parseInt((Date.parse(iso_date)-now.getTime()) / 1000)\n\nreturn(diff);"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "43f900df5c6c4c88883cd19f6d8678b8",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[https_ecc,{#DUMMY}])<{$CPPM_CERT_EXPIRY_1}",
                                        "name": "CPPM HTTPS_ECC certificate will expire within {$CPPM_CERT_EXPIRY_1}",
                                        "priority": "AVERAGE"
                                    },
                                    {
                                        "uuid": "efe0ca750ba24e7d957ce3f0c402f60d",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[https_ecc,{#DUMMY}])<{$CPPM_CERT_EXPIRY_2}",
                                        "name": "CPPM HTTPS_ECC certificate will expire within {$CPPM_CERT_EXPIRY_2}",
                                        "priority": "HIGH"
                                    }
                                ]
                            },
                            {
                                "uuid": "f5a1cbc302d840abb0c17bafbca83c08",
                                "name": "CPPM HTTPS_RSA certificate expiry",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.expiry[https_rsa,{#DUMMY}]",
                                "delay": "0",
                                "units": "s",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'HTTPS(RSA)')].expiry_date"
                                        ]
                                    },
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "/*\nThis script converts the certificate expiry date to the number\nof seconds left before expiry.\n\nSteps:\n* Convert date/time string to ISO 8601, discard the timezone.\n* Parse the converted date/time.\n* Substract the current date/time from the expiry date/time and.\n* Convert the differrence from milliseconds to seconds.\n*/\n\n// Pad a number with a leading zero if < 10.\nfunction pad(n) {\n    return (n < 10) ? (\"0\" + n) : n;\n}\n\n// Convert month name to month number.\nfunction month_to_number(month) {\n  return('January___February__March_____April_____May_______June______July______August____September_October___November__December__'.indexOf(month) / 10 + 1)\n}\n\n// Extract date/time from a string in the format: [\"Jul 29, 2025 10:23:34 CEST\"].\n// We'll ignore the timezone.\nparsed = value.match(/^\\[\"(\\w+)\\s+(\\d+),\\s+(\\d+)\\s+(\\d\\d:\\d\\d:\\d\\d)/);\n\nyyyy = parsed[3];\nmm = pad(month_to_number(parsed[1]));\ndd = parsed[2];\nhhhhhh = parsed[4];\n\n// Construct ISO 8601 datetime format.\niso_date = yyyy + \"-\" + mm + \"-\" + dd + \"T\" + hhhhhh\n\n// Current date/time.\nnow = new Date()\n// Substract current date/time from expiry and divide by 1000.\ndiff = parseInt((Date.parse(iso_date)-now.getTime()) / 1000)\n\nreturn(diff);"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "1762ef0e3d9a4d44a6c527459330398a",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[https_rsa,{#DUMMY}])<{$CPPM_CERT_EXPIRY_1}",
                                        "name": "CPPM HTTPS_RSA certificate will expire within {$CPPM_CERT_EXPIRY_1}",
                                        "priority": "AVERAGE"
                                    },
                                    {
                                        "uuid": "43be1da125c54924ae094ae0d363b1d4",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[https_rsa,{#DUMMY}])<{$CPPM_CERT_EXPIRY_2}",
                                        "name": "CPPM HTTPS_RSA certificate will expire within {$CPPM_CERT_EXPIRY_2}",
                                        "priority": "HIGH"
                                    }
                                ]
                            },
                            {
                                "uuid": "494a54be3422454ab6afc294c600679b",
                                "name": "CPPM RADIUS certificate expiry",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.expiry[radius,{#DUMMY}]",
                                "delay": "0",
                                "units": "s",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'RADIUS')].expiry_date"
                                        ]
                                    },
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "/*\nThis script converts the certificate expiry date to the number\nof seconds left before expiry.\n\nSteps:\n* Convert date/time string to ISO 8601, discard the timezone.\n* Parse the converted date/time.\n* Substract the current date/time from the expiry date/time and.\n* Convert the differrence from milliseconds to seconds.\n*/\n\n// Pad a number with a leading zero if < 10.\nfunction pad(n) {\n    return (n < 10) ? (\"0\" + n) : n;\n}\n\n// Convert month name to month number.\nfunction month_to_number(month) {\n  return('January___February__March_____April_____May_______June______July______August____September_October___November__December__'.indexOf(month) / 10 + 1)\n}\n\n// Extract date/time from a string in the format: [\"Jul 29, 2025 10:23:34 CEST\"].\n// We'll ignore the timezone.\nparsed = value.match(/^\\[\"(\\w+)\\s+(\\d+),\\s+(\\d+)\\s+(\\d\\d:\\d\\d:\\d\\d)/);\n\nyyyy = parsed[3];\nmm = pad(month_to_number(parsed[1]));\ndd = parsed[2];\nhhhhhh = parsed[4];\n\n// Construct ISO 8601 datetime format.\niso_date = yyyy + \"-\" + mm + \"-\" + dd + \"T\" + hhhhhh\n\n// Current date/time.\nnow = new Date()\n// Substract current date/time from expiry and divide by 1000.\ndiff = parseInt((Date.parse(iso_date)-now.getTime()) / 1000)\n\nreturn(diff);"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "10455992515a4f2ea2bf7316a63d1c95",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[radius,{#DUMMY}])<{$CPPM_CERT_EXPIRY_1}",
                                        "name": "CPPM RADIUS certificate will expire within {$CPPM_CERT_EXPIRY_1}",
                                        "priority": "AVERAGE"
                                    },
                                    {
                                        "uuid": "618a6abb5f9149bbab0bf9c0892e05c0",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[radius,{#DUMMY}])<{$CPPM_CERT_EXPIRY_2}",
                                        "name": "CPPM RADIUS certificate will expire within {$CPPM_CERT_EXPIRY_2}",
                                        "priority": "HIGH"
                                    }
                                ]
                            },
                            {
                                "uuid": "3f86229c84d24c6e808c73c39271c2d9",
                                "name": "CPPM RadSec certificate expiry",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.expiry[radsec,{#DUMMY}]",
                                "delay": "0",
                                "units": "s",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'RadSec')].expiry_date"
                                        ]
                                    },
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "/*\nThis script converts the certificate expiry date to the number\nof seconds left before expiry.\n\nSteps:\n* Convert date/time string to ISO 8601, discard the timezone.\n* Parse the converted date/time.\n* Substract the current date/time from the expiry date/time and.\n* Convert the differrence from milliseconds to seconds.\n*/\n\n// Pad a number with a leading zero if < 10.\nfunction pad(n) {\n    return (n < 10) ? (\"0\" + n) : n;\n}\n\n// Convert month name to month number.\nfunction month_to_number(month) {\n  return('January___February__March_____April_____May_______June______July______August____September_October___November__December__'.indexOf(month) / 10 + 1)\n}\n\n// Extract date/time from a string in the format: [\"Jul 29, 2025 10:23:34 CEST\"].\n// We'll ignore the timezone.\nparsed = value.match(/^\\[\"(\\w+)\\s+(\\d+),\\s+(\\d+)\\s+(\\d\\d:\\d\\d:\\d\\d)/);\n\nyyyy = parsed[3];\nmm = pad(month_to_number(parsed[1]));\ndd = parsed[2];\nhhhhhh = parsed[4];\n\n// Construct ISO 8601 datetime format.\niso_date = yyyy + \"-\" + mm + \"-\" + dd + \"T\" + hhhhhh\n\n// Current date/time.\nnow = new Date()\n// Substract current date/time from expiry and divide by 1000.\ndiff = parseInt((Date.parse(iso_date)-now.getTime()) / 1000)\n\nreturn(diff);"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "86194e2491714f2fabfb1e4119625798",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[radsec,{#DUMMY}])<{$CPPM_CERT_EXPIRY_1}",
                                        "name": "CPPM RadSec certificate will expire within {$CPPM_CERT_EXPIRY_1}",
                                        "priority": "AVERAGE"
                                    },
                                    {
                                        "uuid": "445f962d35bf43ff9d8180d446d83ca1",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.certificates.expiry[radsec,{#DUMMY}])<{$CPPM_CERT_EXPIRY_2}",
                                        "name": "CPPM RadSec certificate will expire within {$CPPM_CERT_EXPIRY_2}",
                                        "priority": "HIGH"
                                    }
                                ]
                            },
                            {
                                "uuid": "fb2ca0a3afb54f4a8b193bb15212ce37",
                                "name": "CPPM HTTPS_ECC certificate validity",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.validity[https_ecc,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'HTTPS(ECC)')]"
                                        ]
                                    },
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "var data = JSON.parse(value)\nif (!data[0].enabled) {\n    return 'Disabled';\n}\nreturn data[0].validity;"
                                        ]
                                    },
                                    {
                                        "type": "REGEX",
                                        "parameters": [
                                            "(\\w+)",
                                            "\\1"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "cd2e299a38534da5a81267a9778a4765",
                                        "expression": "find(/Template Aruba ClearPass by HTTP/clearpass.certificates.validity[https_ecc,{#DUMMY}],,\"regexp\",\"^Valid|Disabled$\")=0",
                                        "name": "CPPM HTTPS_ECC certificate invalid",
                                        "priority": "AVERAGE"
                                    }
                                ]
                            },
                            {
                                "uuid": "0302aebcc32342be9792fb2b454994fd",
                                "name": "CPPM HTTPS_RSA certificate validity",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.validity[https_rsa,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'HTTPS(RSA)')]"
                                        ]
                                    },
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "var data = JSON.parse(value)\nif (!data[0].enabled) {\n    return 'Disabled';\n}\nreturn data[0].validity;"
                                        ]
                                    },
                                    {
                                        "type": "REGEX",
                                        "parameters": [
                                            "(\\w+)",
                                            "\\1"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "0dfcc18e2837450aa52f374f53d96ad7",
                                        "expression": "find(/Template Aruba ClearPass by HTTP/clearpass.certificates.validity[https_rsa,{#DUMMY}],,\"regexp\",\"^Valid|Disabled$\")=0",
                                        "name": "CPPM HTTPS_RSA certificate invalid",
                                        "priority": "AVERAGE"
                                    }
                                ]
                            },
                            {
                                "uuid": "7ef178d60564491c97c761d1424f0ddf",
                                "name": "CPPM RADIUS certificate validity",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.validity[radius,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'RADIUS')].validity"
                                        ]
                                    },
                                    {
                                        "type": "REGEX",
                                        "parameters": [
                                            "(\\w+)",
                                            "\\1"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "1bbb3924a4e6484ab469ac31c3c41891",
                                        "expression": "find(/Template Aruba ClearPass by HTTP/clearpass.certificates.validity[radius,{#DUMMY}],,\"regexp\",\"^Valid|Disabled$\")=0",
                                        "name": "CPPM RADIUS certificate invalid",
                                        "priority": "AVERAGE"
                                    }
                                ]
                            },
                            {
                                "uuid": "5aead82b13044c298e95ce886fbfb398",
                                "name": "CPPM RadSec certificate validity",
                                "type": "DEPENDENT",
                                "key": "clearpass.certificates.validity[radsec,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$._embedded.items[?(@.service_name == 'RadSec')].validity"
                                        ]
                                    },
                                    {
                                        "type": "REGEX",
                                        "parameters": [
                                            "(\\w+)",
                                            "\\1"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.certificates[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ]
                            },
                            {
                                "uuid": "6e60f7cc41554eeba25aa3af0c14b30e",
                                "name": "CPPM Access license count",
                                "type": "DEPENDENT",
                                "key": "clearpass.license.count[access,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.items[?(@.license_type == 'Access')].licensed_count"
                                        ]
                                    },
                                    {
                                        "type": "REGEX",
                                        "parameters": [
                                            "(\\d+)",
                                            "\\1"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.license.summary[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM license"
                                    }
                                ]
                            },
                            {
                                "uuid": "5be90d30183c4cf8aeb70d42af353328",
                                "name": "CPPM Access license usage",
                                "type": "DEPENDENT",
                                "key": "clearpass.license.usage[access,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "FLOAT",
                                "trends": "0",
                                "units": "%",
                                "preprocessing": [
                                    {
                                        "type": "JAVASCRIPT",
                                        "parameters": [
                                            "var data = JSON.parse(value);\nvar percent = 0;\nfor (var i = 0; i < data.items.length; i++) {\n    if (data.items[i].license_type === \"Access\") {\n        if (data.items[i].licensed_count > 0) {\n            percent = (data.items[i].used_count / data.items[i].licensed_count) * 100;\n        }\n        break;\n    }\n}\nreturn percent.toFixed(2);"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.license.summary[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM license"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "0466cbc1969f40d595984e8c2aab8fc0",
                                        "expression": "last(/Template Aruba ClearPass by HTTP/clearpass.license.usage[access,{#DUMMY}]) > {$CPPM_LICENSE_ACCESS_WARNING_PERCENT}",
                                        "name": "CPPM Access license usage too high",
                                        "priority": "AVERAGE"
                                    }
                                ]
                            },
                            {
                                "uuid": "5be90d30183c4cf8aeb70d42af353327",
                                "name": "CPPM Access license used",
                                "type": "DEPENDENT",
                                "key": "clearpass.license.used[access,{#DUMMY}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.items[?(@.license_type == 'Access')].used_count"
                                        ]
                                    },
                                    {
                                        "type": "REGEX",
                                        "parameters": [
                                            "(\\d+)",
                                            "\\1"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "cppm.license.summary[{#DUMMY}]"
                                },
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM license"
                                    }
                                ]
                            },
                            {
                                "uuid": "dcf83966f33e47b7a68151a53de117d4",
                                "name": "CPPM server certs",
                                "type": "HTTP_AGENT",
                                "key": "cppm.certificates[{#DUMMY}]",
                                "delay": "1h",
                                "history": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "Main item for certificate monitoring.\nThe dependent items extract data for the individual server certificates.\n\nThe discovery rule updates the OAUTH \"Bearer\" token ( Authorization in the header ) every time it runs.",
                                "url": "https://{$CPPM_API_FQDN}/api/server-cert",
                                "headers": [
                                    {
                                        "name": "Authorization",
                                        "value": "Bearer {#SINGLETON}"
                                    }
                                ],
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM certificates"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "810824ad8cda4218a190cf50b85c9a9f",
                                        "expression": "nodata(/Template Aruba ClearPass by HTTP/cppm.certificates[{#DUMMY}],3h)=1",
                                        "name": "No data for item cppm.certificates",
                                        "priority": "AVERAGE"
                                    }
                                ]
                            },
                            {
                                "uuid": "f8beae73f4054603b4bd71b27bf68860",
                                "name": "CPPM license summary",
                                "type": "HTTP_AGENT",
                                "key": "cppm.license.summary[{#DUMMY}]",
                                "delay": "1h",
                                "history": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "Main item for license monitoring.\nThe dependent items extract data for the individual licenses.\n\nThe discovery rule updates the OAUTH \"Bearer\" token ( Authorization in the header ) every time it runs.",
                                "url": "https://{$CPPM_API_FQDN}/api/application-license/summary",
                                "headers": [
                                    {
                                        "name": "Authorization",
                                        "value": "Bearer {#SINGLETON}"
                                    }
                                ],
                                "tags": [
                                    {
                                        "tag": "Application",
                                        "value": "CPPM license"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "296198e6085c4d578ccb6c6e7e50d4f1",
                                        "expression": "nodata(/Template Aruba ClearPass by HTTP/cppm.license.summary[{#DUMMY}],3h)=1",
                                        "name": "No data for item cppm.license.summary",
                                        "priority": "AVERAGE"
                                    }
                                ]
                            }
                        ],
                        "url": "https://{$CPPM_API_FQDN}/api/oauth",
                        "post_type": "JSON",
                        "posts": "{\n  \"grant_type\": \"client_credentials\",\n  \"client_id\": \"{$CPPM_API_CLIENT}\",\n  \"client_secret\": \"{$CPPM_API_SECRET}\"\n}",
                        "request_method": "POST",
                        "preprocessing": [
                            {
                                "type": "JSONPATH",
                                "parameters": [
                                    "$.access_token"
                                ]
                            },
                            {
                                "type": "JAVASCRIPT",
                                "parameters": [
                                    "return JSON.stringify(value != \"[]\" ? [{'{#SINGLETON}': value, '{#DUMMY}': 'dummy'}] : []);"
                                ]
                            }
                        ]
                    }
                ],
                "macros": [
                    {
                        "macro": "{$CPPM_API_CLIENT}",
                        "description": "API client user/identity."
                    },
                    {
                        "macro": "{$CPPM_API_FQDN}",
                        "description": "CPPM server address."
                    },
                    {
                        "macro": "{$CPPM_API_SECRET}",
                        "description": "API client secret."
                    },
                    {
                        "macro": "{$CPPM_CERT_EXPIRY_1}",
                        "value": "14d",
                        "description": "First certificate expiry threshold."
                    },
                    {
                        "macro": "{$CPPM_CERT_EXPIRY_2}",
                        "value": "7d",
                        "description": "Second certificate expiry threshold."
                    },
                    {
                        "macro": "{$CPPM_DISCOVERY_UPDATE_INTERVAL}",
                        "value": "3h",
                        "description": "Update interval for discovery."
                    },
                    {
                        "macro": "{$CPPM_LICENSE_ACCESS_WARNING_PERCENT}",
                        "value": "95",
                        "description": "Access License Usage Limit."
                    }
                ]
            }
        ]
    }
}