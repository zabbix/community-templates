<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T22:05:32Z</date><groups><group><name>Fortiswitch</name></group></groups><templates><template><template>SNMP FortiSwitch Devices</template><name>SNMP FortiSwitch Devices</name><description>## Overview

This is a template created starting from Andrea Durante's Fortigate SNMP template, but with modified OIDs from the MIB of the FortiSwitch 124E-PoE device.


Serial No., OS version,% CPU,% RAM, disk (total and used), interface data (link and speed).


Graphs for % CPU, % RAM, disk use and network traffic.



## Author

Sergio Román González

</description><groups><group><name>Fortiswitch</name></group></groups><applications><application><name>Fortinet General</name></application><application><name>Fortinet Performance</name></application><application><name>Interfaces Discovery</name></application><application><name>Link 10/100/1000</name></application><application><name>Network Traffic</name></application><application><name>Port Status</name></application><application><name>Storage</name></application></applications><items><item><name>Current CPU Util</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.4.1.2.0</snmp_oid><key>fortinetCurrentCPUUtil</key><delay>60</delay><value_type>FLOAT</value_type><units>%</units><applications><application><name>Fortinet Performance</name></application></applications><triggers><trigger><expression>{avg(#5)}&gt;95</expression><name>Fortinet {HOSTNAME} - Usage of CPU over 95%</name><priority>AVERAGE</priority><description>CPU activity on Fortinet is more than 95% during the last five checks</description></trigger></triggers></item><item><name>Current RAM Usage</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.4.1.3.0</snmp_oid><key>fortinetCurrentRAMUtil</key><delay>60</delay><value_type>FLOAT</value_type><units>B</units><applications><application><name>Fortinet Performance</name></application></applications></item><item><name>Total RAM Capacity</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.4.1.4.0</snmp_oid><key>fortinetTotalRAMCapacity</key><delay>3600</delay><value_type>FLOAT</value_type><units>B</units><applications><application><name>Fortinet Performance</name></application></applications></item><item><name>Total storage space</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.4.1.6.0</snmp_oid><key>fortinetTotalStorage</key><delay>3600</delay><value_type>FLOAT</value_type><units>B</units><applications><application><name>Fortinet Performance</name></application><application><name>Storage</name></application></applications><preprocessing><step><type>MULTIPLIER</type><params>1000000</params></step></preprocessing></item><item><name>Fortinet Used RAM %</name><type>CALCULATED</type><key>fortinetUsedMemory-percent</key><delay>60</delay><value_type>FLOAT</value_type><units>%</units><params>100*last(&quot;fortinetCurrentRAMUtil&quot;)/last(&quot;fortinetTotalRAMCapacity&quot;)</params><applications><application><name>Fortinet Performance</name></application></applications><triggers><trigger><expression>{avg(#5)}&gt;90</expression><name>Fortinet {HOSTNAME} - Memory Usage Over 90%</name><priority>AVERAGE</priority><description>Memory usage on Fortinet is more than 90% during the last five checks</description></trigger></triggers></item><item><name>Used storage space</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.4.1.5.0</snmp_oid><key>fortinetUsedStorage</key><delay>60</delay><units>B</units><applications><application><name>Fortinet Performance</name></application><application><name>Storage</name></application></applications><preprocessing><step><type>MULTIPLIER</type><params>1000000</params></step></preprocessing></item><item><name>Fortinet Used Storage %</name><type>CALCULATED</type><key>fortinetUsedStorage-percent</key><delay>60</delay><value_type>FLOAT</value_type><units>%</units><params>100*last(&quot;fortinetUsedStorage&quot;)/last(&quot;fortinetTotalStorage&quot;)</params><applications><application><name>Fortinet Performance</name></application><application><name>Storage</name></application></applications></item><item><name>Firmware Version</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.4.1.1.0</snmp_oid><key>SysmFirmwareVersion</key><delay>3600</delay><trends>0</trends><value_type>CHAR</value_type><inventory_link>OS</inventory_link><applications><application><name>Fortinet General</name></application></applications></item><item><name>Serial Number</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.12356.106.1.1.1.0</snmp_oid><key>SysmSerialNumber</key><delay>3600</delay><trends>0</trends><value_type>CHAR</value_type><inventory_link>SERIALNO_A</inventory_link><applications><application><name>Fortinet General</name></application></applications></item></items><discovery_rules><discovery_rule><name>Network Interfaces</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.31.1.1.1.1]</snmp_oid><key>ifname</key><delay>300</delay><item_prototypes><item_prototype><name>Upload $1</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid><key>ifHCOutOctets[{#SNMPVALUE}]</key><delay>30</delay><units>bps</units><applications><application><name>Network Traffic</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step><step><type>MULTIPLIER</type><params>8</params></step></preprocessing></item_prototype><item_prototype><name>Link Speed $1</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid><key>ifHighSpeed[{#SNMPVALUE}]</key><delay>300</delay><history>7d</history><trends>180d</trends><applications><application><name>Link 10/100/1000</name></application></applications></item_prototype><item_prototype><name>Download $1</name><type>SNMP_AGENT</type><snmp_oid>IF-MIB::ifInOctets.{#SNMPINDEX}</snmp_oid><key>ifInOctets[{#SNMPVALUE}]</key><delay>30</delay><units>bps</units><applications><application><name>Network Traffic</name></application></applications><preprocessing><step><type>CHANGE_PER_SECOND</type><params/></step><step><type>MULTIPLIER</type><params>8</params></step></preprocessing></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>Network Traffic {#SNMPVALUE}</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>SNMP FortiSwitch Devices</host><key>ifInOctets[{#SNMPVALUE}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>F63100</color><item><host>SNMP FortiSwitch Devices</host><key>ifHCOutOctets[{#SNMPVALUE}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule></discovery_rules></template></templates><graphs><graph><name>CPU %</name><show_work_period>NO</show_work_period><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>00AA00</color><item><host>SNMP FortiSwitch Devices</host><key>fortinetCurrentCPUUtil</key></item></graph_item></graph_items></graph><graph><name>Disk use</name><width>400</width><height>400</height><yaxismax>0</yaxismax><show_work_period>NO</show_work_period><show_triggers>NO</show_triggers><type>PIE</type><show_3d>YES</show_3d><graph_items><graph_item><color>AA0000</color><item><host>SNMP FortiSwitch Devices</host><key>fortinetUsedStorage</key></item></graph_item><graph_item><sortorder>1</sortorder><color>006600</color><type>GRAPH_SUM</type><item><host>SNMP FortiSwitch Devices</host><key>fortinetTotalStorage</key></item></graph_item></graph_items></graph><graph><name>RAM %</name><show_work_period>NO</show_work_period><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>C80000</color><item><host>SNMP FortiSwitch Devices</host><key>fortinetUsedMemory-percent</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
