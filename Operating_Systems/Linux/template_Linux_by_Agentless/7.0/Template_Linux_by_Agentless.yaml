zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: ae32a7dd9b654142bb6f882e05114507
      name: SISA
    - uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Templates/Operating systems'
  templates:
    - uuid: 9205007ea4814766a6004aedba263740
      template: 'Template Linux by Agentless'
      name: 'Template Linux by Agentless'
      description: |
        The templated used for monitor Linux hosts via SSH, No Zabbix agent required for this. 
        Required: 
        1. SSH Username
        2. SSH Password foe the user
        3. Connectivity of the agent-server form Zabbix
        
        
        SSH-Documentation: 
        https://www.zabbix.com/documentation/current/en/manual/config/items/itemtypes/ssh_checks
        
        for more about: https://github.com/karthick-dkk/zabbix
      groups:
        - name: SISA
        - name: 'Templates/Operating systems'
      items:
        - uuid: ac05fbd53272402784e9c6289a46034f
          name: 'get fiesystem'
          type: DEPENDENT
          key: filesystem.get.data
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: REGEX
              parameters:
                - '(?s)Filesystem\s+1M-blocks\s+Used\s+Available\s+Use%\s+Mounted\s+on\n(.*)'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: cdd03bede9f84d5995e8afc544e38087
          name: 'redis memory'
          type: DEPENDENT
          key: redis.mem.pused
          delay: '0'
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: REGEX
              parameters:
                - 'Mem:\s*([0-9.]+)'
                - \1
          master_item:
            key: 'ssh-get[{HOST.CONN},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$REDIS.COMMAND}"]'
          triggers:
            - uuid: 7dc665473ab44972a1204ba125e2500e
              expression: 'last(/Template Linux by Agentless/redis.mem.pused,#20)>50'
              name: 'Redis used 50% of Memory on {HOST.NAME}'
              event_name: 'Redis used 50% of Memory on {HOST.NAME}'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: app
                  value: redis-server
        - uuid: f4a7021c1c69477eba559a2d68e6d748
          name: 'redis get data'
          type: EXTERNAL
          key: 'ssh-get[{HOST.CONN},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$REDIS.COMMAND}"]'
          value_type: TEXT
          trends: '0'
          description: 'Get data from device'
          timeout: 15s
        - uuid: 729de9d84f524c8abbdd74197ee48b6f
          name: 'ssh get data'
          type: EXTERNAL
          key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
          delay: 2m
          value_type: TEXT
          trends: '0'
          description: 'Get data from device'
          timeout: 15s
          triggers:
            - uuid: f2a497ae21d3434caf39a729a0f3b941
              expression: 'nodata(/Template Linux by Agentless/ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"],4m)=1'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'nodata(/Template Linux by Agentless/ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"],1m)<>1'
              name: '{HOST.NAME} is down or SSH connection failed'
              event_name: '{HOST.NAME} is down or SSH connection failed'
              opdata: SSH
              priority: DISASTER
              manual_close: 'YES'
        - uuid: 511be425bba649258a6796b5e3b0d9f6
          name: 'ssh get proc data'
          type: EXTERNAL
          key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHPROCCOMMAND}"]'
          delay: 10m
          value_type: TEXT
          trends: '0'
          status: DISABLED
          description: 'Get Top Cpu usage data from device'
          timeout: 15s
        - uuid: 407e2be6c3f444ebac42997f72b814a1
          name: 'ssh-get (without Pass)'
          type: SSH
          key: 'ssh.run[ssh.get,{$SSHIP},]'
          delay: 2m
          value_type: TEXT
          trends: '0'
          status: DISABLED
          params: |
            #!/bin/bash
            mpstat && uptime && free && lsb_release -d
          authtype: PUBLIC_KEY
          username: '{$SSHUSER}'
          password: '{$SSHPASS}'
          publickey: id_ecdsa.pub
          privatekey: id_ecdsa
          timeout: 10s
        - uuid: e56a51acca3f4e25a78830f3e0737033
          name: arch
          type: DEPENDENT
          key: system.arch
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: REGEX
              parameters:
                - '_([a-zA-Z0-9_]+)_'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: ba8e5e93ad074ac3bec7e31da677bd66
          name: 'cpu idle'
          type: DEPENDENT
          key: system.cpu.idle
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'all\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+[0-9.]+\s+([0-9.]+)'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: d336afe610a94b2d9103faf4eba94584
          name: 'cpu nice'
          type: DEPENDENT
          key: system.cpu.nice
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'all\s+[0-9.]+\s+([0-9.]+)\s+'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 00143b665825465485d34579cdbf1005
          name: 'cpu system'
          type: DEPENDENT
          key: system.cpu.system
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'all\s+[0-9.]+\s+[0-9.]+\s+([0-9.]+)\s+'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 33726de2f13f4787867a088fa9efc87e
          name: 'cpu user'
          type: DEPENDENT
          key: system.cpu.user
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'all\s+([0-9.]+)\s+'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 3a82ca86c8be40298b68310c294ecae5
          name: 'cpu utlization'
          type: DEPENDENT
          key: system.cpu.util
          delay: '0'
          units: '%'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  //return 100 - value;
                  return Math.round(100 - value);
          master_item:
            key: system.cpu.idle
          triggers:
            - uuid: 54803f1f7cc44f109627fb25a398c960
              expression: 'min(/Template Linux by Agentless/system.cpu.util,10)>{$CPU.UTIL.CRIT}'
              name: 'Critical CPU utilization above > 90% on {HOST.NAME}'
              event_name: 'Critical CPU utilization above > 90% on {HOST.NAME}'
              opdata: 'CPU util: {ITEM.LASTVALUE}'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                - tag: trigger
                  value: cpu
            - uuid: c3cb02f157b44c42b9e11731e3e0860b
              expression: 'avg(/Template Linux by Agentless/system.cpu.util,#5)>{$CPU.UTIL.HIGH}'
              name: 'High CPU Usage above 70% on  {HOST.NAME}'
              opdata: 'CPU util: {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 1e759c54931743de96b64caf644d517f
          name: 'cpu count'
          type: DEPENDENT
          key: system.cpucount
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: REGEX
              parameters:
                - \((\d+)\s+CPU\)
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: cdcc338c659a403691d429deccfd9c2d
          name: hostname
          type: DEPENDENT
          key: system.hostname
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var input = value
                  var hostnameRegex = /\(([^)]+)\)/;  // Extracts the value inside parentheses
                  var hostnameMatch = input.match(hostnameRegex);
                  if (hostnameMatch) {
                      return hostnameMatch[1];  // This will return 'zabbix-server'
                  } else {
                      return "";  // If no match is found, return an empty string
                  }
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 9b790e21ec4b4ca2a89d2801a3965b02
          name: hostype
          type: DEPENDENT
          key: system.hosttype
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: REGEX
              parameters:
                - ^(\w+)
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 45ad6a477f7f49fe8cf46d738a90cc50
          name: kernel
          type: DEPENDENT
          key: system.kernel
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: REGEX
              parameters:
                - '\s+([^\s]+)\s+\('
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 9dd1faba71b744379dc2373e9e994aad
          name: 'load avg (1m)'
          type: DEPENDENT
          key: system.loadavg.1m
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'load average:\s+([0-9.]+),'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: a26638421ca74d75bd485f9b01415b9a
          name: 'load avg (5m)'
          type: DEPENDENT
          key: system.loadavg.5m
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'load average:\s+[0-9.]+,\s+([0-9.]+),'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 19c71a0855ee4804aa64f2e4f269dc19
          name: 'load avg (15m)'
          type: DEPENDENT
          key: system.loadavg.15m
          delay: '0'
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'load average:\s+[0-9.]+,\s+[0-9.]+,\s+([0-9.]+)'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 1d3c36a5d04647bcb313318058cf9c9a
          name: 'memory avail'
          type: DEPENDENT
          key: system.memory.avail
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Mem:\s+[0-9]+\s+[0-9]+\s+[0-9]+\s+[0-9]+\s+[0-9]+\s+([0-9]+)'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: f9e0aec6c6a64c31837c5e8980067a61
          name: 'memory free'
          type: DEPENDENT
          key: system.memory.free
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Mem:\s+[0-9]+\s+[0-9]+\s+([0-9]+)\s+'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: f8aff4401ef0412aaa2196116e19fefc
          name: 'swap used'
          type: DEPENDENT
          key: system.memory.swap
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Swap:\s+[0-9]+\s+([0-9]+)\s+'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 063fd6ec6d604cca9785aa9e9905ca0e
          name: 'memory total'
          type: DEPENDENT
          key: system.memory.total
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Mem:\s+([0-9]+)\s+'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 0e7218da304f4a35835e4da635228e7c
          name: 'memory used'
          type: DEPENDENT
          key: system.memory.used
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Mem:\s+([0-9]+)\s+([0-9]+)\s+([0-9]+)\s+([0-9]+)\s+([0-9]+)\s+([0-9]+)'
                - \2
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: a12b861cf2934466b9cc5a36568e745a
          name: 'memory utilization'
          type: CALCULATED
          key: system.memory.util
          units: '%'
          params: '(last(//system.memory.used)/last(//system.memory.total))*100'
          triggers:
            - uuid: 4c602f130cad464c9bc195eaa4a7518e
              expression: 'avg(/Template Linux by Agentless/system.memory.util,#15)>{$MEM.UTIL.HIGH}'
              name: 'Average Memory Utilization above > 70% on {HOST.NAME}'
              opdata: 'Mem Util: {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
            - uuid: 4edd3fde594541ca9e85760162008327
              expression: 'avg(/Template Linux by Agentless/system.memory.util,#15)>{$MEM.UTIL.CRIT}'
              name: 'Critical Memory Utilization > 90% on {HOST.NAME}'
              opdata: 'Mem Util: {ITEM.LASTVALUE}'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: trigger
                  value: memory
        - uuid: b9b98d7ef6d645e98f99ee723f1ce6ce
          name: 'OS ver'
          type: DEPENDENT
          key: system.os.info
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: REGEX
              parameters:
                - 'Description:\s+(.*)'
                - \1
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: a894e5704dd448f992c8b3d075bfa8b9
          name: 'ssh health'
          type: DEPENDENT
          key: system.ssh.health
          delay: '0'
          valuemap:
            name: status
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var v = String(value).trim().toLowerCase();
                  
                  // If value is empty
                  if (v === "" || v === null || v === "undefined") {
                      return 0;
                  }
                  
                  // If value contains error keywords
                  if (v.includes("error") || v.includes("failed") || v.includes("timeout")) {
                      return 0;
                  }
                  
                  // Otherwise, valid data received
                  return 1;
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 62b4c6fd7f7c4badaa260cf114d1db0b
          name: 'swap free'
          type: DEPENDENT
          key: system.swap.free
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Swap:\s+[0-9]+\s+[0-9]+\s+([0-9]+)'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: 577fdcab92584c0191473170535e5cc3
          name: 'swap total'
          type: DEPENDENT
          key: system.swap.total
          delay: '0'
          units: B
          preprocessing:
            - type: REGEX
              parameters:
                - 'Swap:\s+([0-9]+)\s+'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
        - uuid: d6812bf21acf4ac28a5f300c99e1ac71
          name: uptime
          type: DEPENDENT
          key: system.uptime
          delay: '0'
          trends: '0'
          units: s
          preprocessing:
            - type: REGEX
              parameters:
                - 'up\s+(.+?),'
                - \1
            - type: JAVASCRIPT
              parameters:
                - |
                  var str = value.trim(); // e.g. "188 days"
                  var total = 0;
                  
                  var days = str.match(/(\d+)\s*day/);
                  if (days) total += parseInt(days[1]) * 86400;
                  
                  var hours = str.match(/(\d+)\s*hour/);
                  if (hours) total += parseInt(hours[1]) * 3600;
                  
                  var mins = str.match(/(\d+)\s*min/);
                  if (mins) total += parseInt(mins[1]) * 60;
                  
                  var secs = str.match(/(\d+)\s*sec/);
                  if (secs) total += parseInt(secs[1]);
                  
                  return total;
          master_item:
            key: 'ssh-get[{HOST.HOST},{$SSHUSER},{$SSHPORT},{$SSHJUMP},"{$SSHCOMMAND}"]'
          triggers:
            - uuid: cdfa8a7d0535447bbd05ab7ad71148e1
              expression: 'last(/Template Linux by Agentless/system.uptime)>100 and last(/Template Linux by Agentless/system.uptime)<300'
              name: '{HOST.NAME} : Server has restarted 5 mins ago'
              event_name: '{HOST.NAME} : Server has restarted 5 mins ago'
              priority: HIGH
              manual_close: 'YES'
      discovery_rules:
        - uuid: 04701841b6ff4e3e89e89fa5926b1fb3
          name: 'filesystem discovery'
          type: DEPENDENT
          key: discovery.filesystem
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: A
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discover the file system'
          item_prototypes:
            - uuid: f3c0cc67a4b642d28070f326dff89e54
              name: 'Disk ({#FSNAME}) Free size'
              type: DEPENDENT
              key: 'vfs.fs.size[{#FSNAME},Free,mb]'
              delay: '0'
              trends: '0'
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var lines = value.trim().split("\n");
                      var targetFS = "{#FSNAME}";
                      
                      for (var i = 0; i < lines.length; i++) {
                          var parts = lines[i].trim().split(/\s+/);
                          if (parts.length >= 6) {
                              var fsName = parts[parts.length - 1];
                              var free = parts[3]; // FREE (Available) column
                      
                              if (fsName === targetFS) {
                                  return free;
                              }
                          }
                      }
                      
                      return null;
                - type: MULTIPLIER
                  parameters:
                    - '1024'
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: filesystem.get.data
            - uuid: 7324765b4db8499282322f697aaa3650
              name: 'Dsik ({#FSNAME}) Used  % size'
              type: DEPENDENT
              key: 'vfs.fs.size[{#FSNAME},pused,mb]'
              delay: '0'
              trends: '0'
              units: '%'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var lines = value.trim().split("\n");
                      var targetFS = "{#FSNAME}";
                      
                      for (var i = 0; i < lines.length; i++) {
                          var parts = lines[i].trim().split(/\s+/);
                          if (parts.length >= 6) {
                              var fsName = parts[parts.length - 1];
                              var usedPercent = parts[4]; // USED% column
                      
                              if (fsName === targetFS) {
                                  return usedPercent.replace("%", ""); // remove '%' for numeric
                              }
                          }
                      }
                      
                      return null;
              master_item:
                key: filesystem.get.data
              trigger_prototypes:
                - uuid: 1661b084d48e47eab2024be633bf4a39
                  expression: 'last(/Template Linux by Agentless/vfs.fs.size[{#FSNAME},pused,mb])>=80'
                  name: 'Disk ({#FSNAME}) Used  above 80%'
                  event_name: 'Disk ({#FSNAME}) Used  above 80%'
                  priority: AVERAGE
                  dependencies:
                    - name: 'Disk ({#FSNAME}) Used  above 90%'
                      expression: 'last(/Template Linux by Agentless/vfs.fs.size[{#FSNAME},pused,mb])>=90'
                - uuid: a4c95d155d54497db0428fa0563145b7
                  expression: 'last(/Template Linux by Agentless/vfs.fs.size[{#FSNAME},pused,mb])>=90'
                  name: 'Disk ({#FSNAME}) Used  above 90%'
                  event_name: 'Disk ({#FSNAME}) Used  above 90%'
                  priority: HIGH
            - uuid: 5198b672afa24dbeb7c97eaede16833f
              name: 'Disk ({#FSNAME}) Total size'
              type: DEPENDENT
              key: 'vfs.fs.size[{#FSNAME},total,mb]'
              delay: '0'
              trends: '0'
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      // Split incoming df-like output into lines
                      var lines = value.trim().split("\n");
                      var targetFS = "{#FSNAME}"; // LLD macro
                      
                      for (var i = 0; i < lines.length; i++) {
                          var parts = lines[i].trim().split(/\s+/);
                          if (parts.length >= 6) {
                              var fsName = parts[parts.length - 1]; // mount point
                              var total = parts[1]; // total size column
                      
                              if (fsName === targetFS) {
                                  return total; // return only TOTAL for this FS
                              }
                          }
                      }
                      
                      return null; // if FS not found
                - type: MULTIPLIER
                  parameters:
                    - '1024'
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: filesystem.get.data
            - uuid: 12561997836f4df99f4bf2d241235648
              name: 'Disk ({#FSNAME}) Used size'
              type: DEPENDENT
              key: 'vfs.fs.size[{#FSNAME},used,mb]'
              delay: '0'
              trends: '0'
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      // Split incoming df-like output into lines
                      var lines = value.trim().split("\n");
                      var targetFS = "{#FSNAME}"; // LLD macro
                      
                      for (var i = 0; i < lines.length; i++) {
                          var parts = lines[i].trim().split(/\s+/);
                          if (parts.length >= 6) {
                              var fsName = parts[parts.length - 1]; // mount point
                              var used = parts[2]; // USED column
                      
                              if (fsName === targetFS) {
                                  return used;
                              }
                          }
                      }
                      
                      return null; // if FS not found
                - type: MULTIPLIER
                  parameters:
                    - '1024'
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: filesystem.get.data
          graph_prototypes:
            - uuid: 5a204d5084474bb7ba4a65b9bd22e124
              name: 'Disk ({#FSNAME}) utilization Graph'
              show_work_period: 'NO'
              ymax_type_1: ITEM
              ymax_item_1:
                host: 'Template Linux by Agentless'
                key: 'vfs.fs.size[{#FSNAME},total,mb]'
              graph_items:
                - color: 00796B
                  calc_fnc: MIN
                  item:
                    host: 'Template Linux by Agentless'
                    key: 'vfs.fs.size[{#FSNAME},total,mb]'
                - sortorder: '1'
                  color: BFFF00
                  calc_fnc: MIN
                  item:
                    host: 'Template Linux by Agentless'
                    key: 'vfs.fs.size[{#FSNAME},Free,mb]'
                - sortorder: '2'
                  color: FF0080
                  calc_fnc: MIN
                  item:
                    host: 'Template Linux by Agentless'
                    key: 'vfs.fs.size[{#FSNAME},used,mb]'
            - uuid: 7b074225cc2f4ea9a967280805b3b442
              name: 'Disk ({#FSNAME}) utilization Pie'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              type: PIE
              graph_items:
                - color: 00796B
                  calc_fnc: MIN
                  item:
                    host: 'Template Linux by Agentless'
                    key: 'vfs.fs.size[{#FSNAME},total,mb]'
                - sortorder: '1'
                  color: BFFF00
                  calc_fnc: MIN
                  item:
                    host: 'Template Linux by Agentless'
                    key: 'vfs.fs.size[{#FSNAME},Free,mb]'
                - sortorder: '2'
                  color: FF0080
                  calc_fnc: MIN
                  item:
                    host: 'Template Linux by Agentless'
                    key: 'vfs.fs.size[{#FSNAME},used,mb]'
          master_item:
            key: filesystem.get.data
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  // Split incoming text into lines
                  var lines = value.trim().split("\n");
                  var data = [];
                  
                  // Loop through each line
                  for (var i = 0; i < lines.length; i++) {
                      // Match: FSname Total Used Free Used% Mount
                      var parts = lines[i].trim().split(/\s+/);
                      if (parts.length >= 6) {
                          data.push({
                         //     "{#FSNAME}": parts[0],
                              "{#FSNAME}": parts[parts.length -1],
                              "{#TOTAL}": parts[1],
                              "{#USED}": parts[2],
                              "{#FREE}": parts[3],
                              "{#USEDP}": parts[4].replace("%",""),
                              "{#MOUNT}": parts[5]
                          });
                      }
                  }
                  
                  // Return JSON for LLD
                  return JSON.stringify({ "data": data });
      tags:
        - tag: agent
          value: ssh
        - tag: type
          value: agentless
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        - macro: '{$CPU.UTIL.HIGH}'
          value: '75'
        - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '5'
          description: 'Load Average per cpu'
        - macro: '{$MEM.UTIL.CRIT}'
          value: '90'
        - macro: '{$MEM.UTIL.HIGH}'
          value: '75'
        - macro: '{$REDIS.COMMAND}'
          value: 'pass=$(grep "^requirepass" /etc/redis/redis.conf | awk ''NR==1 {print $2}''); port=$(grep "^port" /etc/redis/redis.conf | grep -v "^#" | awk ''{print $2}''); used_memory=$(redis-cli -h 127.0.0.1 -p "$port" -a "$pass" --no-auth-warning info | awk -F: ''/^used_memory:/ {print $2}'' | tr -d ''\r''); maxmemory=$(redis-cli -h 127.0.0.1 -p "$port" -a "$pass" --no-auth-warning info | awk -F: ''/^maxmemory:/ {print $2}'' | tr -d ''\r''); if [ -z "$maxmemory" ] || [ "$maxmemory" -eq 0 ]; then maxmemory=$(free -b | awk ''/Mem:/ {print $2}''); fi; [[ "$used_memory" =~ ^[0-9]+$ ]] || used_memory=0; [[ "$maxmemory" =~ ^[0-9]+$ ]] || maxmemory=1; percentage=$(awk -v u="$used_memory" -v m="$maxmemory" ''BEGIN {printf "%.2f", (u/m)*100}''); output=$(for key in $(redis-cli --no-auth-warning -h 127.0.0.1 -p "$port" -a "$pass" keys \* | sort -h); do length=$(redis-cli --no-auth-warning -h 127.0.0.1 -p "$port" -a "$pass" llen "$key"); echo "$key = $length"; done); echo "$output"; echo "Mem: $percentage"'
        - macro: '{$SSH.SERVICE.COMMAND}'
          value: 'systemctl stauts logstash | grep Active'
        - macro: '{$SSH.SERVICE.ES}'
          value: 'for svc in elasticsearch; do systemctl status $svc >/dev/null 2>&1; rc=$?; if [ $rc -eq 4 ]; then echo "$svc|NA|0|0|N/A"; else pid=$(systemctl show -p MainPID --value $svc 2>/dev/null); if [ -n "$pid" ] && [ "$pid" -gt 0 ]; then read u m <<< $(ps -o etimes=,rss= -p $pid | tail -n1); s=$(systemctl show -p ActiveEnterTimestamp --value $svc); echo "$svc|active|$u|$m|$s"; else echo "$svc|inactive|0|0|N/A"; fi; fi; done'
        - macro: '{$SSH.SERVICE.FIREWALL}'
          value: 'for svc in firewalld; do systemctl status $svc >/dev/null 2>&1; rc=$?; if [ $rc -eq 4 ]; then echo "$svc|NA|0|0|N/A"; else pid=$(systemctl show -p MainPID --value $svc 2>/dev/null); if [ -n "$pid" ] && [ "$pid" -gt 0 ]; then read u m <<< $(ps -o etimes=,rss= -p $pid | tail -n1); s=$(systemctl show -p ActiveEnterTimestamp --value $svc); echo "$svc|active|$u|$m|$s"; else echo "$svc|inactive|0|0|N/A"; fi; fi; done'
        - macro: '{$SSH.SERVICE.LS}'
          value: 'for svc in logstash; do systemctl status $svc >/dev/null 2>&1; rc=$?; if [ $rc -eq 4 ]; then echo "$svc|NA|0|0|N/A"; else pid=$(systemctl show -p MainPID --value $svc 2>/dev/null); if [ -n "$pid" ] && [ "$pid" -gt 0 ]; then read u m <<< $(ps -o etimes=,rss= -p $pid | tail -n1); s=$(systemctl show -p ActiveEnterTimestamp --value $svc); echo "$svc|active|$u|$m|$s"; else echo "$svc|inactive|0|0|N/A"; fi; fi; done'
        - macro: '{$SSH.SERVICE.NGINX}'
          value: 'for svc in nginx; do systemctl status $svc >/dev/null 2>&1; rc=$?; if [ $rc -eq 4 ]; then echo "$svc|NA|0|0|N/A"; else pid=$(systemctl show -p MainPID --value $svc 2>/dev/null); if [ -n "$pid" ] && [ "$pid" -gt 0 ]; then read u m <<< $(ps -o etimes=,rss= -p $pid | tail -n1); s=$(systemctl show -p ActiveEnterTimestamp --value $svc); echo "$svc|active|$u|$m|$s"; else echo "$svc|inactive|0|0|N/A"; fi; fi; done'
        - macro: '{$SSH.SERVICE.REDIS}'
          value: 'for svc in redis-server; do systemctl status $svc >/dev/null 2>&1; rc=$?; if [ $rc -eq 4 ]; then echo "$svc|NA|0|0|N/A"; else pid=$(systemctl show -p MainPID --value $svc 2>/dev/null); if [ -n "$pid" ] && [ "$pid" -gt 0 ]; then read u m <<< $(ps -o etimes=,rss= -p $pid | tail -n1); s=$(systemctl show -p ActiveEnterTimestamp --value $svc); echo "$svc|active|$u|$m|$s"; else echo "$svc|inactive|0|0|N/A"; fi; fi; done'
        - macro: '{$SSH.SERVICES}'
          value: 'logstash redis-server elasticsearch'
          description: 'Add like: " <service1 service2 >"'
        - macro: '{$SSHCOMMAND}'
          value: 'mpstat && uptime && free && lsb_release -d && df --block-size=1M'
        - macro: '{$SSHIP}'
          value: '{HOST.HOST}'
        - macro: '{$SSHJUMP}'
          value: '-J windows-jump-208'
        - macro: '{$SSHPASS}'
        - macro: '{$SSHPORT}'
          value: '22'
        - macro: '{$SSHPROCCOMMAND}'
          value: 'ps -eo user,pid,comm,%cpu,%mem --sort=-%cpu | head -n 5'
        - macro: '{$SSHUSER}'
          value: karthick
        - macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
        - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/dev|/sys|/boot|/snap|/run|/proc|.+/shm$)
      dashboards:
        - uuid: 7bea60b1a8c84aa0b7335c714eaddbcf
          name: 'Agentless Dashboard'
          display_period: '10'
          auto_start: 'NO'
          pages:
            - widgets:
                - type: tophosts
                  name: Server
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: columns.0.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.0.base_color
                      value: B4B4B4
                    - type: INTEGER
                      name: columns.0.data
                      value: '2'
                    - type: INTEGER
                      name: columns.0.decimal_places
                      value: '2'
                    - type: STRING
                      name: columns.0.name
                      value: Host
                    - type: INTEGER
                      name: columns.1.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.1.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.1.data
                      value: '1'
                    - type: INTEGER
                      name: columns.1.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.1.display
                      value: '1'
                    - type: INTEGER
                      name: columns.1.history
                      value: '1'
                    - type: STRING
                      name: columns.1.item
                      value: hostname
                    - type: STRING
                      name: columns.1.name
                      value: Hostname
                    - type: INTEGER
                      name: columns.2.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.2.base_color
                      value: 00FF00
                    - type: INTEGER
                      name: columns.2.data
                      value: '1'
                    - type: INTEGER
                      name: columns.2.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.2.display
                      value: '3'
                    - type: INTEGER
                      name: columns.2.history
                      value: '1'
                    - type: STRING
                      name: columns.2.item
                      value: 'cpu utlization'
                    - type: STRING
                      name: columns.2.max
                      value: '100'
                    - type: STRING
                      name: columns.2.min
                      value: '0'
                    - type: STRING
                      name: columns.2.name
                      value: 'CPU usage'
                    - type: INTEGER
                      name: columns.3.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.3.base_color
                      value: 80FF00
                    - type: INTEGER
                      name: columns.3.data
                      value: '1'
                    - type: INTEGER
                      name: columns.3.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.3.display
                      value: '3'
                    - type: INTEGER
                      name: columns.3.history
                      value: '1'
                    - type: STRING
                      name: columns.3.item
                      value: 'memory utilization'
                    - type: STRING
                      name: columns.3.max
                      value: '100'
                    - type: STRING
                      name: columns.3.min
                      value: '0'
                    - type: STRING
                      name: columns.3.name
                      value: 'Memory usage'
                    - type: INTEGER
                      name: columns.4.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.4.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.4.data
                      value: '1'
                    - type: INTEGER
                      name: columns.4.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.4.display
                      value: '1'
                    - type: INTEGER
                      name: columns.4.history
                      value: '1'
                    - type: STRING
                      name: columns.4.item
                      value: 'memory total'
                    - type: STRING
                      name: columns.4.name
                      value: 'Total Memory'
                    - type: INTEGER
                      name: columns.5.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.5.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.5.data
                      value: '1'
                    - type: INTEGER
                      name: columns.5.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.5.display
                      value: '1'
                    - type: INTEGER
                      name: columns.5.history
                      value: '1'
                    - type: STRING
                      name: columns.5.item
                      value: 'cpu count'
                    - type: STRING
                      name: columns.5.name
                      value: 'Total CPU'
                    - type: INTEGER
                      name: columns.6.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.6.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.6.data
                      value: '1'
                    - type: INTEGER
                      name: columns.6.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.6.display
                      value: '1'
                    - type: INTEGER
                      name: columns.6.history
                      value: '1'
                    - type: STRING
                      name: columns.6.item
                      value: uptime
                    - type: STRING
                      name: columns.6.name
                      value: Uptime
                    - type: INTEGER
                      name: columns.7.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.7.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.7.data
                      value: '1'
                    - type: INTEGER
                      name: columns.7.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.7.display
                      value: '1'
                    - type: INTEGER
                      name: columns.7.history
                      value: '1'
                    - type: STRING
                      name: columns.7.item
                      value: 'load avg (15m)'
                    - type: STRING
                      name: columns.7.name
                      value: 'Load 15m'
                    - type: INTEGER
                      name: columns.8.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.8.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.8.data
                      value: '1'
                    - type: INTEGER
                      name: columns.8.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.8.display
                      value: '1'
                    - type: INTEGER
                      name: columns.8.history
                      value: '1'
                    - type: STRING
                      name: columns.8.item
                      value: 'OS ver'
                    - type: STRING
                      name: columns.8.name
                      value: OS
                    - type: INTEGER
                      name: columns.9.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.9.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.9.data
                      value: '1'
                    - type: INTEGER
                      name: columns.9.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.9.display
                      value: '1'
                    - type: INTEGER
                      name: columns.9.history
                      value: '1'
                    - type: STRING
                      name: columns.9.item
                      value: kernel
                    - type: STRING
                      name: columns.9.name
                      value: Kernel
                    - type: STRING
                      name: columnsthresholds.2.color.0
                      value: FFD54F
                    - type: STRING
                      name: columnsthresholds.2.color.1
                      value: FF465C
                    - type: STRING
                      name: columnsthresholds.2.threshold.0
                      value: '70'
                    - type: STRING
                      name: columnsthresholds.2.threshold.1
                      value: '80'
                    - type: STRING
                      name: columnsthresholds.3.color.0
                      value: FFD54F
                    - type: STRING
                      name: columnsthresholds.3.color.1
                      value: FF465C
                    - type: STRING
                      name: columnsthresholds.3.threshold.0
                      value: '70'
                    - type: STRING
                      name: columnsthresholds.3.threshold.1
                      value: '80'
                    - type: STRING
                      name: reference
                      value: PLCAI
                - type: svggraph
                  name: CPU
                  'y': '3'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00BFFF
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'cpu utlization'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '1'
                    - type: INTEGER
                      name: ds.0.width
                      value: '4'
                    - type: STRING
                      name: reference
                      value: ILZAT
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: memory
                  'y': '8'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: BFFF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '6'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'memory utilization'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '1'
                    - type: INTEGER
                      name: ds.0.width
                      value: '4'
                    - type: STRING
                      name: reference
                      value: HXRXW
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: item
                  name: 'Memory Total'
                  x: '36'
                  'y': '3'
                  width: '13'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Linux by Agentless'
                        key: system.memory.total
                - type: item
                  name: 'Load Avg 15m'
                  x: '36'
                  'y': '5'
                  width: '13'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Linux by Agentless'
                        key: system.loadavg.15m
                - type: problems
                  x: '36'
                  'y': '7'
                  width: '36'
                  height: '3'
                  fields:
                    - type: STRING
                      name: reference
                      value: JEAQA
                    - type: INTEGER
                      name: show_lines
                      value: '10'
                    - type: INTEGER
                      name: show_opdata
                      value: '1'
                - type: item
                  name: 'CPU Total'
                  x: '49'
                  'y': '3'
                  width: '12'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Linux by Agentless'
                        key: system.cpucount
                - type: item
                  name: Uptime
                  x: '49'
                  'y': '5'
                  width: '12'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Linux by Agentless'
                        key: system.uptime
                - type: item
                  name: 'Ubuntu Version'
                  x: '61'
                  'y': '3'
                  width: '11'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '30'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Linux by Agentless'
                        key: system.os.info
                    - type: INTEGER
                      name: units_size
                      value: '30'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: item
                  name: Hostname
                  x: '61'
                  'y': '5'
                  width: '11'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '30'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Linux by Agentless'
                        key: system.hostname
                    - type: INTEGER
                      name: units_size
                      value: '30'
                    - type: INTEGER
                      name: value_size
                      value: '30'
      valuemaps:
        - uuid: 75251df6fc5a4bc6b29c9fe6007c7cfe
          name: status
          mappings:
            - value: '1'
              newvalue: Up
            - value: '0'
              newvalue: Down
  triggers:
    - uuid: 1a00d781791b435f98dd9c087d947b0f
      expression: |
        (
         avg(/Template Linux by Agentless/system.loadavg.1m,15m) 
         / last(/Template Linux by Agentless/system.cpucount)
         > {$LOAD_AVG_PER_CPU.MAX.WARN}
        ) and
        (
         min(/Template Linux by Agentless/system.loadavg.5m,#15) > 2
        ) and
        (
         min(/Template Linux by Agentless/system.loadavg.15m,#15) > 2
        )
      name: 'High System Load  on {HOST.NAME}'
      opdata: 'Server Load: {ITEM.LASTVALUE}'
      priority: WARNING
      tags:
        - tag: Event
          value: system-load
        - tag: Type
          value: SSH
    - uuid: 3bf24ff4d2564832a0b17385a6d9068b
      expression: |
        min(/Template Linux by Agentless/system.loadavg.1m,5m) 
         / last(/Template Linux by Agentless/system.cpucount)
         > {$LOAD_AVG_PER_CPU.MAX.WARN}
         and last(/Template Linux by Agentless/system.loadavg.5m) >2
         and last(/Template Linux by Agentless/system.loadavg.15m) >2
      name: 'Load Average is High {HOST.NAME}'
      opdata: 'Server Load: {ITEM.LASTVALUE}'
      priority: AVERAGE
      tags:
        - tag: Event
          value: system-load
        - tag: Type
          value: SSH
  graphs:
    - uuid: 860b4b47a7b04d8eb8d03a8cb779d780
      name: 'CPU Usage'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.cpu.idle
        - sortorder: '1'
          color: '274482'
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.cpu.nice
        - sortorder: '2'
          color: F63100
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.cpu.system
        - sortorder: '3'
          color: 2774A4
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.cpu.user
    - uuid: 597b57651f4540e5858cab1eb62ed9de
      name: 'CPU Utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: FILLED_REGION
          color: D4E157
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.cpu.util
    - uuid: 26f21c8df1814f48b682c1fc3e1a4e21
      name: 'Load Average'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: FFB74D
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.loadavg.1m
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: 80FF00
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.loadavg.5m
        - sortorder: '2'
          drawtype: GRADIENT_LINE
          color: FF7043
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.loadavg.15m
    - uuid: dd44c22902fc4b42b9bfc41540ea6201
      name: 'Memory Usage'
      graph_items:
        - color: FFFF00
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.memory.avail
        - sortorder: '1'
          color: '274482'
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.memory.free
        - sortorder: '2'
          color: 00FF00
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.memory.total
    - uuid: 2df722bddb2a4234b1466a2875642dcf
      name: 'Memory Utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: FILLED_REGION
          color: F57C00
          item:
            host: 'Template Linux by Agentless'
            key: system.memory.util
    - uuid: 813e6bf933c244ddac58e0a3e18a0450
      name: 'SSH health'
      yaxismax: '2'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: BOLD_LINE
          color: 0040FF
          calc_fnc: ALL
          item:
            host: 'Template Linux by Agentless'
            key: system.ssh.health
