<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:34:33Z</date><groups><group><name>Templates/Operating Systems</name></group></groups><templates><template><template>OS Windows WMI</template><name>OS Windows WMI</name><description>## Overview

Template for receiving stats with zbxwmi script. This method allows to retrieve stats remotely by WMI without installing agent to OS.


You can get script from: &lt;https://github.com/13hakta/zbxwmi&gt; - with tips and installation manual.


Requires python 3 script (check link above).



## Author

Vitaly Chekryzhev

</description><groups><group><name>Templates/Operating Systems</name></group></groups><applications><application><name>Storage</name></application><application><name>WMI</name></application></applications><items><item><name>CPU #1</name><type>DEPENDENT</type><key>cpu1</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[0].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #2</name><type>DEPENDENT</type><key>cpu2</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[1].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #3</name><type>DEPENDENT</type><key>cpu3</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[2].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #4</name><type>DEPENDENT</type><key>cpu4</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[3].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #5</name><type>DEPENDENT</type><key>cpu5</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[4].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #6</name><type>DEPENDENT</type><key>cpu6</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[5].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #7</name><type>DEPENDENT</type><key>cpu7</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[6].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>CPU #8</name><type>DEPENDENT</type><key>cpu8</key><delay>0</delay><value_type>FLOAT</value_type><units>Percent</units><applications><application><name>WMI</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[7].PercentProcessorTime</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>Read / sec</name><type>DEPENDENT</type><key>DiskReadsPersec</key><delay>0</delay><applications><application><name>Storage</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[0].DiskReadsPersec</params></step><step><type>SIMPLE_CHANGE</type><params/></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;DiskWritesPersec,DiskWriteBytesPersec,DiskReadsPersec,DiskReadBytesPersec&quot;,&quot;-filter&quot;,&quot;Name='_Total'&quot;,&quot;Win32_PerfRawData_PerfDisk_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>Writes / sec</name><type>DEPENDENT</type><key>DiskWritesPersec</key><delay>0</delay><applications><application><name>Storage</name></application></applications><preprocessing><step><type>JSONPATH</type><params>$[0].DiskWritesPersec</params></step><step><type>SIMPLE_CHANGE</type><params/></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;DiskWritesPersec,DiskWriteBytesPersec,DiskReadsPersec,DiskReadBytesPersec&quot;,&quot;-filter&quot;,&quot;Name='_Total'&quot;,&quot;Win32_PerfRawData_PerfDisk_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key></master_item></item><item><name>Disk I/O</name><type>EXTERNAL</type><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;DiskWritesPersec,DiskWriteBytesPersec,DiskReadsPersec,DiskReadBytesPersec&quot;,&quot;-filter&quot;,&quot;Name='_Total'&quot;,&quot;Win32_PerfRawData_PerfDisk_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key><delay>5m</delay><history>3600</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>Storage</name></application></applications></item><item><name>Processors</name><type>EXTERNAL</type><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-fields&quot;,&quot;PercentProcessorTime&quot;,&quot;-filter&quot;,&quot;Name&lt;&gt;'_Total'&quot;,&quot;Win32_PerfFormattedData_PerfOS_Processor&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key><delay>5m</delay><history>3600</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>WMI</name></application></applications></item></items><discovery_rules><discovery_rule><name>Find drive</name><type>EXTERNAL</type><key>zbxwmi[&quot;-action&quot;,&quot;discover&quot;,&quot;-k&quot;,&quot;DeviceID&quot;,&quot;-fields&quot;,&quot;VolumeName&quot;,&quot;-filter&quot;,&quot;MediaType=12&quot;,&quot;Win32_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,{HOST.HOST}]</key><delay>1h</delay><lifetime>7d</lifetime><description>Find local disk drive</description><item_prototypes><item_prototype><name>Free Space {#WMI.DEVICEID}</name><type>DEPENDENT</type><key>FreeSpace[{#WMI.DEVICEID}]</key><delay>0</delay><units>byte</units><applications><application><name>WMI</name></application></applications><application_prototypes><application_prototype><name>Disk</name></application_prototype></application_prototypes><preprocessing><step><type>JSONPATH</type><params>$[0].FreeSpace</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-k&quot;,&quot;DeviceID&quot;,&quot;-fields&quot;,&quot;FreeSpace,Size&quot;,&quot;-item&quot;,&quot;{#WMI.DEVICEID}&quot;,&quot;Win32_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,&quot;{HOST.HOST}&quot;]</key></master_item><trigger_prototypes><trigger_prototype><expression>{avg(7200)}&lt;2147483648</expression><name>Low disk space</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Size {#WMI.DEVICEID}</name><type>DEPENDENT</type><key>Size[{#WMI.DEVICEID}]</key><delay>0</delay><units>byte</units><applications><application><name>WMI</name></application></applications><application_prototypes><application_prototype><name>Disk</name></application_prototype></application_prototypes><preprocessing><step><type>JSONPATH</type><params>$[0].Size</params></step></preprocessing><master_item><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-k&quot;,&quot;DeviceID&quot;,&quot;-fields&quot;,&quot;FreeSpace,Size&quot;,&quot;-item&quot;,&quot;{#WMI.DEVICEID}&quot;,&quot;Win32_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,&quot;{HOST.HOST}&quot;]</key></master_item></item_prototype><item_prototype><name>Used {#WMI.DEVICEID}</name><type>CALCULATED</type><key>Used[{#WMI.DEVICEID}]</key><delay>5m</delay><units>byte</units><params>last(Size[{#WMI.DEVICEID}])-last(FreeSpace[{#WMI.DEVICEID}])</params><applications><application><name>WMI</name></application></applications><application_prototypes><application_prototype><name>Disk</name></application_prototype></application_prototypes></item_prototype><item_prototype><name>Disk info {#WMI.DEVICEID}</name><type>EXTERNAL</type><key>zbxwmi[&quot;-action&quot;,&quot;json&quot;,&quot;-k&quot;,&quot;DeviceID&quot;,&quot;-fields&quot;,&quot;FreeSpace,Size&quot;,&quot;-item&quot;,&quot;{#WMI.DEVICEID}&quot;,&quot;Win32_LogicalDisk&quot;,&quot;{$WMI_AUTHFILE}&quot;,&quot;{HOST.HOST}&quot;]</key><delay>5m</delay><history>3600</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>WMI</name></application></applications><application_prototypes><application_prototype><name>Disk</name></application_prototype></application_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><name>Disk space {#WMI.DEVICEID} ({#WMI.VOLUMENAME})</name><width>500</width><height>120</height><show_work_period>NO</show_work_period><show_triggers>NO</show_triggers><ymin_type_1>FIXED</ymin_type_1><ymax_type_1>ITEM</ymax_type_1><ymax_item_1><host>OS Windows WMI</host><key>Size[{#WMI.DEVICEID}]</key></ymax_item_1><graph_items><graph_item><color>FFFFFF</color><item><host>OS Windows WMI</host><key>Size[{#WMI.DEVICEID}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>FILLED_REGION</drawtype><color>3333FF</color><item><host>OS Windows WMI</host><key>Used[{#WMI.DEVICEID}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>DD0000</color><item><host>OS Windows WMI</host><key>FreeSpace[{#WMI.DEVICEID}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule></discovery_rules><macros><macro><macro>{$WMI_AUTHFILE}</macro><value>/etc/zabbix/wmi.pw</value></macro></macros></template></templates><graphs><graph><name>Disk I/O</name><ymin_type_1>FIXED</ymin_type_1><graph_items><graph_item><color>1A7C11</color><item><host>OS Windows WMI</host><key>DiskReadsPersec</key></item></graph_item><graph_item><sortorder>1</sortorder><color>F63100</color><item><host>OS Windows WMI</host><key>DiskWritesPersec</key></item></graph_item></graph_items></graph><graph><name>Processors</name><width>500</width><show_work_period>NO</show_work_period><show_triggers>NO</show_triggers><ymin_type_1>FIXED</ymin_type_1><ymax_type_1>FIXED</ymax_type_1><graph_items><graph_item><drawtype>FILLED_REGION</drawtype><color>00CC00</color><item><host>OS Windows WMI</host><key>cpu1</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>FILLED_REGION</drawtype><color>009900</color><item><host>OS Windows WMI</host><key>cpu2</key></item></graph_item><graph_item><sortorder>2</sortorder><drawtype>FILLED_REGION</drawtype><color>007700</color><item><host>OS Windows WMI</host><key>cpu3</key></item></graph_item><graph_item><sortorder>3</sortorder><drawtype>FILLED_REGION</drawtype><color>004400</color><item><host>OS Windows WMI</host><key>cpu4</key></item></graph_item><graph_item><sortorder>4</sortorder><drawtype>FILLED_REGION</drawtype><color>3333FF</color><item><host>OS Windows WMI</host><key>cpu5</key></item></graph_item><graph_item><sortorder>5</sortorder><drawtype>FILLED_REGION</drawtype><color>0000DD</color><item><host>OS Windows WMI</host><key>cpu6</key></item></graph_item><graph_item><sortorder>6</sortorder><drawtype>FILLED_REGION</drawtype><color>0000AA</color><item><host>OS Windows WMI</host><key>cpu7</key></item></graph_item><graph_item><sortorder>7</sortorder><drawtype>FILLED_REGION</drawtype><color>000044</color><item><host>OS Windows WMI</host><key>cpu8</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
