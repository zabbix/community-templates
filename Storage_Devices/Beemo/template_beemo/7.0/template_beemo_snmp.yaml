zabbix_export:
  version: '7.0'
  templates:
    - uuid: 70ef1ca728c94846ad4b51b9c62da83a
      template: Template_SNMP_Beemo_Custom
      name: 'Template SNMP Beemo (SNMP only)'
      groups:
        - name: Templates
      description: 'Beemo backup server monitoring via SNMP (CPU, RAM, Swap, Disk, Traffic, Load).'

      items:
        - uuid: ce466e96df414e4faea50c5db93d884b
          name: System description
          type: SNMP_AGENT
          key: beemo.sysDescr
          value_type: TEXT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          delay: 6h

        - uuid: dab9ac2d84ec41218bc9f9580858dde9
          name: System name
          type: SNMP_AGENT
          key: beemo.sysName
          value_type: TEXT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          delay: 6h

        - uuid: 72e7ace013fa4752b4de72eade9ebda2
          name: System uptime
          type: SNMP_AGENT
          key: beemo.sysUpTime
          value_type: UNSIGNED
          units: uptime
          snmp_oid: 1.3.6.1.2.1.1.3.0
          delay: 5m

        - uuid: dab5598f5ed7418087c88fc45fe9dc5d
          name: Load average (1m)
          type: SNMP_AGENT
          key: beemo.load.1m
          value_type: FLOAT
          snmp_oid: 1.3.6.1.4.1.2021.10.1.3.1
          delay: 1m

        - uuid: b657602dffa84d2b84af40fe54cdd23a
          name: Load average (5m)
          type: SNMP_AGENT
          key: beemo.load.5m
          value_type: FLOAT
          snmp_oid: 1.3.6.1.4.1.2021.10.1.3.2
          delay: 1m

        - uuid: ffd9f531fa5a48a7803e4a90400a160c
          name: Load average (15m)
          type: SNMP_AGENT
          key: beemo.load.15m
          value_type: FLOAT
          snmp_oid: 1.3.6.1.4.1.2021.10.1.3.3
          delay: 1m

      discovery_rules:
        - uuid: d11203d7df6648dfb70cc37f03a12adc
          name: CPU core discovery
          type: SNMP_AGENT
          key: beemo.cpu.discovery
          delay: 1h
          snmp_oid: discovery[{#CPUINDEX},1.3.6.1.2.1.25.3.3.1.1]
          item_prototypes:
            - uuid: 566870dd9d9f460eb7e12599acd303af
              name: CPU core {#CPUINDEX} load
              type: SNMP_AGENT
              key: beemo.cpu.load[{#CPUINDEX}]
              value_type: UNSIGNED
              units: '%'
              snmp_oid: 1.3.6.1.2.1.25.3.3.1.2.{#CPUINDEX}
              delay: 1m

        - uuid: 13bc1c976d484c579178a38406b80fa7
          name: Network interface discovery
          type: SNMP_AGENT
          key: beemo.if.discovery
          delay: 1h
          snmp_oid: discovery[{#IFINDEX},1.3.6.1.2.1.2.2.1.1,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1]
          item_prototypes:
            - uuid: 33667758981f4eeabb2b323dbe037e24
              name: Interface {#IFNAME} inbound traffic
              type: SNMP_AGENT
              key: beemo.net.if.in.bps[{#IFINDEX}]
              value_type: UNSIGNED
              units: bps
              snmp_oid: 1.3.6.1.2.1.31.1.1.1.6.{#IFINDEX}
              delay: 1m
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'

            - uuid: e5b2d95715644d5db523a6c744e55d0f
              name: Interface {#IFNAME} outbound traffic
              type: SNMP_AGENT
              key: beemo.net.if.out.bps[{#IFINDEX}]
              value_type: UNSIGNED
              units: bps
              snmp_oid: 1.3.6.1.2.1.31.1.1.1.10.{#IFINDEX}
              delay: 1m
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
          graph_prototypes:
            - uuid: 6da13c79d2bb4a95a739774fcd9d4b4e
              name: 'Traffic on {#IFNAME}'
              graph_items:
                - sortorder: '0'
                  color: 1A7CFF
                  item:
                    host: Template_SNMP_Beemo_Custom
                    key: beemo.net.if.in.bps[{#IFINDEX}]
                - sortorder: '1'
                  color: FF4D4D
                  item:
                    host: Template_SNMP_Beemo_Custom
                    key: beemo.net.if.out.bps[{#IFINDEX}]

        - uuid: 0da1c6bed68b4d8e9de89dd970b5f2aa
          name: Swap discovery (hrStorageVirtualMemory)
          type: SNMP_AGENT
          key: beemo.swap.discovery
          delay: 1h
          snmp_oid: discovery[{#STORAGEINDEX},1.3.6.1.2.1.25.2.3.1.1,{#STORAGEDESC},1.3.6.1.2.1.25.2.3.1.3,{#STORAGETYPE},1.3.6.1.2.1.25.2.3.1.2,{#ALLOC},1.3.6.1.2.1.25.2.3.1.4]
          filter:
            evaltype: AND_OR
            conditions:
              - formulaid: A
                macro: '{#STORAGETYPE}'
                value: '^1\.3\.6\.1\.2\.1\.25\.2\.1\.3$'
                operator: MATCHES_REGEX
          item_prototypes:
            - uuid: 5fdb4cc6ecb94a44a34d53209aaa5af2
              name: Swap total (bytes)
              type: SNMP_AGENT
              key: beemo.swap.total[{#STORAGEINDEX}]
              value_type: FLOAT
              units: B
              snmp_oid: 1.3.6.1.2.1.25.2.3.1.5.{#STORAGEINDEX}
              delay: 2m
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC}'
            - uuid: b89c66e41de0441e8e91d8e78cf481d5
              name: Swap used (bytes)
              type: SNMP_AGENT
              key: beemo.swap.used[{#STORAGEINDEX}]
              value_type: FLOAT
              units: B
              snmp_oid: 1.3.6.1.2.1.25.2.3.1.6.{#STORAGEINDEX}
              delay: 2m
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC}'
            - uuid: 4265965d1a7d411eb0a2f4dfb262d2ff
              name: Swap used (%)
              type: CALCULATED
              key: beemo.swap.used.pct[{#STORAGEINDEX}]
              value_type: FLOAT
              units: '%'
              delay: 1m
              params: '100*last(//beemo.swap.used[{#STORAGEINDEX}])/last(//beemo.swap.total[{#STORAGEINDEX}])'
          trigger_prototypes:
            - uuid: 81de6c5423aa4f098d6057be8ef7ac50
              name: 'Swap usage HIGH (> 30%)'
              expression: 'last(/Template_SNMP_Beemo_Custom/beemo.swap.used.pct[{#STORAGEINDEX}])>30'
              priority: HIGH
            - uuid: 76c2428db2a947dc84e44b76567ad3b4
              name: 'Swap usage WARNING (> 20%)'
              expression: 'last(/Template_SNMP_Beemo_Custom/beemo.swap.used.pct[{#STORAGEINDEX}])>20'
              priority: WARNING

        - uuid: 437c1b7cd6ec4acfb6c7d2e0ece5ab0f
          name: Filesystem discovery (hrStorage)
          type: SNMP_AGENT
          key: beemo.fs.discovery
          delay: 1h
          snmp_oid: discovery[{#STORAGEINDEX},1.3.6.1.2.1.25.2.3.1.1,{#STORAGEDESC},1.3.6.1.2.1.25.2.3.1.3,{#ALLOC},1.3.6.1.2.1.25.2.3.1.4]
          item_prototypes:
            - uuid: cd08d9a2a77e477d8e954946e412e50d
              name: 'FS {#STORAGEDESC} total (bytes)'
              type: SNMP_AGENT
              key: beemo.fs.total[{#STORAGEINDEX}]
              value_type: FLOAT
              units: B
              snmp_oid: 1.3.6.1.2.1.25.2.3.1.5.{#STORAGEINDEX}
              delay: 5m
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC}'
            - uuid: 09c0918e133a4dfda011e8d67bd68299
              name: 'FS {#STORAGEDESC} used (bytes)'
              type: SNMP_AGENT
              key: beemo.fs.used[{#STORAGEINDEX}]
              value_type: FLOAT
              units: B
              snmp_oid: 1.3.6.1.2.1.25.2.3.1.6.{#STORAGEINDEX}
              delay: 5m
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOC}'
            - uuid: 0b67c4eff61947698089c46087f0cf4d
              name: 'FS {#STORAGEDESC} used (%)'
              type: CALCULATED
              key: beemo.fs.used.pct[{#STORAGEINDEX}]
              value_type: FLOAT
              units: '%'
              delay: 5m
              params: '100*last(//beemo.fs.used[{#STORAGEINDEX}])/last(//beemo.fs.total[{#STORAGEINDEX}])'
          trigger_prototypes:
            - uuid: 16244f463e2c4ad79da30e010ce64584
              name: 'FS {#STORAGEDESC} usage HIGH (> 90%)'
              expression: 'last(/Template_SNMP_Beemo_Custom/beemo.fs.used.pct[{#STORAGEINDEX}])>90'
              priority: HIGH
            - uuid: 2213e033d74f4de586121caaea3828ca
              name: 'FS {#STORAGEDESC} usage WARNING (> 80%)'
              expression: 'last(/Template_SNMP_Beemo_Custom/beemo.fs.used.pct[{#STORAGEINDEX}])>80'
              priority: WARNING
