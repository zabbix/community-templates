zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 4e8b8e2411464385a17fa8df203e0e4c
      name: 'DLA::Designed::'
    - uuid: 42f5db1b12bb445087b7cdd50a725f36
      name: 'MikroTik ROSE'
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 9d64d0a31a1f4be39258c56c487d0121
      template: 'MikroTik ROSE RDS2216'
      name: 'MikroTik ROSE RDS2216'
      description: |
        # MikroTik RDS2216 ROSE Storage Switch Monitoring Template
        
        ## Overview
        Comprehensive monitoring solution for MikroTik RDS2216-2XG-4S+4XS-2XQ ROSE (RouterOS Enhanced Storage) switches. This template provides complete visibility into enterprise NVMe storage systems with RAID management, utilizing both SNMP for system health and MikroTik REST API for advanced 64-bit storage metrics.
        
        **Hardware Specifications:**
        - Model: RDS2216-2XG-4S+4XS-2XQ
        - CPU: AMD EPYC Embedded 3151 (4 cores @ 2.7 GHz)
        - RAM: 32GB DDR4 ECC
        - Storage: 5× NVMe drive bays supporting U.2/U.3 drives
        - Network: 2× 10GbE RJ45, 4× 25GbE SFP28, 4× 10GbE SFP+, 2× 100GbE QSFP28
        - RAID: Software RAID (mdadm) with hardware acceleration
        - OS: RouterOS with integrated storage controller
        
        ## Capabilities
        
        ### Black-Box Availability Monitoring
        * **ICMP Ping** - Network layer reachability verification with packet loss and latency tracking
        * **SNMP Availability** - SNMP agent health check with automatic fault detection
        * **Uptime Tracking** - System and SNMP agent uptime monitoring with restart detection
        
        ### Storage Monitoring (REST API - 64-bit metrics)
        **Backplane PCIe Bridge Discovery (13 items)**
          ✓ Model and interface identification (PCIe generation/speed)
          ✓ Interface speed monitoring (8GT/s tracking)
          ✓ I/O throughput (read/write bytes and operations)
          ✓ I/O performance (operation merges, in-flight operations)
          ✓ Queue statistics (wait time, active time)
        
        **RAID Array Discovery (36 items, 4 triggers)**
          ✓ RAID health and state monitoring (active/degraded/resyncing)
          ✓ Capacity tracking (total/free space with 64-bit support)
          ✓ Space utilization percentage with threshold alerts
          ✓ RAID configuration (type, UUID, chunk size, device count)
          ✓ Filesystem monitoring (type, mount point, read-only detection, inode tracking)
          ✓ I/O performance (read/write ops/bytes/time/merges)
          ✓ Queue statistics (in-flight ops, wait time, active time, flush ops)
          ✓ TRIM/Discard monitoring (bytes/ops/merges/time)
        
        **NVMe Drive Discovery (51 items, 8 triggers)**
          ✓ Drive identification (model, serial, firmware, size)
          ✓ Interface monitoring (PCIe type and speed in bps)
          ✓ Temperature tracking (current, all sensors, critical/warning thresholds and timers)
          ✓ Health metrics (available spare, spare threshold, wear level/percentage-used)
          ✓ Critical warnings and data integrity errors
          ✓ SMART statistics (power-on time, power cycles, controller busy time)
          ✓ Host I/O tracking (read/write bytes and commands)
          ✓ RAID membership (member state, failed status, role, master device)
          ✓ I/O performance (read/write ops/bytes/time/merges, queue stats)
          ✓ TRIM/Discard statistics (bytes/ops/merges/time)
          ✓ Security features (TCG Opal self-encryption support/enabled)
          ✓ Parent device tracking
        
        ### System Health Monitoring (SNMP)
        **Hardware Sensors** (Dynamic discovery)
          ✓ Temperature sensors (board, CPU, fan, PSU, PCIe, PHY, SFP, switch) with critical/warning thresholds
          ✓ Fan speed monitoring (RPM for all fans and PSU fans)
          ✓ Voltage sensors (PSU input voltage)
          ✓ Power consumption (per-PSU wattage)
          ✓ Hardware state sensors (fan-state, psu1-state, psu2-state failure detection)
        
        **CPU and Memory**
          ✓ Multi-core CPU load average per processor
          ✓ Memory utilization (used/total/percentage)
          ✓ High CPU utilization alerts
          ✓ Memory exhaustion warnings
        
        **Network Interfaces** (Dynamic discovery)
          ✓ Interface operational status and speed
          ✓ Traffic statistics (inbound/outbound octets)
          ✓ Error counters (inbound/outbound errors and discards)
          ✓ Interface utilization percentage
          ✓ Link status change detection
          ✓ High error rate alerts
        
        **System Information**
          ✓ System description and firmware version
          ✓ Hardware model and serial number
          ✓ System name, location, contact
          ✓ Firmware change detection
          ✓ Configuration change tracking
        
        ## Trigger Philosophy
        
        All triggers follow Zabbix best practices and NOC-optimized design:
        
        **Storage Triggers:**
        * **DISASTER (4)** - RAID array not active/clean, NVMe RAID member failed, critical warning detected, data integrity errors
        * **HIGH (4)** - NVMe spare blocks critically low, temperature critical, filesystem mounted read-only, hardware sensor failure
        * **AVERAGE (4)** - RAID disk space critically low (>90%), NVMe temperature high, wear level high, SNMP unavailable
        * **WARNING (3)** - RAID disk space low (>80%), NVMe unsafe shutdown, high ICMP response time
        
        **System Triggers:**
        * **HIGH (2)** - ICMP unreachable, interface operational down, CPU utilization critical
        * **AVERAGE (1)** - Memory utilization high
        * **WARNING (5)** - System restart, firmware changed, high ICMP loss, interface speed degraded, high interface errors
        
        **Manual Closure:**
          • All triggers support manual_close for NOC acknowledgment tracking
          • Prevents alarm auto-clearing during intermittent conditions
          • Ensures proper investigation and documentation
        
        ## Technical Details
        
        ### Monitoring Methods
        **SNMP (System Health)**
        * **Protocol**: SNMPv2c/v3
        * **Standard MIBs**: SNMPv2-MIB (system), HOST-RESOURCES-MIB (CPU, memory, uptime), IF-MIB (interfaces)
        * **MikroTik MIBs**: MIKROTIK-MIB (serial number, health sensors)
        * **Collection Method**: Native Zabbix SNMP agent
        * **Polling Intervals**: 1m (critical metrics) to 1h (inventory)
        
        **REST API (Storage Metrics)**
        * **Endpoint**: http://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk
        * **Authentication**: HTTP BASIC with {$MIKROTIK.API.USER}/{$MIKROTIK.API.PASSWORD}
        * **Data Format**: JSON array of disk objects
        * **Advantages**: 64-bit integer support (no overflow on 60TB+ volumes)
        * **Discovery**: JavaScript-based LLD filtering by device type
        * **Polling Intervals**: 1h (low-change metrics)
        
        ### Device Type Classification
        1. **Backplane** - PCIe bridge device (type=hardware, slot-default=backplane)
        2. **RAID Array** - Aggregated storage (type=raid)
        3. **NVMe Drives** - Physical SSDs (type=hardware, slot-default=nvme[0-9]+)
        
        ### Item Statistics
        * **Total Items**: ~130 (varies with discovered devices)
        * **SNMP Items**: ~30 base + dynamic discoveries (CPU, memory, sensors, interfaces)
        * **REST API Items**: 100 (13 backplane + 36 RAID + 51 NVMe per device)
        * **Collection Intervals**: 1m-1h depending on metric criticality
        * **History Retention**: 7d-90d based on item type
        
        ### Trigger Statistics
        * **Total Triggers**: ~25 base + dynamic discoveries
        * **Manual Close**: 100% enabled
        * **Expression Types**: Simple threshold, change detection, dependency chains
        * **Recovery Expressions**: Automatic (value returns to normal)
        
        ### User Macros (Customizable Thresholds)
        **Network:**
        * {$ICMP_LOSS_WARN} = 20 - ICMP packet loss warning (%)
        * {$ICMP_RESPONSE_TIME_WARN} = 0.15 - ICMP response time warning (s)
        * {$IF.ERRORS.WARN} = 2 - Interface error rate warning
        * {$IF.UTIL.MAX} = 90 - Interface utilization max (%)
        
        **System:**
        * {$CPU.UTIL.CRIT} = 90 - CPU utilization critical (%)
        * {$MEMORY.UTIL.MAX} = 90 - Memory utilization max (%)
        * {$TEMP_WARN} = 70 - Temperature warning (°C)
        * {$TEMP_CRIT} = 80 - Temperature critical (°C)
        
        **Storage:**
        * {$VFS.FS.PUSED.MAX.WARN} = 80 - Disk space warning (%)
        * {$VFS.FS.PUSED.MAX.CRIT} = 90 - Disk space critical (%)
        * {$VFS.FS.FREE.MIN.WARN} = 20 - Free space warning (%)
        * {$VFS.FS.FREE.MIN.CRIT} = 10 - Free space critical (%)
        * {$VFS.FS.WEAR.MAX.WARN} = 80 - NVMe wear level warning (%)
        
        **API Connection:**
        * {$MIKROTIK.API.SCHEME} = http - REST API protocol
        * {$MIKROTIK.API.PORT} = 80 - REST API port
        * {$MIKROTIK.API.USER} = apiuser - REST API username
        * {$MIKROTIK.API.PASSWORD} = changeme - REST API password
        
        ### Value Mappings
        * **Service state** - ICMP ping (Down/Up)
        * **zabbix.host.available** - SNMP availability (not available/available/unknown)
        * **IF-MIB::ifOperStatus** - Interface operational status
        * **IF-MIB::ifType** - Interface type classification
        * **Hardware State** - Sensor status (OK/FAILED)
        
        ## Use Cases
        
        ### Enterprise Storage Arrays
        * Monitor high-capacity NVMe storage systems (60TB+ RAID arrays)
        * Track RAID health and rebuild status in real-time
        * Predict drive failures before data loss occurs
        * Monitor storage performance for SLA compliance
        
        ### Data Center Infrastructure
        * Centralized storage monitoring for virtualization clusters
        * Track storage I/O performance and capacity trends
        * Ensure redundancy and failover readiness
        * Monitor temperature and power consumption for cooling optimization
        
        ### High-Availability Systems
        * Monitor RAID degradation and drive failures
        * Track NVMe wear level for proactive replacement
        * Detect unsafe shutdowns indicating power issues
        * Ensure storage system uptime for critical workloads
        
        ### Network Operations Center (NOC)
        Provides NOC operators with:
        * Clear fault identification with severity-based alerting
        * Comprehensive SMART data for drive health assessment
        * Historical trending for capacity planning
        * Detailed troubleshooting data for escalation
        * Manual acknowledgment tracking for incident management
        
        ## Installation & Requirements
        
        ### Prerequisites
        * Zabbix Server 7.2 or higher (requires Duktape JavaScript for LLD)
        * SNMP access to MikroTik RDS2216 (SNMPv2c or SNMPv3)
        * HTTP/HTTPS access to MikroTik REST API (port 80/443)
        * Network connectivity (ICMP, UDP 161, TCP 80/443)
        * Valid SNMP community string or SNMPv3 credentials
        * Valid REST API user credentials
        
        ### Setup Steps
        1. **Import Template**
           - Zabbix web interface → Configuration → Templates → Import
           - Select mikrotik_rds_rose.json
           - Verify import success
        
        2. **Configure Device**
           - Enable SNMP on RDS2216: `/snmp set enabled=yes`
           - Set SNMP community: `/snmp community add name=public addresses=ZABBIX_IP/32`
           - Enable REST API: `/ip service enable www`
           - Create API user: `/user add name=apiuser password=STRONG_PASSWORD group=read`
           - Configure system info: `/snmp set contact="NOC" location="DC01"`
        
        3. **Create Zabbix Host**
           - Add new host with device IP address
           - Configure SNMP interface (SNMPv2c or SNMPv3)
           - Link template "MikroTik RDS2216 SNMP"
        
        4. **Configure Macros** (Host or Template level)
           - {$MIKROTIK.API.USER} = your_api_username
           - {$MIKROTIK.API.PASSWORD} = your_api_password
           - {$MIKROTIK.API.PORT} = 80 (or 443 for HTTPS)
           - {$MIKROTIK.API.SCHEME} = http (or https)
           - Adjust threshold macros as needed
        
        5. **Verify Data Collection**
           - Check Latest Data for ICMP ping (should be 1)
           - Verify SNMP data (system description, uptime)
           - Confirm REST API discoveries (Backplane, RAID, NVMe)
           - Review graphs for proper data visualization
           - Test trigger functionality if possible
        
        ### Recommended Actions
        * **DISASTER triggers** → Immediate page to storage/NOC team
        * **HIGH triggers** → Create high-priority ticket, escalate if not acknowledged within 30 minutes
        * **AVERAGE triggers** → Standard priority ticket for investigation
        * **WARNING triggers** → Informational ticket for tracking and maintenance scheduling
        
        ## Troubleshooting
        
        ### No SNMP Data Collected
        1. Verify SNMP enabled: `/snmp print`
        2. Test SNMP access: `snmpwalk -v2c -c <community> <ip> 1.3.6.1.2.1.1`
        3. Check firewall rules (UDP port 161)
        4. Verify SNMP community/credentials in Zabbix
        5. Review Zabbix server logs for SNMP errors
        
        ### No REST API Data (Storage Metrics)
        1. Verify API service enabled: `/ip service print`
        2. Test API access: `curl -u user:pass http://<ip>/rest/disk`
        3. Check firewall rules (TCP port 80/443)
        4. Verify API credentials in Zabbix macros
        5. Review item preprocessing errors in Zabbix
        6. Check JavaScript errors in LLD rules
        
        ### REST API Returns Empty Array
        1. Verify storage devices present: `/disk print`
        2. Check if drives are initialized: `/disk firmware-upgrade print`
        3. Review RouterOS storage configuration
        4. Ensure RAID array is created and active
        
        ### False Positive: RAID Array Not Active
        * RAID state "clean" is normal (trigger excludes this)
        * If trigger fires on "clean", verify trigger expression
        * Common states: active, clean, degraded, resyncing, recovering
        
        ### NVMe Critical Warning False Positives
        * Empty string ("") indicates no warning (normal)
        * Trigger only fires if not empty AND not "none"
        * Check actual critical-warning value in Latest Data
        
        ### Incorrect Storage Capacity (Negative Values)
        * This template uses REST API specifically to avoid 32-bit overflow
        * If seeing negative values, verify item is using REST API master item
        * SNMP hrStorage has 32-bit limit (max ~2TB per volume)
        
        ### Missing Temperature/Fan Sensors
        1. Not all sensors available on all hardware revisions
        2. Check sensor availability: `/system health print`
        3. Disable unsupported items rather than deleting
        4. LLD will automatically discover available sensors
        
        ### High CPU Usage on Zabbix Server
        1. Reduce polling frequency (increase intervals)
        2. Adjust history/trend retention periods
        3. Use SNMP bulk requests if available
        4. Consider SNMP traps for event-driven monitoring
        
        ## Version History
        
        ### v2.0.0 - Production Release (2025-12-06)
        **Major Rewrite:**
        * Migrated from single SNMP discovery to type-specific REST API discoveries
        * Added 3 separate LLD rules: Backplane (13 items), RAID (36 items), NVMe (51 items)
        * Implemented 64-bit storage metrics via MikroTik REST API
        * Fixed 32-bit INTEGER overflow issue on 60TB+ RAID volumes
        * Added comprehensive NVMe SMART monitoring (51 items per drive)
        * Added RAID health monitoring with state detection
        * Added I/O performance metrics (ops, bytes, time, merges, queue stats)
        * Added TRIM/discard monitoring for SSD lifetime tracking
        * Added filesystem monitoring (inodes, UUID, mount status)
        * Added TCG Opal encryption status tracking
        * Enhanced trigger logic (RAID clean state, NVMe empty warnings)
        * Fixed time value types (TEXT for MikroTik format "11w2d17h")
        * Fixed interface speed display (FLOAT/bps for Gbps conversion)
        * Added manual_close to all triggers
        * Added comprehensive template documentation
        * Added DLA::Designed:: template group
        * Total: ~130 items, ~25 triggers, 5 value maps, 27 macros, 1 graph
        
        **Author:** ://echo@dla.network [oZark oRChes✝ra✝'d]
        
        ### v1.0.0 - Initial SNMP Release
        * Basic SNMP monitoring with HOST-RESOURCES-MIB
        * Single storage discovery with 20 items
        * Limited to 32-bit storage metrics (overflow on large volumes)
        * Basic system health monitoring
        
        ## Support & Documentation
        
        ### Template Maintainer
        **Author:** ://echo@dla.network [oZark oRChes✝ra✝'d]
        
        For template issues, customization requests, or enhancement suggestions, please contact the template maintainer.
        
        ### MikroTik Resources
        * RouterOS Documentation - https://help.mikrotik.com/docs/
        * REST API Documentation - https://help.mikrotik.com/docs/display/ROS/REST+API
        * MikroTik Support - https://www.mikrotik.com/support
        
        ### Zabbix Resources
        * Template Guidelines - https://www.zabbix.com/documentation/current/manual/appendix/templates
        * JavaScript Preprocessing - https://www.zabbix.com/documentation/current/manual/config/items/preprocessing/javascript
        * HTTP Agent Items - https://www.zabbix.com/documentation/current/manual/config/items/itemtypes/http
        
        ## License & Usage
        
        This template is provided for monitoring MikroTik RDS2216 ROSE storage switches in production environments. Customize macros and thresholds as needed for your specific deployment. Share improvements with the Zabbix community.
        
        ---
        
        **Template Type:** Resource Monitoring (Storage/Network)
        **Vendor:** MikroTik
        **Device:** RDS2216-2XG-4S+4XS-2XQ ROSE Storage Switch
        **Monitoring Method:** SNMP + REST API
        **Zabbix Version:** 7.2+
        **Last Updated:** December 6, 2025
      groups:
        - name: 'DLA::Designed::'
        - name: 'MikroTik ROSE'
        - name: 'Templates/Network devices'
      items:
        - uuid: 3ae967717533412491fb556ad969cb8f
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          history: 1w
          description: 'ICMP ping availability check. Returns 1 if device responds to ping, 0 if unreachable. Used for basic reachability monitoring.'
          valuemap:
            name: 'Service state'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: a8a07254f805423f98168bf5a9f1074f
              expression: 'max(/MikroTik ROSE RDS2216/icmpping,#3)=0'
              name: 'Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
        - uuid: f675944905684ca4afdd25361a3e709e
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          history: 1w
          value_type: FLOAT
          units: '%'
          description: 'ICMP packet loss percentage over last polling interval. High packet loss indicates network congestion or connectivity issues.'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 9156f03a22814720b71f5ccec5074108
              expression: 'min(/MikroTik ROSE RDS2216/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/MikroTik ROSE RDS2216/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/MikroTik ROSE RDS2216/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 42e294d826cb483295aff33207b4a41b
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          history: 1w
          value_type: FLOAT
          units: s
          description: 'ICMP ping response time in seconds. Baseline for network latency monitoring. Sudden increases may indicate network problems.'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 5ee6898207d840379886f22228ac6040
              expression: 'avg(/MikroTik ROSE RDS2216/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: 'High ICMP ping loss'
                  expression: 'min(/MikroTik ROSE RDS2216/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/MikroTik ROSE RDS2216/icmppingloss,5m)<100'
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/MikroTik ROSE RDS2216/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: caded6dc9d3b415b9a46c9e352dae192
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          history: 2w
          value_type: LOG
          description: 'SNMP trap receiver for unsolicited notifications from device. Fallback mechanism for event-driven monitoring.'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: component
              value: network
        - uuid: a2bd8319275d41f7aaa61cc38576cd9e
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.4.0]'
          key: 'system.contact[sysContact.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: 'System administrator contact information from SNMPv2-MIB::sysContact. Configured in RouterOS under /snmp set contact=...'
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 48869a982dbc4efeace343082c847e05
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: 'System hardware description from SNMPv2-MIB::sysDescr. Shows RouterOS version and hardware model (e.g., ''RouterOS RDS2216-2XG-4S+4XS-2XQ'').'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: a31d6e3e8b7549cfbed084d2de8b0fb1
          name: 'Firmware version'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.7.4.0]'
          key: system.hw.firmware
          delay: 1h
          history: 2w
          value_type: CHAR
          description: 'RouterOS firmware version extracted from system description. Used for inventory and update tracking.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: ff2fe7b582c442cca14702c775113502
              expression: 'last(/MikroTik ROSE RDS2216/system.hw.firmware,#1)<>last(/MikroTik ROSE RDS2216/system.hw.firmware,#2) and length(last(/MikroTik ROSE RDS2216/system.hw.firmware))>0'
              name: 'Firmware has changed'
              opdata: 'Current value: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'Firmware version has changed. Ack to close'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 0a595af69a274051b0a5c7dffa479b3c
          name: 'Hardware model name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: system.hw.model
          delay: 1h
          history: 2w
          value_type: CHAR
          description: 'Hardware model name extracted from system description (e.g., ''RDS2216-2XG-4S+4XS-2XQ''). Used for hardware inventory and compatibility checking.'
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: fe9f14f9865e42d89f71668a11df224d
          name: 'Hardware serial number'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.7.3.0]'
          key: system.hw.serialnumber
          delay: 1h
          history: 2w
          value_type: CHAR
          description: 'Device hardware serial number from MIKROTIK-MIB. Used for warranty tracking and hardware inventory.'
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: edd3fe0e76cf430093e7738675aabb66
              expression: 'last(/MikroTik ROSE RDS2216/system.hw.serialnumber,#1)<>last(/MikroTik ROSE RDS2216/system.hw.serialnumber,#2) and length(last(/MikroTik ROSE RDS2216/system.hw.serialnumber))>0'
              name: 'Device has been replaced'
              event_name: 'Device has been replaced (new serial number received)'
              priority: INFO
              description: 'Device serial number has changed. Ack to close'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 8d000e5c911b42e1a973cb02624b4654
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.1.1.0]'
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: 'System uptime in seconds from HOST-RESOURCES-MIB::hrSystemUptime. Time since last hardware boot/reboot. Reset on power cycle or RouterOS restart.'
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: d3b477b277294e0791c9a0a3fb0b8662
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.6.0]'
          key: 'system.location[sysLocation.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: 'Physical location of device from SNMPv2-MIB::sysLocation. Configured in RouterOS under /snmp set location=...'
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: a4f6cefcd40b4be6bcebe1f04b9aaff8
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.5.0]'
          key: system.name
          delay: 15m
          history: 2w
          value_type: CHAR
          description: 'Device hostname from SNMPv2-MIB::sysName. Should match RouterOS system identity (/system identity).'
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 53e774aa67254566b5fed5773e399e66
              expression: 'last(/MikroTik ROSE RDS2216/system.name,#1)<>last(/MikroTik ROSE RDS2216/system.name,#2) and length(last(/MikroTik ROSE RDS2216/system.name))>0'
              name: 'System name has changed'
              event_name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: 465ef54a8bc04e7ab0ed52d48c210130
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.3.0]'
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: 'SNMP agent uptime from SNMPv2-MIB::sysUpTime. Time since SNMP service started. May differ from hardware uptime after SNMP service restart.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: dd904b55b27440088cbc54f2005e2ab5
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.2.0]'
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          history: 2w
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 40c38fc800b84d1891bc953aa9ec3ab2
          name: 'Operating system'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.4.4.0]'
          key: 'system.sw.os[mtxrLicVersion.0]'
          delay: 1h
          history: 2w
          value_type: CHAR
          description: 'Operating system name (RouterOS) extracted from system description. Always ''RouterOS'' for MikroTik devices.'
          inventory_link: OS
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
          triggers:
            - uuid: 524233d99a9a4de1b9818ca90953c513
              expression: 'last(/MikroTik ROSE RDS2216/system.sw.os[mtxrLicVersion.0],#1)<>last(/MikroTik ROSE RDS2216/system.sw.os[mtxrLicVersion.0],#2) and length(last(/MikroTik ROSE RDS2216/system.sw.os[mtxrLicVersion.0]))>0'
              name: 'Operating system description has changed'
              priority: INFO
              description: 'Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.'
              manual_close: 'YES'
              dependencies:
                - name: 'System name has changed'
                  expression: 'last(/MikroTik ROSE RDS2216/system.name,#1)<>last(/MikroTik ROSE RDS2216/system.name,#2) and length(last(/MikroTik ROSE RDS2216/system.name))>0'
              tags:
                - tag: scope
                  value: notice
        - uuid: 21e4349a89a9445e9f092c784fd4bbad
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.2.3.1.5.65536]'
          key: 'vm.memory.total[hrStorageSize.Memory]'
          history: 7d
          units: B
          description: 'Total system RAM in bytes from HOST-RESOURCES-MIB. RDS2216 typically has 32GB DDR4 ECC memory.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 425bbf43b68c4106b61e6e5c1679e744
          name: 'Used memory'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.2.3.1.6.65536]'
          key: 'vm.memory.used[hrStorageUsed.Memory]'
          history: 7d
          units: B
          description: 'Used system RAM in bytes. Calculated from hrStorageUsed for RAM storage type. High memory usage may impact performance.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 39321aee295b4c5d96a1119a7fb147c8
          name: 'Memory utilization'
          type: CALCULATED
          key: 'vm.memory.util[memoryUsedPercentage.Memory]'
          history: 7d
          value_type: FLOAT
          units: '%'
          params: 'last(//vm.memory.used[hrStorageUsed.Memory])/last(//vm.memory.total[hrStorageSize.Memory])*100'
          description: 'Memory utilization percentage calculated from (used/total) × 100. Normal operation typically 20-40%. Warning at 80%, critical at 90%.'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: 58e481e2ff7a44e6aa3f0dd9a148d22b
              expression: 'min(/MikroTik ROSE RDS2216/vm.memory.util[memoryUsedPercentage.Memory],5m)>{$MEMORY.UTIL.MAX}'
              name: 'High memory utilization'
              event_name: 'High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: 81b2e33333ce46e8a0f40dbb1479f78b
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          description: 'SNMP agent availability status. Returns 0 if SNMP agent is not responding, 1 if available. Used to detect SNMP service failures.'
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: f177d6aebdef499cb034fa8b2123c405
              expression: 'max(/MikroTik ROSE RDS2216/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              manual_close: 'YES'
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/MikroTik ROSE RDS2216/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: aba709a5f80642d1aa7cea7718509baa
          name: 'CPU discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.2.1.25.3.3.1.1]'
          key: hrProcessorLoad.discovery
          delay: 1h
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'HOST-RESOURCES-MIB::hrProcessorLoad - Discovers all CPU cores/processors for load monitoring'
          item_prototypes:
            - uuid: 7ab5b0c219714082b372ce0435782826
              name: '#{#SNMPINDEX}: CPU utilization'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}]'
              key: 'system.cpu.util[hrProcessorLoad.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'Processor load average for CPU {#SNMPINDEX}. Returns percentage of CPU utilization.'
              tags:
                - tag: component
                  value: cpu
                - tag: cpu
                  value: '{#SNMPINDEX}'
              trigger_prototypes:
                - uuid: f4ed6dda6ebd447388c345ac84a0e7d3
                  expression: 'min(/MikroTik ROSE RDS2216/system.cpu.util[hrProcessorLoad.{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: '#{#SNMPINDEX}: High CPU utilization'
                  event_name: '#{#SNMPINDEX}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
                  tags:
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: ae0b055751934b37a69ff48423afea24
              name: '#{#SNMPINDEX}: CPU utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'system.cpu.util[hrProcessorLoad.{#SNMPINDEX}]'
        - uuid: e47d5db6a6f3488db8a7a99cf2e34406
          name: 'Backplane discovery'
          type: HTTP_AGENT
          key: mikrotik.backplane.discovery
          delay: 1h
          authtype: BASIC
          username: '{$MIKROTIK.API.USER}'
          password: '{$MIKROTIK.API.PASSWORD}'
          description: 'Discovers MikroTik RDS backplane PCIe bridge devices. Monitors interface connectivity and I/O statistics for the hardware backplane.'
          item_prototypes:
            - uuid: bceff0bbb0c247d9b223556fe3bef026
              name: 'Backplane {#BACKPLANE_SLOT}: Active time'
              type: DEPENDENT
              key: 'vfs.backplane.active_time[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time backplane has been actively processing I/O (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''active-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: c5f219adfa7b4ba19461d7209bda7b65
              name: 'Backplane {#BACKPLANE_SLOT}: Raw data'
              type: HTTP_AGENT
              key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              delay: 5m
              history: 1h
              value_type: TEXT
              authtype: BASIC
              username: '{$MIKROTIK.API.USER}'
              password: '{$MIKROTIK.API.PASSWORD}'
              description: 'Raw JSON data from MikroTik REST API for backplane device.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[?(@[''slot-default'']==''{#BACKPLANE_SLOT}'')].first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '{}'
              url: '{$MIKROTIK.API.SCHEME}://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk'
              headers:
                - name: Content-Type
                  value: application/json
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 8235e074aebb422ab870e79fd0ea6238
              name: 'Backplane {#BACKPLANE_SLOT}: Interface'
              type: DEPENDENT
              key: 'vfs.backplane.interface[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'PCIe interface type (e.g., pcie).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.interface
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: de0d06473c714517bcb7c82acc1a384e
              name: 'Backplane {#BACKPLANE_SLOT}: Interface speed'
              type: DEPENDENT
              key: 'vfs.backplane.interface_speed[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: bps
              description: 'PCIe interface speed (e.g., 8GT/s).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''interface-speed'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: f1ee61c90e3c44b3af188dbb649b2990
              name: 'Backplane {#BACKPLANE_SLOT}: In-flight operations'
              type: DEPENDENT
              key: 'vfs.backplane.in_flight_ops[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Current number of I/O operations in progress on backplane.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''in-flight-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 067f08b39e0f4e85974fb798fb33febf
              name: 'Backplane {#BACKPLANE_SLOT}: Model'
              type: DEPENDENT
              key: 'vfs.backplane.model[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Backplane device model name.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.model
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 1f994143a0d14273b3e4c90d7f551da7
              name: 'Backplane {#BACKPLANE_SLOT}: Read bytes'
              type: DEPENDENT
              key: 'vfs.backplane.read_bytes[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes read from backplane device.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 21212fb6d14048faa6b5dae49d7c9b6a
              name: 'Backplane {#BACKPLANE_SLOT}: Read merges'
              type: DEPENDENT
              key: 'vfs.backplane.read_merges[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read operations merged.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: a7913773118146c680db8a56e9caef80
              name: 'Backplane {#BACKPLANE_SLOT}: Read operations'
              type: DEPENDENT
              key: 'vfs.backplane.read_ops[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read operations on backplane device.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 6ad1feba760540048171f0f51f66a0e4
              name: 'Backplane {#BACKPLANE_SLOT}: Wait time'
              type: DEPENDENT
              key: 'vfs.backplane.wait_time[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time I/O requests spent in queue (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''wait-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 197e184891324df28c0d03b88586428a
              name: 'Backplane {#BACKPLANE_SLOT}: Write bytes'
              type: DEPENDENT
              key: 'vfs.backplane.write_bytes[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes written to backplane device.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: afe7cce577124c459b9b38cf96ec4d79
              name: 'Backplane {#BACKPLANE_SLOT}: Write merges'
              type: DEPENDENT
              key: 'vfs.backplane.write_merges[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write operations merged.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
            - uuid: 3b871b4d7f5f49f0ba7a5a569db70697
              name: 'Backplane {#BACKPLANE_SLOT}: Write operations'
              type: DEPENDENT
              key: 'vfs.backplane.write_ops[{#BACKPLANE_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write operations on backplane device.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.backplane.get[{#BACKPLANE_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: backplane
          url: '{$MIKROTIK.API.SCHEME}://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk'
          headers:
            - name: Content-Type
              value: application/json
          lld_macro_paths:
            - lld_macro: '{#BACKPLANE_INTERFACE}'
              path: '$.[''{#BACKPLANE_INTERFACE}'']'
            - lld_macro: '{#BACKPLANE_MODEL}'
              path: '$.[''{#BACKPLANE_MODEL}'']'
            - lld_macro: '{#BACKPLANE_SLOT}'
              path: '$.[''{#BACKPLANE_SLOT}'']'
            - lld_macro: '{#BACKPLANE_SPEED}'
              path: '$.[''{#BACKPLANE_SPEED}'']'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var disks = JSON.parse(value);
                  var result = [];
                  
                  for (var i = 0; i < disks.length; i++) {
                      var disk = disks[i];
                      
                      // Filter for backplane devices: type=hardware AND slot-default=backplane
                      if (disk.type === 'hardware' && disk['slot-default'] === 'backplane') {
                          result.push({
                              '{#BACKPLANE_SLOT}': disk['slot-default'],
                              '{#BACKPLANE_MODEL}': disk.model || '',
                              '{#BACKPLANE_INTERFACE}': disk.interface || '',
                              '{#BACKPLANE_SPEED}': disk['interface-speed'] || ''
                          });
                      }
                  }
                  
                  return JSON.stringify(result);
                  
        - uuid: e60e703ff8be4bad943924091bb32f54
          name: 'NVMe drive discovery'
          type: HTTP_AGENT
          key: mikrotik.nvme.discovery
          delay: 1h
          authtype: BASIC
          username: '{$MIKROTIK.API.USER}'
          password: '{$MIKROTIK.API.PASSWORD}'
          description: 'Discovers MikroTik RDS NVMe SSD drives. Monitors comprehensive SMART health attributes including temperature, wear level, spare capacity, and data integrity.'
          item_prototypes:
            - uuid: 1d60b2ed4c9d401d887c0319093b40a8
              name: 'NVMe {#NVME_SLOT}: Active time'
              type: DEPENDENT
              key: 'vfs.nvme.active_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time drive has been actively processing I/O (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''active-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 8b0170ea2f84429da9a0ca0a5deb95b2
              name: 'NVMe {#NVME_SLOT}: Controller busy time'
              type: DEPENDENT
              key: 'vfs.nvme.busy_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time controller was busy processing I/O commands (in seconds).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''controller-busy-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 72c1fa4dce0a4e8bb101cc01960b1eba
              name: 'NVMe {#NVME_SLOT}: Critical temperature time'
              type: DEPENDENT
              key: 'vfs.nvme.critical_temperature_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Time spent at or above critical temperature (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''critical-temperature-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: b338f7c3cde14bba9dcc38d578d133fe
              name: 'NVMe {#NVME_SLOT}: Critical warning'
              type: DEPENDENT
              key: 'vfs.nvme.critical_warning[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Critical warning flags from NVMe SMART. Indicates serious hardware issues.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''critical-warning'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: none
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
              trigger_prototypes:
                - uuid: a9134b3a33e649b99429170cbce0adef
                  expression: '(last(/MikroTik ROSE RDS2216/vfs.nvme.critical_warning[{#NVME_SLOT}])<>"" and last(/MikroTik ROSE RDS2216/vfs.nvme.critical_warning[{#NVME_SLOT}])<>"none")'
                  name: 'NVMe {#NVME_SLOT}: Critical warning detected'
                  opdata: 'Warning: {ITEM.LASTVALUE}'
                  priority: DISASTER
                  description: |
                    **PROBLEM:** NVMe drive {#NVME_SLOT} has reported critical warning flags.
                    
                    **IMPACT:** Serious hardware failure imminent. Drive may fail without warning. Data loss risk if drive fails during I/O operations. Performance degradation likely.
                    
                    **SEVERITY RATIONALE:** DISASTER - NVMe critical warnings indicate severe hardware issues requiring immediate replacement to prevent data loss.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Check warning details in Latest Data (value shows specific warning)
                    2. Review all NVMe SMART metrics for this drive
                    3. Check temperature (overheating common cause)
                    4. Verify adequate spare capacity
                    5. Initiate backup if not already current
                    6. Order replacement drive immediately
                    
                    **COMMON CRITICAL WARNINGS:**
                    - Spare capacity below threshold
                    - Temperature above threshold
                    - Reliability degraded
                    - Read-only mode enabled
                    - Volatile memory backup failed
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Check NVMe SMART data: /disk print detail where slot-default={#NVME_SLOT}
                    2. Review temperature sensors
                    3. Check power cycles and unsafe shutdowns
                    4. Verify firmware is current
                    5. Monitor for additional warnings
                    
                    **ESCALATION:**
                    - Immediate (0-15 min): Page storage team - critical hardware warning
                    - 30 minutes: If RAID member, prepare for replacement procedure
                    - 1 hour: Order replacement drive
                    - 4 hours: If warning persists and drive critical, schedule emergency replacement
                    
                    **RECOVERY:** Manual closure required after replacement drive installed OR warning cleared AND root cause identified.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: availability
            - uuid: 826bb00157f5444cb0bb34ba4fcc3abf
              name: 'NVMe {#NVME_SLOT}: Discard bytes'
              type: DEPENDENT
              key: 'vfs.nvme.discard_bytes[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes discarded/trimmed from NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 6cc15b65fd1a447c9bd135c72c92dae1
              name: 'NVMe {#NVME_SLOT}: Discard merges'
              type: DEPENDENT
              key: 'vfs.nvme.discard_merges[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total discard operations merged.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: a6105b23f4664f2f9579a0fd3ed6f1df
              name: 'NVMe {#NVME_SLOT}: Discard operations'
              type: DEPENDENT
              key: 'vfs.nvme.discard_ops[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total discard/trim operations on NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 7a048762d21f4df6850ed502d61716e4
              name: 'NVMe {#NVME_SLOT}: Discard time'
              type: DEPENDENT
              key: 'vfs.nvme.discard_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on discard/trim operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 0760414ac22a40cf9962ebd1cb04ff00
              name: 'NVMe {#NVME_SLOT}: Firmware version'
              type: DEPENDENT
              key: 'vfs.nvme.firmware[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'NVMe drive firmware version.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''fw-version'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: ee397a60876a434c9313050e42259f2b
              name: 'NVMe {#NVME_SLOT}: Flush operations'
              type: DEPENDENT
              key: 'vfs.nvme.flush_ops[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total flush operations.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''flush-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 1152b1903d7d404cad3314b74864fb9b
              name: 'NVMe {#NVME_SLOT}: Flush time'
              type: DEPENDENT
              key: 'vfs.nvme.flush_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on flush operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''flush-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 0ea6b59e83af43d0b7aef0725d4a1700
              name: 'NVMe {#NVME_SLOT}: Raw data'
              type: HTTP_AGENT
              key: 'vfs.nvme.get[{#NVME_SLOT}]'
              delay: 5m
              history: 1h
              value_type: TEXT
              authtype: BASIC
              username: '{$MIKROTIK.API.USER}'
              password: '{$MIKROTIK.API.PASSWORD}'
              description: 'Raw JSON data from MikroTik REST API for NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[?(@[''slot-default'']==''{#NVME_SLOT}'')].first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '{}'
              url: '{$MIKROTIK.API.SCHEME}://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk'
              headers:
                - name: Content-Type
                  value: application/json
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: b0b8cd7ff88e4069938515f367669a08
              name: 'NVMe {#NVME_SLOT}: Host read bytes'
              type: DEPENDENT
              key: 'vfs.nvme.host_read_bytes[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes read by host from NVMe drive (SMART attribute).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''host-read-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: a11c2b4620304909aec3acfd11d1dedf
              name: 'NVMe {#NVME_SLOT}: Host read commands'
              type: DEPENDENT
              key: 'vfs.nvme.host_read_cmds[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read commands issued by host (SMART attribute).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''host-read-cmds'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: ac8518d5c3f841a7931705495398b516
              name: 'NVMe {#NVME_SLOT}: Host write bytes'
              type: DEPENDENT
              key: 'vfs.nvme.host_write_bytes[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes written by host to NVMe drive (SMART attribute).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''host-write-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: f739472086e7402f84e26014a606f146
              name: 'NVMe {#NVME_SLOT}: Host write commands'
              type: DEPENDENT
              key: 'vfs.nvme.host_write_cmds[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write commands issued by host (SMART attribute).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''host-write-cmds'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 72a87aa9f1d544a1b5d279d2bb0b0d08
              name: 'NVMe {#NVME_SLOT}: Unrecovered integrity errors'
              type: DEPENDENT
              key: 'vfs.nvme.integrity_errors[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Count of unrecovered data integrity errors. Non-zero indicates data corruption.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''unrecovered-integrity-errors'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
              trigger_prototypes:
                - uuid: 84002903b3a6403ea64d97457355f4f4
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.integrity_errors[{#NVME_SLOT}])>0'
                  name: 'NVMe {#NVME_SLOT}: Data integrity errors detected'
                  opdata: 'Errors: {ITEM.LASTVALUE}'
                  priority: DISASTER
                  description: |
                    **PROBLEM:** NVMe drive {#NVME_SLOT} has unrecovered data integrity errors.
                    
                    **IMPACT:** Data corruption has occurred. Files may be corrupted or unreadable. Database integrity compromised. Application data may be invalid.
                    
                    **SEVERITY RATIONALE:** DISASTER - Unrecovered integrity errors mean data corruption has occurred and been detected but cannot be corrected. Data loss confirmed.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Identify affected files/applications immediately
                    2. Restore from last known good backup
                    3. Run filesystem check if safe: /disk check (REQUIRES UNMOUNT)
                    4. Check application-level integrity (database checksums, etc.)
                    5. Isolate affected data to prevent further propagation
                    6. Order replacement drive
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Check error count trend (increasing = worsening failure)
                    2. Review system logs for specific error events
                    3. Identify when errors started (correlate with backups)
                    4. Check other SMART metrics (temperature, wear, power cycles)
                    5. Determine if errors are localized or widespread
                    6. Assess backup freshness and coverage
                    
                    **DATA RECOVERY:**
                    1. If RAID: Other members may have good data
                    2. If standalone: Restore from backup mandatory
                    3. DO NOT continue using drive for new writes
                    4. Forensic data recovery may be required for critical data
                    
                    **ESCALATION:**
                    - Immediate (0-5 min): Page storage AND application teams - data corruption
                    - 15 minutes: Assess backup/restore requirements
                    - 30 minutes: Initiate data recovery procedures
                    - 1 hour: If critical data affected, escalate to management
                    - Consider: Emergency failover to backup systems
                    
                    **RECOVERY:** Manual closure required after corrupted data restored from backup AND failed drive replaced.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: availability
            - uuid: 0b854ec74c5b4862ac24bb907922201e
              name: 'NVMe {#NVME_SLOT}: Interface'
              type: DEPENDENT
              key: 'vfs.nvme.interface[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'NVMe interface type.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.interface
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 5adfeebd3d2b4cabbb8b2c03dea04de2
              name: 'NVMe {#NVME_SLOT}: Interface speed'
              type: DEPENDENT
              key: 'vfs.nvme.interface_speed[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: bps
              description: 'NVMe interface speed (e.g., 8GT/s).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''interface-speed'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 68468b307e0c40248733c3f9159fddce
              name: 'NVMe {#NVME_SLOT}: In-flight operations'
              type: DEPENDENT
              key: 'vfs.nvme.in_flight_ops[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Current number of I/O operations in progress on NVMe.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''in-flight-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 8619b7b8145448ce836bd2544c573488
              name: 'NVMe {#NVME_SLOT}: Model'
              type: DEPENDENT
              key: 'vfs.nvme.model[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'NVMe drive model name.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.model
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: cde4b8febf1a41fbb80e37b4025f7426
              name: 'NVMe {#NVME_SLOT}: Parent device'
              type: DEPENDENT
              key: 'vfs.nvme.parent[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Parent device (typically backplane).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.parent
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 9255392f62bb4bbd928a25264a4231a1
              name: 'NVMe {#NVME_SLOT}: Power cycles'
              type: DEPENDENT
              key: 'vfs.nvme.power_cycles[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total number of power on/off cycles.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''power-cycles'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 68bcab0eccbd49488572c6e4d8acf4c6
              name: 'NVMe {#NVME_SLOT}: Power on time'
              type: DEPENDENT
              key: 'vfs.nvme.power_on_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time drive has been powered on (in seconds).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''power-on-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: ea9969ac20ff45a9a0185a300c9ff372
              name: 'NVMe {#NVME_SLOT}: RAID master'
              type: DEPENDENT
              key: 'vfs.nvme.raid_master[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'RAID array this drive is a master of (usually ''none'' for members).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-master'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: none
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: f39a2c16027f494382a4d891eb3e8144
              name: 'NVMe {#NVME_SLOT}: RAID member'
              type: DEPENDENT
              key: 'vfs.nvme.raid_member[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'RAID array this drive is a member of.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-member'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: b99885d82f654de196b305b9290c9683
              name: 'NVMe {#NVME_SLOT}: RAID member failed'
              type: DEPENDENT
              key: 'vfs.nvme.raid_member_failed[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Whether this RAID member has failed (true/false).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-member-failed'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'false'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
              trigger_prototypes:
                - uuid: eb4e8f7beb3c4ca0bf0ee15bf11dbd65
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.raid_member_failed[{#NVME_SLOT}])="true"'
                  name: 'NVMe {#NVME_SLOT}: RAID member failed'
                  priority: DISASTER
                  description: |
                    **PROBLEM:** NVMe drive {#NVME_SLOT} has failed as a RAID member.
                    
                    **IMPACT:** RAID array degraded - single point of failure. If another drive fails, complete data loss occurs. Performance may be degraded during rebuild.
                    
                    **SEVERITY RATIONALE:** DISASTER - Drive failure in RAID array eliminates redundancy. Additional failure would result in complete data loss and service outage.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Verify RAID status: /disk print where type=raid
                    2. Check RAID state (should show degraded if still operational)
                    3. Identify hot spare availability
                    4. Order replacement drive immediately
                    5. Monitor remaining drives for signs of failure
                    6. DO NOT reboot system until replacement drive installed
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Check drive physical presence and power
                    2. Review NVMe health metrics for this drive
                    3. Check system logs for drive errors: /log print where topics~"system,error"
                    4. Verify other RAID members are healthy
                    5. Prepare for drive replacement procedure
                    
                    **ESCALATION:**
                    - Immediate (0-15 min): Page storage team - RAID degraded
                    - 30 minutes: Order replacement drive with expedited shipping
                    - 2 hours: Implement enhanced monitoring of remaining drives
                    - 24 hours: If replacement not available, consider RAID array evacuation
                    
                    **RECOVERY:** Manual closure required after failed drive replaced AND RAID rebuild completed successfully.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: availability
            - uuid: 1659f7326fee49e6943113cf01850f64
              name: 'NVMe {#NVME_SLOT}: RAID member state'
              type: DEPENDENT
              key: 'vfs.nvme.raid_member_state[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'State of this drive within the RAID array (active, spare, failed, etc.).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-member-state'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: e22391757cf943df9ac09ab004e845b8
              name: 'NVMe {#NVME_SLOT}: RAID role'
              type: DEPENDENT
              key: 'vfs.nvme.raid_role[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Role/position of this drive in RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-role'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 15f1a042c2d74e568dafb74d2f84801d
              name: 'NVMe {#NVME_SLOT}: Read bytes'
              type: DEPENDENT
              key: 'vfs.nvme.read_bytes[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes read from NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 9713884d58d8442ba6bcf444bfd3af47
              name: 'NVMe {#NVME_SLOT}: Read merges'
              type: DEPENDENT
              key: 'vfs.nvme.read_merges[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read operations merged before being sent to NVMe.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: c8a3d24ed3ed497f916d0809ff9d8e08
              name: 'NVMe {#NVME_SLOT}: Read operations'
              type: DEPENDENT
              key: 'vfs.nvme.read_ops[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read operations on NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 3a35695756fe44e8b556dee5850ec63b
              name: 'NVMe {#NVME_SLOT}: Read time'
              type: DEPENDENT
              key: 'vfs.nvme.read_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on read operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 3be7491e3675421c81bad9e34e3d1b73
              name: 'NVMe {#NVME_SLOT}: Serial number'
              type: DEPENDENT
              key: 'vfs.nvme.serial[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'NVMe drive serial number.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.serial
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 5114a0f4e46541ffbcccaf43609a37d8
              name: 'NVMe {#NVME_SLOT}: Capacity'
              type: DEPENDENT
              key: 'vfs.nvme.size[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'NVMe drive total capacity in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.size
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: e44b2e4855c64605b11f0db56e35bd7c
              name: 'NVMe {#NVME_SLOT}: Available spare'
              type: DEPENDENT
              key: 'vfs.nvme.spare[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'Percentage of spare capacity remaining. When this falls below threshold, drive is near end of life.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''available-spare'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 9cee9cca1faa4a6a95e2d46700b8c6d6
              name: 'NVMe {#NVME_SLOT}: Available spare threshold'
              type: DEPENDENT
              key: 'vfs.nvme.spare_threshold[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'Spare capacity threshold. Device will issue warning when available spare falls below this.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''available-spare-threshold'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 9f532080ef2346d6b42cc46c50dd5c98
              name: 'NVMe {#NVME_SLOT}: TCG Opal encryption enabled'
              type: DEPENDENT
              key: 'vfs.nvme.tcg_opal_self_encryption_enabled[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Whether TCG Opal self-encryption is enabled.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''tcg-opal-self-encryption-enabled'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'false'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 4f124166d96b40a4afd2cc6d7c246994
              name: 'NVMe {#NVME_SLOT}: TCG Opal encryption supported'
              type: DEPENDENT
              key: 'vfs.nvme.tcg_opal_self_encryption_supported[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Whether drive supports TCG Opal self-encryption.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''tcg-opal-self-encryption-supported'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'false'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 97541f23b00741d780da7931af3538fc
              name: 'NVMe {#NVME_SLOT}: Temperature sensors'
              type: DEPENDENT
              key: 'vfs.nvme.temperatures[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'All temperature sensor readings (comma-separated).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''temperatures'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 0b660988a78947a8a85fa5f385141cb5
              name: 'NVMe {#NVME_SLOT}: Temperature'
              type: DEPENDENT
              key: 'vfs.nvme.temperature[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: °C
              description: 'Current NVMe drive temperature in Celsius.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.temperature
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 73fbabd4d9874e909507ed5b473429ba
              name: 'NVMe {#NVME_SLOT}: Critical temperature threshold'
              type: DEPENDENT
              key: 'vfs.nvme.temp_critical[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: °C
              description: 'NVMe drive critical temperature threshold. Device will throttle or shut down if exceeded.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''critical-temperature'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 5cb73cb02ac84427bc0a83565636e382
              name: 'NVMe {#NVME_SLOT}: Warning temperature threshold'
              type: DEPENDENT
              key: 'vfs.nvme.temp_warning[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: °C
              description: 'NVMe drive warning temperature threshold.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''warning-temperature'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 20963b8b3a3c47f480d60edcf5e550a4
              name: 'NVMe {#NVME_SLOT}: Unsafe shutdowns'
              type: DEPENDENT
              key: 'vfs.nvme.unsafe_shutdowns[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Count of unsafe shutdowns (power loss without proper shutdown).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''unsafe-shutdowns'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
              trigger_prototypes:
                - uuid: 33e24204fa0e40cdb8b33630e7df9c1b
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.unsafe_shutdowns[{#NVME_SLOT}],#1)<>last(/MikroTik ROSE RDS2216/vfs.nvme.unsafe_shutdowns[{#NVME_SLOT}],#2)'
                  name: 'NVMe {#NVME_SLOT}: Unsafe shutdown detected'
                  opdata: 'Total unsafe shutdowns: {ITEM.LASTVALUE}'
                  priority: WARNING
                  description: |
                    **PROBLEM:** NVMe drive {#NVME_SLOT} experienced an unsafe shutdown (power loss without proper shutdown).
                    
                    **IMPACT:** Potential data corruption from incomplete writes. RAID resync may be required. Drive wear accelerated by unclean shutdown.
                    
                    **SEVERITY RATIONALE:** WARNING - Informational alert for tracking power events. May indicate power quality issues requiring investigation.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Check for power events in facility logs
                    2. Verify UPS battery backup is functional
                    3. Check for recent maintenance or outages
                    4. Review system logs for shutdown cause
                    
                    **COMMON CAUSES:**
                    - Facility power outage
                    - UPS battery failure
                    - Emergency power-off (EPO) activation
                    - Hardware failure causing reboot
                    - Kernel panic/system crash
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Review unsafe shutdown count trend
                    2. Correlate with facility power event logs
                    3. Check UPS/power system health
                    4. Verify backup power systems functional
                    5. Review system crash logs
                    
                    **ESCALATION:**
                    - If frequent (>1/week): Investigate power quality issue
                    - If increasing trend: Check UPS battery health
                    - If correlated with outages: Review backup power procedures
                    
                    **RECOVERY:** Manual closure required after power issue identified AND corrective action taken to prevent recurrence.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: availability
            - uuid: a0667f429b614f90af5327a932e37b2e
              name: 'NVMe {#NVME_SLOT}: Wait time'
              type: DEPENDENT
              key: 'vfs.nvme.wait_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time I/O requests spent in queue (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''wait-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 42e298a792e642ad938756ef4b6e9cb7
              name: 'NVMe {#NVME_SLOT}: Warning temperature time'
              type: DEPENDENT
              key: 'vfs.nvme.warning_temperature_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Time spent at or above warning temperature (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''warning-temperature-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: f6205f94999a4653a740fa32c3c6bd85
              name: 'NVMe {#NVME_SLOT}: Wear level'
              type: DEPENDENT
              key: 'vfs.nvme.wear[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'Percentage of drive lifetime used (wear level). 100% indicates end of rated lifetime.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''percentage-used'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
              trigger_prototypes:
                - uuid: 4f9e3244b2f042338a5859753a636992
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.wear[{#NVME_SLOT}])>{$VFS.FS.WEAR.MAX.WARN:"{#NVME_SLOT}"}'
                  name: 'NVMe {#NVME_SLOT}: Wear level is high'
                  opdata: 'Wear level: {ITEM.LASTVALUE1}%'
                  priority: AVERAGE
                  description: |
                    **PROBLEM:** NVMe drive {#NVME_SLOT} wear level exceeds threshold ({$VFS.FS.WEAR.MAX.WARN}%).
                    
                    **IMPACT:** Drive has consumed significant portion of rated lifetime. Increased failure risk. Plan replacement proactively.
                    
                    **SEVERITY RATIONALE:** AVERAGE - High wear level indicates aging drive. Not immediate failure but requires planning for replacement.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Check current wear level and trend
                    2. Review power-on hours and write workload
                    3. Plan drive replacement within maintenance window
                    4. Verify backups are current
                    
                    **UNDERSTANDING WEAR LEVEL:**
                    - Percentage-used indicates consumed rated lifetime
                    - Based on manufacturer's TBW (Total Bytes Written) rating
                    - 80% = 80% of rated writes consumed
                    - 100% = manufacturer's rated endurance exceeded
                    - Drives often continue working beyond 100%
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Check total host writes: Host write bytes metric
                    2. Review power-on time vs. expected usage
                    3. Verify write workload patterns haven't changed
                    4. Check if wear accelerating (compare monthly trends)
                    
                    **ESCALATION:**
                    - 1 week: Create ticket for replacement planning
                    - 1 month: Order replacement drive
                    - 3 months: Schedule maintenance window for replacement
                    
                    **RECOVERY:** Manual closure required after replacement drive installed OR wear level confirmed stable.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: capacity
            - uuid: 6c54e1d18ca64e499ede3ea475c9f6e8
              name: 'NVMe {#NVME_SLOT}: Write bytes'
              type: DEPENDENT
              key: 'vfs.nvme.write_bytes[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes written to NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 6f06d99a5d994e889321594086471c2a
              name: 'NVMe {#NVME_SLOT}: Write merges'
              type: DEPENDENT
              key: 'vfs.nvme.write_merges[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write operations merged before being sent to NVMe.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 037d1751711641aea83107a0b51d9b48
              name: 'NVMe {#NVME_SLOT}: Write operations'
              type: DEPENDENT
              key: 'vfs.nvme.write_ops[{#NVME_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write operations on NVMe drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
            - uuid: 412fd6d9571446eca0595fd6fa92a4f3
              name: 'NVMe {#NVME_SLOT}: Write time'
              type: DEPENDENT
              key: 'vfs.nvme.write_time[{#NVME_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on write operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.nvme.get[{#NVME_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: nvme
          trigger_prototypes:
            - uuid: 3cca222b22a9410fb5c195c49a6262cb
              expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.spare[{#NVME_SLOT}])<last(/MikroTik ROSE RDS2216/vfs.nvme.spare_threshold[{#NVME_SLOT}])'
              name: 'NVMe {#NVME_SLOT}: Spare blocks critically low'
              opdata: 'Available: {ITEM.LASTVALUE1}%, Threshold: {ITEM.LASTVALUE2}%'
              priority: HIGH
              description: |
                **PROBLEM:** NVMe drive {#NVME_SLOT} spare block capacity has fallen below manufacturer threshold.
                
                **IMPACT:** Drive approaching end of life. Increased risk of write failures. Performance degradation likely. Drive may transition to read-only mode without warning.
                
                **SEVERITY RATIONALE:** HIGH - Spare capacity below threshold indicates imminent drive failure. Manufacturer warranty typically requires replacement at this point.
                
                **IMMEDIATE ACTIONS:**
                1. Order replacement drive immediately
                2. Verify current backup is fresh
                3. Check write performance for degradation
                4. Monitor spare capacity trend (daily checks)
                5. Plan replacement window (before reaching 0%)
                
                **UNDERSTANDING SPARE BLOCKS:**
                - NVMe drives reserve spare blocks for wear leveling
                - As blocks fail, spares are used as replacements
                - When spares exhausted, drive cannot accept writes
                - Threshold typically 10% (varies by manufacturer)
                - Below threshold = replace drive proactively
                
                **TROUBLESHOOTING STEPS:**
                1. Check wear level (percentage-used metric)
                2. Review power-on hours (expected lifetime)
                3. Check unsafe shutdowns (accelerate wear)
                4. Verify write workload patterns
                5. Review replacement history
                
                **ESCALATION:**
                - Immediate: Create high-priority ticket for drive replacement
                - 24 hours: Order replacement drive if not in stock
                - 72 hours: Schedule maintenance window for replacement
                - 1 week: If spare continues dropping, escalate for emergency replacement
                
                **RECOVERY:** Manual closure required after replacement drive installed OR spare capacity increases above threshold (rare - usually indicates misread).
              manual_close: 'YES'
              tags:
                - tag: component
                  value: storage
                - tag: scope
                  value: capacity
            - uuid: b63d14b0e0a34b40947fd4355a9ce77e
              expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.temperature[{#NVME_SLOT}])>=last(/MikroTik ROSE RDS2216/vfs.nvme.temp_critical[{#NVME_SLOT}])'
              name: 'NVMe {#NVME_SLOT}: Temperature is critical'
              opdata: 'Current: {ITEM.LASTVALUE1}°C, Critical threshold: {ITEM.LASTVALUE2}°C'
              priority: HIGH
              description: |
                **PROBLEM:** NVMe drive {#NVME_SLOT} temperature has reached or exceeded critical threshold.
                
                **IMPACT:** Drive may throttle performance to reduce heat. Risk of thermal shutdown. Accelerated wear and potential data corruption at extreme temperatures.
                
                **SEVERITY RATIONALE:** HIGH - Critical temperature threatens hardware integrity and may cause immediate performance degradation or shutdown.
                
                **IMMEDIATE ACTIONS:**
                1. Check ambient temperature in equipment room
                2. Verify HVAC system operation
                3. Check all chassis fans operational (RPM > 0)
                4. Inspect airflow obstructions
                5. Review I/O workload (high activity generates heat)
                
                **TROUBLESHOOTING STEPS:**
                1. Check all temperature sensors: /system health print
                2. Verify chassis fan operation
                3. Check for airflow obstructions (cables, dust)
                4. Review recent workload changes (increased I/O)
                5. Verify rack cooling system operation
                
                **ESCALATION:**
                - Immediate (0-15 min): Page facility/NOC team - cooling issue
                - 30 minutes: If temp not decreasing, reduce I/O load
                - 1 hour: If approaching shutdown temp, plan emergency shutdown
                
                **RECOVERY:** Manual closure required after temperature drops below warning threshold AND cooling issue resolved.
              manual_close: 'YES'
              tags:
                - tag: component
                  value: storage
                - tag: scope
                  value: performance
            - uuid: 76632d1e67a94dcbbdc03809799897cc
              expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.temperature[{#NVME_SLOT}])>=last(/MikroTik ROSE RDS2216/vfs.nvme.temp_warning[{#NVME_SLOT}])'
              name: 'NVMe {#NVME_SLOT}: Temperature is high'
              opdata: 'Current: {ITEM.LASTVALUE1}°C, Warning threshold: {ITEM.LASTVALUE2}°C'
              priority: AVERAGE
              description: |
                **PROBLEM:** NVMe drive {#NVME_SLOT} temperature has exceeded warning threshold.
                
                **IMPACT:** Increased wear on drive. Performance may be reduced. Approaching critical temperature threshold.
                
                **SEVERITY RATIONALE:** AVERAGE - Temperature elevated but not yet critical. Provides early warning before thermal throttling occurs.
                
                **IMMEDIATE ACTIONS:**
                1. Monitor temperature trend (increasing or stable)
                2. Check facility cooling system operation
                3. Verify adequate airflow to device
                4. Review I/O workload patterns
                
                **TROUBLESHOOTING STEPS:**
                1. Check all temperature sensors for trends
                2. Verify fan speeds are normal
                3. Check for recent workload increases
                4. Verify chassis ventilation not obstructed
                
                **ESCALATION:**
                - 1 hour: If temperature continues rising, escalate to facility team
                - 2 hours: If approaching critical, take immediate cooling action
                
                **RECOVERY:** Manual closure required after temperature returns to normal range AND trend stabilizes.
              manual_close: 'YES'
              dependencies:
                - name: 'NVMe {#NVME_SLOT}: Temperature is critical'
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.nvme.temperature[{#NVME_SLOT}])>=last(/MikroTik ROSE RDS2216/vfs.nvme.temp_critical[{#NVME_SLOT}])'
              tags:
                - tag: component
                  value: storage
                - tag: scope
                  value: performance
          url: '{$MIKROTIK.API.SCHEME}://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk'
          headers:
            - name: Content-Type
              value: application/json
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var disks = JSON.parse(value);
                  var result = [];
                  
                  for (var i = 0; i < disks.length; i++) {
                      var disk = disks[i];
                      
                      // Filter for NVMe drives: type=hardware AND slot-default matches nvme[0-9]+
                      if (disk.type === 'hardware' && disk['slot-default'] && disk['slot-default'].match(/^nvme[0-9]+$/)) {
                          result.push({
                              '{#NVME_SLOT}': disk['slot-default'],
                              '{#NVME_MODEL}': disk.model || '',
                              '{#NVME_SERIAL}': disk.serial || '',
                              '{#NVME_INTERFACE}': disk.interface || ''
                          });
                      }
                  }
                  
                  return JSON.stringify(result);
                  
        - uuid: 68f3bf24da254d2b98e211c4fc630858
          name: 'RAID array discovery'
          type: HTTP_AGENT
          key: mikrotik.raid.discovery
          delay: 1h
          authtype: BASIC
          username: '{$MIKROTIK.API.USER}'
          password: '{$MIKROTIK.API.PASSWORD}'
          description: 'Discovers MikroTik RDS RAID arrays. Monitors RAID state, capacity, utilization, and filesystem status.'
          item_prototypes:
            - uuid: a1b2c3d4e5f6478890abcdef12345678
              name: 'RAID {#RAID_SLOT}: Free space (numeric)'
              type: DEPENDENT
              key: 'vfs.fs.free.numeric[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Available free space on RAID array in bytes (numeric for graphs). Discarded for unmounted RAID members.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.free
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: d7c9d6e05cf347b6882b56d32e60886a
              name: 'RAID {#RAID_SLOT}: Free space'
              type: DEPENDENT
              key: 'vfs.fs.free[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Available free space on RAID array in bytes. Shows N/A for unmounted RAID members.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.free
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value === '' || value === null || value === 'N/A') return 'N/A';
                      var bytes = parseFloat(value);
                      if (isNaN(bytes)) return 'N/A';
                      var units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB'];
                      var i = 0;
                      while (bytes >= 1024 && i < units.length - 1) {
                          bytes /= 1024;
                          i++;
                      }
                      return bytes.toFixed(2) + ' ' + units[i];
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: cd9b8c1acd354669b09208a272d12066
              name: 'RAID {#RAID_SLOT}: Space utilization'
              type: CALCULATED
              key: 'vfs.fs.pused[{#RAID_SLOT}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: '%'
              params: '(last(//vfs.fs.size[{#RAID_SLOT}]) - last(//vfs.fs.free.numeric[{#RAID_SLOT}])) / max(last(//vfs.fs.size[{#RAID_SLOT}]), 1) * 100'
              description: 'Percentage of RAID array capacity used. Calculated as (total - free) / total * 100. Only calculated for mounted RAID arrays with filesystem. Not supported for unmounted RAID members.'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
              trigger_prototypes:
                - uuid: cff1612e02a0428787e3782dc94d6297
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.fs.pused[{#RAID_SLOT}])>{$VFS.FS.PUSED.MAX.CRIT:"{#RAID_SLOT}"}'
                  name: 'RAID {#RAID_SLOT}: Disk space is critically low'
                  opdata: 'Space used: {ITEM.LASTVALUE1}%'
                  priority: AVERAGE
                  description: |
                    **PROBLEM:** RAID array {#RAID_SLOT} disk space usage exceeds critical threshold ({$VFS.FS.PUSED.MAX.CRIT}%).
                    
                    **IMPACT:** Storage exhaustion imminent. Applications may fail to write data, causing service outages. Database corruption risk if logs or temp files cannot be written.
                    
                    **SEVERITY RATIONALE:** AVERAGE - Critical capacity issue requiring immediate action to prevent service disruption within hours.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Identify largest space consumers: /file print detail where type=directory
                    2. Check for log files consuming space: /log print
                    3. Review application data growth trends
                    4. Clear unnecessary files if safe to do so
                    5. Implement emergency capacity expansion if available
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Check current utilization: /disk print detail where slot-default={#RAID_SLOT}
                    2. Identify growth rate: Compare current vs historical space usage
                    3. Review space by directory:
                       - Application data directories
                       - Log files (/log/*)
                       - Temporary files
                       - Database storage
                    4. Check for unexpected growth (runaway logging, data retention issues)
                    5. Verify backup processes are not filling storage
                    
                    **ESCALATION:**
                    - Immediate: Create high-priority ticket for storage team
                    - 2 hours: If unable to free sufficient space, escalate for emergency expansion
                    - 4 hours: If risk of service outage, implement emergency procedures
                    
                    **RECOVERY:** Manual closure required after space usage drops below warning threshold AND cleanup/expansion plan implemented.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: capacity
                - uuid: fab43f99aa3949d88ca2a376f9cf5e2a
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.fs.pused[{#RAID_SLOT}])>{$VFS.FS.PUSED.MAX.WARN:"{#RAID_SLOT}"}'
                  name: 'RAID {#RAID_SLOT}: Disk space is low'
                  opdata: 'Space used: {ITEM.LASTVALUE1}%'
                  priority: WARNING
                  description: |
                    **PROBLEM:** RAID array {#RAID_SLOT} disk space usage exceeds warning threshold ({$VFS.FS.PUSED.MAX.WARN}%).
                    
                    **IMPACT:** Storage capacity running low. Provides early warning before critical threshold reached. Time to plan capacity expansion or data cleanup.
                    
                    **SEVERITY RATIONALE:** WARNING - Proactive alert allowing scheduled response before capacity becomes critical.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Review storage utilization trends
                    2. Identify data growth patterns
                    3. Plan cleanup or capacity expansion
                    4. Schedule maintenance window for storage management
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Analyze space usage: /disk print detail
                    2. Review growth rate over past 7/30 days
                    3. Identify largest consumers and growth sources
                    4. Evaluate data retention policies
                    5. Plan for:
                       - Log rotation/cleanup
                       - Archive old data
                       - Add storage capacity
                       - Implement compression
                    
                    **ESCALATION:**
                    - 24 hours: Create standard ticket for storage planning
                    - 72 hours: If approaching critical, escalate for priority action
                    
                    **RECOVERY:** Manual closure required after mitigation plan created and space usage trend addressed.
                  manual_close: 'YES'
                  dependencies:
                    - name: 'RAID {#RAID_SLOT}: Disk space is critically low'
                      expression: 'last(/MikroTik ROSE RDS2216/vfs.fs.pused[{#RAID_SLOT}])>{$VFS.FS.PUSED.MAX.CRIT:"{#RAID_SLOT}"}'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: capacity
            - uuid: 21c655b4a2e94bf28bae310f882104a1
              name: 'RAID {#RAID_SLOT}: Total space'
              type: DEPENDENT
              key: 'vfs.fs.size[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total capacity of the RAID array in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.size
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 13e9cb01016148429d88da361ea27d6c
              name: 'RAID {#RAID_SLOT}: Active time'
              type: DEPENDENT
              key: 'vfs.raid.active_time[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time RAID array has been actively processing I/O (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''active-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: bc884bcfce304ec9bf669a044e221be3
              name: 'RAID {#RAID_SLOT}: Device count'
              type: DEPENDENT
              key: 'vfs.raid.device_count[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Number of devices in RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-device-count'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 04a629745c3e41aabbeef152484bb3ec
              name: 'RAID {#RAID_SLOT}: Discard bytes'
              type: DEPENDENT
              key: 'vfs.raid.discard_bytes[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes discarded/trimmed from RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 8ba0456fa2904fa0b8e559d09d386ab5
              name: 'RAID {#RAID_SLOT}: Discard merges'
              type: DEPENDENT
              key: 'vfs.raid.discard_merges[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total discard operations merged.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: fbe7f9024c51493586856fbdd1034483
              name: 'RAID {#RAID_SLOT}: Discard operations'
              type: DEPENDENT
              key: 'vfs.raid.discard_ops[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total discard/trim operations on RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 38b2da2f155d49629498905eb9f9bedd
              name: 'RAID {#RAID_SLOT}: Discard time'
              type: DEPENDENT
              key: 'vfs.raid.discard_time[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on discard operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''discard-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 79f72269a4c44a94afba9cb7668c042c
              name: 'RAID {#RAID_SLOT}: Flush operations'
              type: DEPENDENT
              key: 'vfs.raid.flush_ops[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total filesystem flush operations.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''flush-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 772e4f3aec2e4b7b82d5669e06387716
              name: 'RAID {#RAID_SLOT}: Flush time'
              type: DEPENDENT
              key: 'vfs.raid.flush_time[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on flush operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''flush-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 16e05644c15e4a95b68ae90f0d6879aa
              name: 'RAID {#RAID_SLOT}: Free inodes'
              type: DEPENDENT
              key: 'vfs.raid.free_inodes[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Number of free inodes available. Shows N/A for unmounted RAID members.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''free-inodes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
                - type: JAVASCRIPT
                  parameters:
                    - 'return (value === '''' || value === null || value === ''N/A'') ? ''N/A'' : value;'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 3bae7976211a4f69a57d806e0ce96939
              name: 'RAID {#RAID_SLOT}: Filesystem'
              type: DEPENDENT
              key: 'vfs.raid.fs[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Filesystem type on RAID array (ext4, xfs, etc.).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.fs
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: cb8bff6b26a94a4a864ca3cbe16c6489
              name: 'RAID {#RAID_SLOT}: Filesystem UUID'
              type: DEPENDENT
              key: 'vfs.raid.fs_uuid[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Filesystem UUID identifier.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''fs-uuid'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
                - type: JAVASCRIPT
                  parameters:
                    - 'return (value === '''' || value === null) ? ''N/A'' : value;'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 7635ec9b98bb4e178238f70a24b4ed41
              name: 'RAID {#RAID_SLOT}: Raw data'
              type: HTTP_AGENT
              key: 'vfs.raid.get[{#RAID_SLOT}]'
              delay: 5m
              history: 1h
              value_type: TEXT
              authtype: BASIC
              username: '{$MIKROTIK.API.USER}'
              password: '{$MIKROTIK.API.PASSWORD}'
              description: 'Raw JSON data from MikroTik REST API for RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[?(@.type==''raid'' && @.slot==''{#RAID_SLOT}'')].first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '{}'
              url: '{$MIKROTIK.API.SCHEME}://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk'
              headers:
                - name: Content-Type
                  value: application/json
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 05d13844b541407b87f6022c93b499e2
              name: 'RAID {#RAID_SLOT}: In-flight operations'
              type: DEPENDENT
              key: 'vfs.raid.in_flight_ops[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Current number of I/O operations in progress.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''in-flight-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 2b809fa0644244ffbc85d7216298e219
              name: 'RAID {#RAID_SLOT}: Model'
              type: DEPENDENT
              key: 'vfs.raid.model[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'RAID array model designation.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.model
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 140aaf3e3fb34dc29a50aea727d354ad
              name: 'RAID {#RAID_SLOT}: Mounted'
              type: DEPENDENT
              key: 'vfs.raid.mounted[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Whether RAID filesystem is currently mounted (true/false).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.mounted
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'false'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 697bf97f2e8d40db8d61e36563b55929
              name: 'RAID {#RAID_SLOT}: Mount point'
              type: DEPENDENT
              key: 'vfs.raid.mount_point[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Filesystem mount point path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''mount-point'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
                - type: JAVASCRIPT
                  parameters:
                    - 'return (value === '''' || value === null) ? ''N/A'' : value;'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: a06bc181d49440d7996e02f0dbb0489e
              name: 'RAID {#RAID_SLOT}: Mount read-only'
              type: DEPENDENT
              key: 'vfs.raid.mount_ro[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Whether RAID filesystem is mounted read-only (true/false).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''mount-read-only'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'false'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
              trigger_prototypes:
                - uuid: 495c6a0fc6944e96b818d7910004adbd
                  expression: 'last(/MikroTik ROSE RDS2216/vfs.raid.mount_ro[{#RAID_SLOT}])="true"'
                  name: 'RAID {#RAID_SLOT}: Filesystem mounted read-only'
                  priority: HIGH
                  description: |
                    **PROBLEM:** RAID filesystem {#RAID_SLOT} is mounted read-only.
                    
                    **IMPACT:** All write operations failing. Applications cannot save data, create files, or update databases. Service degradation or complete failure for write-dependent applications.
                    
                    **SEVERITY RATIONALE:** HIGH - Filesystem protection mode indicates detected corruption or errors. Data reads still possible but system effectively non-functional for most applications.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Check filesystem status: /disk print detail where slot-default={#RAID_SLOT}
                    2. Review system logs for filesystem errors: /log print where topics~"system,error"
                    3. Check RAID array health: /disk print where type=raid
                    4. Verify NVMe drive health: Review NVMe trigger status
                    5. Do NOT attempt to remount read-write without investigation
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Common causes:
                       - Filesystem corruption detected (ext4 errors)
                       - I/O errors from failed/failing drive
                       - Kernel panic recovery (unclean shutdown)
                       - Quota exceeded (rare)
                    2. Check dmesg/logs for:
                       - EXT4-fs errors
                       - I/O error messages
                       - Drive timeout events
                    3. Verify RAID state is active/clean
                    4. Check all member drives for failures
                    5. If corruption suspected: Filesystem check required (DOWNTIME)
                    
                    **ESCALATION:**
                    - Immediate (0-15 min): Page storage team - write operations failing
                    - 30 minutes: If no clear cause, prepare for emergency maintenance
                    - 1 hour: Schedule emergency maintenance window for fsck
                    - Consider: Emergency failover to backup storage if available
                    
                    **RECOVERY:** Manual closure required after filesystem remounted read-write AND root cause (corruption/drive failure) resolved. May require maintenance window for fsck.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: availability
            - uuid: 2faf846d4df24dac952c8ef92ff80848
              name: 'RAID {#RAID_SLOT}: Parent device'
              type: DEPENDENT
              key: 'vfs.raid.parent[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Parent device (should be empty for RAID array, anything here indicates misconfiguration).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''parent'']'
                  error_handler: CUSTOM_VALUE
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 5b8d3cbfb211470f8e4756dc0d35d776
              name: 'RAID {#RAID_SLOT}: RAID chunk size'
              type: DEPENDENT
              key: 'vfs.raid.raid_chunk_size[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'RAID stripe/chunk size.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-chunk-size'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 05b84fccbc9e4456baba19f8faa552c4
              name: 'RAID {#RAID_SLOT}: Read bytes'
              type: DEPENDENT
              key: 'vfs.raid.read_bytes[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes read from RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: dd11b8f051624860884b9edb453e60be
              name: 'RAID {#RAID_SLOT}: Read merges'
              type: DEPENDENT
              key: 'vfs.raid.read_merges[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read operations merged before being sent to disk.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: de548688c55e482bad31f6cf2a97db2b
              name: 'RAID {#RAID_SLOT}: Read operations'
              type: DEPENDENT
              key: 'vfs.raid.read_ops[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total read operations on RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 525f130ca92c4d8984778f09cfedbda3
              name: 'RAID {#RAID_SLOT}: Read time'
              type: DEPENDENT
              key: 'vfs.raid.read_time[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on read operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''read-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 9d200aa499df4bc6b70be220cd89d36b
              name: 'RAID {#RAID_SLOT}: RAID state'
              type: DEPENDENT
              key: 'vfs.raid.state[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Current RAID array state (active, degraded, resyncing, etc.).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-state'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: unknown
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
              trigger_prototypes:
                - uuid: 055ca6e10b5648439ce63e5c5664ae30
                  expression: '(last(/MikroTik ROSE RDS2216/vfs.raid.state[{#RAID_SLOT}])<>"active" and last(/MikroTik ROSE RDS2216/vfs.raid.state[{#RAID_SLOT}])<>"clean")'
                  name: 'RAID {#RAID_SLOT}: RAID array is not active'
                  opdata: 'State: {ITEM.LASTVALUE}'
                  priority: DISASTER
                  description: |
                    **PROBLEM:** RAID array {#RAID_SLOT} is not in active or clean state.
                    
                    **IMPACT:** Data redundancy compromised or lost. Risk of complete data loss if additional drive fails. Read/write performance may be degraded.
                    
                    **SEVERITY RATIONALE:** DISASTER - RAID array failure or degradation directly threatens data availability and integrity for all services dependent on this storage.
                    
                    **IMMEDIATE ACTIONS:**
                    1. Check RAID state via RouterOS: /disk print detail
                    2. Identify failed/missing drives: /disk print where raid-member-failed=true
                    3. Verify all NVMe drives are physically present and powered
                    4. Check system logs for drive errors: /log print where topics~"system"
                    5. If degraded: Initiate controlled failover to backup storage if available
                    6. If resyncing: Monitor progress, do not interrupt
                    
                    **TROUBLESHOOTING STEPS:**
                    1. Common states:
                       - degraded: One or more drives failed, array operational but vulnerable
                       - resyncing: Array rebuilding after drive replacement (normal)
                       - recovering: Array recovering from unclean shutdown
                       - failed: Array cannot operate, data inaccessible
                    2. Check drive health: Review NVMe triggers for failed member
                    3. Verify RAID configuration: /disk print where type=raid
                    4. Check parent devices: Ensure all member drives healthy
                    5. Review power events: Unsafe shutdowns can cause array issues
                    
                    **ESCALATION:**
                    - Immediate (0-15 min): Page storage/NOC team for DISASTER alert
                    - 15 minutes: Contact MikroTik support if degraded state persists
                    - 30 minutes: Prepare for data recovery procedures if array failed
                    - 1 hour: Escalate to management, implement business continuity plan
                    
                    **RECOVERY:** Manual closure required after RAID state returns to active or clean AND root cause identified.
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: storage
                    - tag: scope
                      value: availability
            - uuid: cdff66dfd6e34b92971df479cb7947a4
              name: 'RAID {#RAID_SLOT}: Total inodes'
              type: DEPENDENT
              key: 'vfs.raid.total_inodes[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total number of inodes in filesystem.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''total-inodes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 3cc069dc9248422b8361c3478ead6740
              name: 'RAID {#RAID_SLOT}: RAID type'
              type: DEPENDENT
              key: 'vfs.raid.type[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'RAID level type (raid5, raid6, etc.).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-type'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 6fc5858a93a34344b508dadc2cf2b1c3
              name: 'RAID {#RAID_SLOT}: Use count'
              type: DEPENDENT
              key: 'vfs.raid.use[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Number of active users/connections using this RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''use'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 9fe30e5417ef4cef8a2efaaa62edbd81
              name: 'RAID {#RAID_SLOT}: RAID UUID'
              type: DEPENDENT
              key: 'vfs.raid.uuid[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'RAID array UUID identifier.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''raid-uuid'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: N/A
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 6f75b1e6e91a45a0b41a33a7aceb7eb2
              name: 'RAID {#RAID_SLOT}: Wait time'
              type: DEPENDENT
              key: 'vfs.raid.wait_time[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time I/O requests spent in queue (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''wait-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: fc6582f619ef40218f613b106bbd10f5
              name: 'RAID {#RAID_SLOT}: Write bytes'
              type: DEPENDENT
              key: 'vfs.raid.write_bytes[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              units: B
              description: 'Total bytes written to RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-bytes'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: cacbdd176fb24162ad911a2515f727f7
              name: 'RAID {#RAID_SLOT}: Write merges'
              type: DEPENDENT
              key: 'vfs.raid.write_merges[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write operations merged before being sent to disk.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-merges'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 6a90fe29c7d341fbabc606182c43fdb5
              name: 'RAID {#RAID_SLOT}: Write operations'
              type: DEPENDENT
              key: 'vfs.raid.write_ops[{#RAID_SLOT}]'
              history: 7d
              value_type: FLOAT
              description: 'Total write operations on RAID array.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-ops'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
            - uuid: 9b7414d7a354400f8c8ee0a0baf429d4
              name: 'RAID {#RAID_SLOT}: Write time'
              type: DEPENDENT
              key: 'vfs.raid.write_time[{#RAID_SLOT}]'
              history: 7d
              value_type: TEXT
              description: 'Total time spent on write operations (MikroTik time format).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[''write-time'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 0ms
              master_item:
                key: 'vfs.raid.get[{#RAID_SLOT}]'
              tags:
                - tag: component
                  value: storage
                - tag: device
                  value: raid
          graph_prototypes:
            - uuid: 2059f53fd9ee4a9092ef9a7a93913e15
              name: 'RAID {#RAID_SLOT}: Space usage'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  type: GRAPH_SUM
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'vfs.fs.free.numeric[{#RAID_SLOT}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  type: GRAPH_SUM
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'vfs.fs.size[{#RAID_SLOT}]'
          url: '{$MIKROTIK.API.SCHEME}://{HOST.IP}:{$MIKROTIK.API.PORT}/rest/disk'
          headers:
            - name: Content-Type
              value: application/json
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var disks = JSON.parse(value);
                  var result = [];
                  
                  for (var i = 0; i < disks.length; i++) {
                      var disk = disks[i];
                      
                      // Filter for RAID arrays: type=raid
                      if (disk.type === 'raid') {
                          // Use 'slot' field which contains unique RAID array names (RAID10_array, RAID1_mirror1, etc.)
                          // For RAID10 setups, there will be multiple RAID1 mirrors plus the striped volume
                          var raidSlot = disk.slot || '';
                          
                          // Skip if slot is empty (shouldn't happen for RAID arrays)
                          if (raidSlot) {
                              result.push({
                                  '{#RAID_SLOT}': raidSlot,
                                  '{#RAID_MODEL}': disk.model || '',
                                  '{#RAID_TYPE}': disk['raid-type'] || '',
                                  '{#RAID_FS}': disk.fs || ''
                              });
                          }
                      }
                  }
                  
                  return JSON.stringify(result);
                  
        - uuid: 72ffd11b88ca4f6d8307127adbfab07b
          name: 'Fan speed discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_NAME},1.3.6.1.4.1.14988.1.1.3.100.1.2]'
          key: mtxrHealth.fan.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SENSOR_NAME}'
                value: '.*-speed$'
          description: 'Discovers all fan speed sensors: fan1-10, psu1-fan, psu2-fan. Values are in RPM.'
          item_prototypes:
            - uuid: 62d412e0d9e642deb066e073abbac14f
              name: 'Fan: {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}]'
              key: 'sensor.fan[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: RPM
              description: 'Fan speed for {#SENSOR_NAME} in RPM (revolutions per minute).'
              tags:
                - tag: component
                  value: fan
                - tag: sensor
                  value: '{#SENSOR_NAME}'
          graph_prototypes:
            - uuid: 3657ef0fb9d34b53b34effbdb9e2213d
              name: 'Fan speed: {#SENSOR_NAME}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'sensor.fan[{#SNMPINDEX}]'
          lld_macro_paths:
            - lld_macro: '{#SENSOR_NAME}'
              path: $.1
        - uuid: affdc263fc974c91a9c82f225a828d85
          name: 'Power sensor discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_NAME},1.3.6.1.4.1.14988.1.1.3.100.1.2]'
          key: mtxrHealth.power.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SENSOR_NAME}'
                value: '.*-power$'
          description: 'Discovers power consumption sensors (PSU1/PSU2). Values are in watts.'
          item_prototypes:
            - uuid: 6be5e234cc7e449bb3f7981e8d21dfa6
              name: 'Power: {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}]'
              key: 'sensor.power[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: W
              description: 'Power consumption for {#SENSOR_NAME} in watts.'
              tags:
                - tag: component
                  value: power
                - tag: sensor
                  value: '{#SENSOR_NAME}'
          graph_prototypes:
            - uuid: 9b97634f637542bf8aee1bb2b31b6f60
              name: 'Power: {#SENSOR_NAME}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'sensor.power[{#SNMPINDEX}]'
          lld_macro_paths:
            - lld_macro: '{#SENSOR_NAME}'
              path: $.1
        - uuid: 41df639158aa424f9ce09e8eef552b9c
          name: 'Hardware state discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_NAME},1.3.6.1.4.1.14988.1.1.3.100.1.2]'
          key: mtxrHealth.state.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SENSOR_NAME}'
                value: '.*-state$'
          description: 'Discovers hardware state sensors (fan-state, psu1-state, psu2-state). 0=OK, 1=FAILED.'
          item_prototypes:
            - uuid: 7125e76615e84905b959d2a14a1770ec
              name: 'State: {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}]'
              key: 'sensor.state[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              description: 'Hardware state for {#SENSOR_NAME}. 0=OK, 1=FAILED.'
              valuemap:
                name: 'MikroTik Hardware State'
              tags:
                - tag: component
                  value: hardware
                - tag: sensor
                  value: '{#SENSOR_NAME}'
              trigger_prototypes:
                - uuid: 262b83458ba04d82aea1a1b0d5bd781d
                  expression: 'last(/MikroTik ROSE RDS2216/sensor.state[{#SNMPINDEX}])=1'
                  name: '{#SENSOR_NAME}: Hardware failure'
                  event_name: '{#SENSOR_NAME}: Hardware failure detected'
                  opdata: 'State: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'Hardware sensor {#SENSOR_NAME} reports failure (value=1). Check hardware immediately.'
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: hardware
                    - tag: scope
                      value: availability
          graph_prototypes:
            - uuid: f1d577ffa88144d38341c2c84946c35a
              name: 'State: {#SENSOR_NAME}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'sensor.state[{#SNMPINDEX}]'
          lld_macro_paths:
            - lld_macro: '{#SENSOR_NAME}'
              path: $.1
        - uuid: 56abe9a2c22a42ba83f807fbb87cd1f6
          name: 'Temperature sensor discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_NAME},1.3.6.1.4.1.14988.1.1.3.100.1.2]'
          key: mtxrHealth.temperature.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SENSOR_NAME}'
                value: '.*-temperature$'
          description: 'Discovers all temperature sensors: board, CPU, fan, PSU, PCIe switch, PHY, SFP, switch chip. Values are automatically divided by 10 to get degrees Celsius.'
          item_prototypes:
            - uuid: 0fabd88cfce742c79b2dc5531849c334
              name: 'Temperature: {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}]'
              key: 'sensor.temperature[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: °C
              description: 'Temperature sensor {#SENSOR_NAME} in degrees Celsius. Raw SNMP value is divided by 10.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                - tag: component
                  value: temperature
                - tag: sensor
                  value: '{#SENSOR_NAME}'
              trigger_prototypes:
                - uuid: 3655a3ddb7134493a8ad92cc3dbc94b8
                  expression: 'last(/MikroTik ROSE RDS2216/sensor.temperature[{#SNMPINDEX}])>{$TEMP_CRIT}'
                  name: '{#SENSOR_NAME}: Critical temperature'
                  event_name: '{#SENSOR_NAME}: Critical temperature {ITEM.LASTVALUE1}°C'
                  opdata: 'Current: {ITEM.LASTVALUE1}°C'
                  priority: HIGH
                  description: 'Temperature sensor {#SENSOR_NAME} has exceeded critical threshold ({$TEMP_CRIT}°C). Check cooling system immediately.'
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: temperature
                    - tag: scope
                      value: performance
                - uuid: a360723b646142d3a88365d95f858758
                  expression: 'last(/MikroTik ROSE RDS2216/sensor.temperature[{#SNMPINDEX}])>{$TEMP_WARN}'
                  name: '{#SENSOR_NAME}: High temperature'
                  event_name: '{#SENSOR_NAME}: High temperature {ITEM.LASTVALUE1}°C'
                  opdata: 'Current: {ITEM.LASTVALUE1}°C'
                  priority: WARNING
                  description: 'Temperature sensor {#SENSOR_NAME} has exceeded warning threshold ({$TEMP_WARN}°C).'
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#SENSOR_NAME}: Critical temperature'
                      expression: 'last(/MikroTik ROSE RDS2216/sensor.temperature[{#SNMPINDEX}])>{$TEMP_CRIT}'
                  tags:
                    - tag: component
                      value: temperature
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: b88b06e9e6234148bd94addec5d77733
              name: 'Temperature: {#SENSOR_NAME}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'sensor.temperature[{#SNMPINDEX}]'
          lld_macro_paths:
            - lld_macro: '{#SENSOR_NAME}'
              path: $.1
        - uuid: d1ca8757991444cf9c67266b9fcf2b9c
          name: 'Voltage sensor discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_NAME},1.3.6.1.4.1.14988.1.1.3.100.1.2]'
          key: mtxrHealth.voltage.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SENSOR_NAME}'
                value: '.*-voltage$'
          description: 'Discovers voltage sensors (PSU input voltage). Values are automatically divided by 10 to get volts. The !V unit prefix prevents SI conversion (kV, mV).'
          item_prototypes:
            - uuid: ef31aa76bdec480c90e6c6adc8f35166
              name: 'Voltage: {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}]'
              key: 'sensor.voltage[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: '!V'
              description: 'Voltage sensor {#SENSOR_NAME} in volts. Raw SNMP value is divided by 10. ! prefix prevents SI unit conversion.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                - tag: component
                  value: power
                - tag: sensor
                  value: '{#SENSOR_NAME}'
          graph_prototypes:
            - uuid: aca93676b5ae46ec9dad3f49e3d53b62
              name: 'Voltage: {#SENSOR_NAME}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'sensor.voltage[{#SNMPINDEX}]'
          lld_macro_paths:
            - lld_macro: '{#SENSOR_NAME}'
              path: $.1
        - uuid: b6d06e3854ca4d56965bb3852be50d35
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'IF-MIB::ifTable - Discovers all network interfaces including Ethernet, SFP28 (25G), and QSFP28 (100G) ports'
          item_prototypes:
            - uuid: 0c27cdcd80cd41af8b616a8f3f343e9f
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}]'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: c742663f1c4546aa98c48a7300b18623
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}]'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: a624c23bf1b649afbc0377a4633bc556
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}]'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: e87f5835111c41bcaa826c213210357b
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}]'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 068448a946884543b916f50ed135fca3
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}]'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: d2a93ab9e25f45c09f1c00773054c878
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}]'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 82b7f6ebaf804992a195b01f165762e9
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}]'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: 0d
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 2af85886b51f4fd6a0c4ce8201a26a10
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}]'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: ed37c540782843da86f1ed9de5d09131
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: db9b60dbcabf44bd9e0b6c00de416b0b
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}]'
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              trends: 0d
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: b174e27bbb6d47c98e0817e9b5a472a4
              expression: |
                change(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/MikroTik ROSE RDS2216/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/MikroTik ROSE RDS2216/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/MikroTik ROSE RDS2216/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/MikroTik ROSE RDS2216/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/MikroTik ROSE RDS2216/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/MikroTik ROSE RDS2216/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: interface
                  value: '{#IFNAME}'
                - tag: scope
                  value: performance
            - uuid: de2dee1941f04a0da77086c52ff756c6
              expression: |
                (avg(/MikroTik ROSE RDS2216/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/MikroTik ROSE RDS2216/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/MikroTik ROSE RDS2216/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/MikroTik ROSE RDS2216/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/MikroTik ROSE RDS2216/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: interface
                  value: '{#IFNAME}'
                - tag: scope
                  value: performance
            - uuid: e4b425eb5a36408fa865993431b65116
              expression: |
                min(/MikroTik ROSE RDS2216/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/MikroTik ROSE RDS2216/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/MikroTik ROSE RDS2216/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/MikroTik ROSE RDS2216/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              manual_close: 'YES'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/MikroTik ROSE RDS2216/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: interface
                  value: '{#IFNAME}'
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 2f515858a57d4121a7e11a7b7b18e594
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: A54F10
                  yaxisside: RIGHT
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'MikroTik ROSE RDS2216'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
      tags:
        - tag: class
          value: network
        - tag: class
          value: storage
        - tag: target
          value: mikrotik
        - tag: vendor
          value: mikrotik
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
        - macro: '{$IFCONTROL}'
          value: '1'
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
        - macro: '{$MIKROTIK.API.PASSWORD}'
          value: changeme
          description: 'MikroTik REST API password'
        - macro: '{$MIKROTIK.API.PORT}'
          value: '80'
          description: 'HTTP port for MikroTik REST API (80 for http, 443 for https)'
        - macro: '{$MIKROTIK.API.SCHEME}'
          value: http
          description: 'HTTP scheme for MikroTik REST API (http or https)'
        - macro: '{$MIKROTIK.API.USER}'
          value: apiuser
          description: 'MikroTik REST API username'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Ignore notPresent(6)'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
        - macro: '{$TEMP_CRIT}'
          value: '60'
        - macro: '{$TEMP_CRIT:"CPU"}'
          value: '75'
        - macro: '{$TEMP_CRIT_LOW}'
          value: '5'
        - macro: '{$TEMP_WARN}'
          value: '50'
        - macro: '{$TEMP_WARN:"CPU"}'
          value: '70'
        - macro: '{$VFS.FS.FREE.MIN.CRIT}'
          value: '10'
          description: 'Minimum free disk space percentage before critical alert (default: 10%)'
        - macro: '{$VFS.FS.FREE.MIN.WARN}'
          value: '20'
          description: 'Minimum free disk space percentage before warning alert (default: 20%)'
        - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
          description: 'Maximum percentage of disk space used before critical alert (default: 90%)'
        - macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
          description: 'Maximum percentage of disk space used before warning alert (default: 80%)'
        - macro: '{$VFS.FS.WEAR.MAX.WARN}'
          value: '80'
          description: 'Maximum NVMe wear level (percentage-used) before warning (default: 80%)'
      dashboards:
        - uuid: 4cdb41cc2eec478d8e6dfd74a551a735
          name: 'MikroTik RDS2216 ROSE Overview'
          pages:
            - name: CPU
              widgets:
                - type: problems
                  name: 'CPU Problems'
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: show_tags
                      value: '3'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: cpu
                - type: graphprototype
                  name: 'CPU Usage'
                  'y': '3'
                  width: '72'
                  height: '12'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'MikroTik ROSE RDS2216'
                        name: '#{#SNMPINDEX}: CPU utilization'
                    - type: STRING
                      name: reference
                      value: ZESHE
                    - type: INTEGER
                      name: rows
                      value: '4'
            - name: Temperature
              widgets:
                - type: problems
                  name: 'Temperature Problems'
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: show_tags
                      value: '3'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: temperature
                - type: graphprototype
                  name: 'Temperature Sensors'
                  'y': '3'
                  width: '72'
                  height: '10'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'MikroTik ROSE RDS2216'
                        name: 'Temperature: {#SENSOR_NAME}'
                    - type: STRING
                      name: reference
                      value: QCZMO
                    - type: INTEGER
                      name: rows
                      value: '2'
            - name: Fan
              widgets:
                - type: problems
                  name: 'Fan Problems'
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: show_tags
                      value: '3'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: fan
                - type: graphprototype
                  name: 'Fan Speeds'
                  'y': '3'
                  width: '72'
                  height: '12'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '6'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'MikroTik ROSE RDS2216'
                        name: 'Fan speed: {#SENSOR_NAME}'
                    - type: STRING
                      name: reference
                      value: JFGQG
                    - type: INTEGER
                      name: rows
                      value: '2'
            - name: PSU
              widgets:
                - type: problems
                  name: 'PSU Power Problems'
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: show_tags
                      value: '3'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: power
                - type: graphprototype
                  name: 'Power Consumption'
                  'y': '3'
                  width: '72'
                  height: '7'
                  fields:
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'MikroTik ROSE RDS2216'
                        name: 'Power: {#SENSOR_NAME}'
                    - type: STRING
                      name: reference
                      value: YSGKU
            - name: Storage
              widgets:
                - type: problems
                  name: 'Storage & NVMe Problems'
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: show_tags
                      value: '3'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: storage
                - type: graphprototype
                  name: 'RAID Array Space Usage'
                  'y': '3'
                  width: '72'
                  height: '10'
                  fields:
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'MikroTik ROSE RDS2216'
                        name: 'RAID {#RAID_SLOT}: Space usage'
                    - type: STRING
                      name: reference
                      value: KZSST
                    - type: INTEGER
                      name: rows
                      value: '2'
            - name: Network
              widgets:
                - type: problems
                  name: 'Network Interface Problems'
                  width: '72'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: show_tags
                      value: '3'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: network
                - type: graphprototype
                  name: 'Network Interface Traffic'
                  'y': '3'
                  width: '72'
                  height: '12'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'MikroTik ROSE RDS2216'
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                    - type: STRING
                      name: reference
                      value: NETIF
                    - type: INTEGER
                      name: rows
                      value: '3'
      valuemaps:
        - uuid: ff663db4dbf0451d95785e4b36fbd37c
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: 9b9355b055384382ab19c8f387f84146
          name: 'IF-MIB::ifType'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: 40efe0ecd5e4481e8c5ba8ab2581c6bc
          name: 'MikroTik Hardware State'
          mappings:
            - value: '0'
              newvalue: OK
            - value: '1'
              newvalue: FAILED
        - uuid: 8296bb8d2556458299e7187b93a299de
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: b9a6b47e1f804d06848432e11f600136
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 7a6ff4b2aa6b41bca038921f6af5f182
      expression: '(last(/MikroTik ROSE RDS2216/system.hw.uptime[hrSystemUptime.0])>0 and last(/MikroTik ROSE RDS2216/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/MikroTik ROSE RDS2216/system.hw.uptime[hrSystemUptime.0])=0 and last(/MikroTik ROSE RDS2216/system.net.uptime[sysUpTime.0])<10m)'
      name: 'Host has been restarted'
      event_name: '{HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        - name: 'No SNMP data collection'
          expression: 'max(/MikroTik ROSE RDS2216/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        - tag: scope
          value: notice
  graphs:
    - uuid: 5191c5a941df4b1f88276941948eba76
      name: 'Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'MikroTik ROSE RDS2216'
            key: 'vm.memory.util[memoryUsedPercentage.Memory]'
