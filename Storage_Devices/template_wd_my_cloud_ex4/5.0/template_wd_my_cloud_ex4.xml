<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:38:09Z</date><groups><group><name>Templates</name></group></groups><templates><template><template>WD My Cloud EX4</template><name>WD My Cloud EX4</name><description>## Overview

Zabbix SNMP Template for (Western Digital) WD My Cloud EX4


In WD My Cloud EX4 is simple (MIBs here http://downloads.wdc.com/nas/WDMYCLOUDEX4-MIB.txt). 


Because some OID return not-clear-byte values (150.3G, 2.3T) - in items used &quot;regex-magic&quot;. Loosing some precision (i try to beat this problem), for flexiable data:


Prerequisites:
--------------


* Enable SNMP on WD My Cloud EX4
* Zabbix 3.4+ with preproccessing support for regex-magic on item


Feautres:
---------


Low Level Discovery:


* physical disks
* logical disks
* UPS


Notice:
-------


In my env this NAS is &quot;lazy&quot; and have problems with BULK SNMP queries from Zabbix.


Template uses vars set on host-level:


* {$SNMP\_PORT}
* {$SNMP\_COMMUNITY}


</description><groups><group><name>Templates</name></group></groups><applications><application><name>Logical Disks</name></application><application><name>Physical Disks</name></application><application><name>System</name></application><application><name>UPS</name></application></applications><items><item><name>Agent Version</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.1.0</snmp_oid><key>agentVer</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>System</name></application></applications></item><item><name>Fan status</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.8.0</snmp_oid><key>fanStatus</key><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>System</name></application></applications><preprocessing><step><type>LTRIM</type><params> fan0: </params></step><step><type>LTRIM</type><params> fan1: </params></step></preprocessing><triggers><trigger><expression>{regexp(running)}=0</expression><name>Fan status</name><priority>WARNING</priority></trigger></triggers></item><item><name>FTP status</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.5.0</snmp_oid><key>ftpServer</key><delay>1h</delay><history>1w</history><trends>30d</trends><applications><application><name>System</name></application></applications><valuemap><name>WD My Cloud EX4 FTP Server</name></valuemap></item><item><name>Hostname</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.3.0</snmp_oid><key>hostName</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>System</name></application></applications></item><item><name>Net type</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.6.0</snmp_oid><key>netType</key><delay>1h</delay><history>1w</history><trends>30d</trends><applications><application><name>System</name></application></applications><valuemap><name>WD My Cloud EX4 Net Type</name></valuemap></item><item><name>Software version</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.2.0</snmp_oid><key>softwareVersion</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>System</name></application></applications></item><item><name>Temperature</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.7.0</snmp_oid><key>temperature</key><history>1w</history><trends>30d</trends><applications><application><name>System</name></application></applications><preprocessing><step><type>LTRIM</type><params>Centigrade:</params></step><step><type>REGEX</type><params>^\d{1,2}
\0</params></step></preprocessing><triggers><trigger><expression>{avg(#5)}&gt;60</expression><name>High temperature</name><priority>WARNING</priority></trigger></triggers></item></items><discovery_rules><discovery_rule><name>Logical Disks</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.5127.1.1.1.1.1.9.1.1, {#VOLUMENAME}, .1.3.6.1.4.1.5127.1.1.1.1.1.9.1.2]</snmp_oid><key>ldDiscovery</key><item_prototypes><item_prototype><name>Logical disk {#VOLUMENAME} free space</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.9.1.6.{#SNMPINDEX}</snmp_oid><key>ld.freespace[{#VOLUMENAME}]</key><history>30d</history><trends>90d</trends><units>B</units><applications><application><name>Logical Disks</name></application></applications><preprocessing><step><type>REGEX</type><params>(\d{1,}).(\d{0,})([GT])
\1.\2\3:G=\1.\2:T=\1\200</params></step><step><type>REGEX</type><params>(G|T)(?=.*:\1=(\d{1,}))
\2</params></step><step><type>MULTIPLIER</type><params>1073741824</params></step></preprocessing></item_prototype><item_prototype><name>Logical disk {#VOLUMENAME} FS type</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.9.1.3.{#SNMPINDEX}</snmp_oid><key>ld.fstype[{#VOLUMENAME}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>Logical Disks</name></application></applications></item_prototype><item_prototype><name>Logical disk {#VOLUMENAME} free percent</name><type>CALCULATED</type><key>ld.pfree[{#VOLUMENAME}]</key><history>30d</history><trends>90d</trends><units>%</units><params>100*last(ld.freespace[{#VOLUMENAME}])/last(pd.size[{#VOLUMENAME}])</params><applications><application><name>Logical Disks</name></application></applications><trigger_prototypes><trigger_prototype><expression>{last()}&lt;25</expression><name>Logical Disk {#VOLUMENAME} free space less 25%</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Logical disk {#VOLUMENAME} RAID level</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.9.1.4.{#SNMPINDEX}</snmp_oid><key>ld.raid[{#VOLUMENAME}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>Logical Disks</name></application></applications></item_prototype><item_prototype><name>Logical disk {#VOLUMENAME} size</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.9.1.5.{#SNMPINDEX}</snmp_oid><key>pd.size[{#VOLUMENAME}]</key><delay>1h</delay><history>30d</history><trends>90d</trends><units>B</units><applications><application><name>Logical Disks</name></application></applications><preprocessing><step><type>REGEX</type><params>(\d{1,}).(\d{0,})([GT])
\1.\2\3:G=\1.\2:T=\1\200</params></step><step><type>REGEX</type><params>(G|T)(?=.*:\1=(\d{1,}))
\2</params></step><step><type>MULTIPLIER</type><params>1073741824</params></step></preprocessing></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Physical Disks</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.5127.1.1.1.1.1.10.1.1]</snmp_oid><key>pdDiscovery</key><delay>1h</delay><item_prototypes><item_prototype><name>Disk capacity in slot {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.10.1.6.{#SNMPINDEX}</snmp_oid><key>pd.capacity[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>90d</trends><units>B</units><applications><application><name>Physical Disks</name></application></applications><preprocessing><step><type>RTRIM</type><params> GB.</params></step><step><type>MULTIPLIER</type><params>1073741824</params></step></preprocessing></item_prototype><item_prototype><name>Disk model in slot {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.10.1.3.{#SNMPINDEX}</snmp_oid><key>pd.model[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>Physical Disks</name></application></applications></item_prototype><item_prototype><name>Disk SN in slot {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.10.1.4.{#SNMPINDEX}</snmp_oid><key>pd.SN[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>Physical Disks</name></application></applications></item_prototype><item_prototype><name>Disk temperature in slot {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.10.1.5.{#SNMPINDEX}</snmp_oid><key>pd.temperature[{#SNMPINDEX}]</key><history>30d</history><trends>90d</trends><applications><application><name>Physical Disks</name></application></applications><preprocessing><step><type>LTRIM</type><params>Centigrade:</params></step></preprocessing><trigger_prototypes><trigger_prototype><expression>{avg(#5)}&gt;55</expression><name>Physical disk {#SNMPINDEX} temperature</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Disk vendor in slot {#SNMPINDEX}</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.10.1.2.{#SNMPINDEX}</snmp_oid><key>pd.Vendor[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>Physical Disks</name></application></applications></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>UPSs</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.5127.1.1.1.1.1.11.1.1]</snmp_oid><key>upsDiscovery</key><delay>1h</delay><item_prototypes><item_prototype><name>UPS No{#SNMPINDEX} Battery Charge</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.11.1.5.{#SNMPINDEX}</snmp_oid><key>upsBattery[{#SNMPINDEX}]</key><history>30d</history><trends>90d</trends><value_type>FLOAT</value_type><units>%</units><applications><application><name>UPS</name></application></applications><preprocessing><step><type>RTRIM</type><params> %</params></step></preprocessing><trigger_prototypes><trigger_prototype><expression>{last()}&lt;25</expression><name>Battery Charge Critical</name><priority>HIGH</priority></trigger_prototype><trigger_prototype><expression>{last()}&lt;50</expression><name>Battery Charge Low</name><priority>AVERAGE</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>UPS No{#SNMPINDEX} Manufacturer</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.11.1.3.{#SNMPINDEX}</snmp_oid><key>upsManufacturer[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>UPS</name></application></applications></item_prototype><item_prototype><name>UPS No{#SNMPINDEX} Mode</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.11.1.2.{#SNMPINDEX}</snmp_oid><key>upsMode[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>UPS</name></application></applications></item_prototype><item_prototype><name>UPS No{#SNMPINDEX} Product</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.11.1.4.{#SNMPINDEX}</snmp_oid><key>upsProduct[{#SNMPINDEX}]</key><delay>1h</delay><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>UPS</name></application></applications></item_prototype><item_prototype><name>UPS No{#SNMPINDEX} Status</name><type>SNMP_AGENT</type><snmp_oid>.1.3.6.1.4.1.5127.1.1.1.1.1.11.1.6.{#SNMPINDEX}</snmp_oid><key>upsStatus[{#SNMPINDEX}]</key><history>30d</history><trends>0</trends><value_type>TEXT</value_type><applications><application><name>UPS</name></application></applications><trigger_prototypes><trigger_prototype><expression>{regexp(&quot;On Line&quot;,#3)}=0</expression><name>Battery Status</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule></discovery_rules></template></templates><value_maps><value_map><name>WD My Cloud EX4 FTP Server</name><mappings><mapping><value>0</value><newvalue>disabled</newvalue></mapping><mapping><value>1</value><newvalue>enabled</newvalue></mapping></mappings></value_map><value_map><name>WD My Cloud EX4 Net Type</name><mappings><mapping><value>0</value><newvalue>Workgroup</newvalue></mapping><mapping><value>1</value><newvalue>Active Directory</newvalue></mapping></mappings></value_map></value_maps></zabbix_export>
