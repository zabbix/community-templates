<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:41:59Z</date><groups><group><name>Templates/Hardware</name></group></groups><templates><template><template>Huawei Storage OceanStor 5500 LLD V</template><name>Huawei Storage OceanStor 5500 LLD V</name><description>## Overview

Шаблон состоит из 8 правил обнаружения. Все они настроены на обнаружение индексов и автоматическое создание элементов данных с триггерами. Есть простые правила, например, “Обнаружение БП” – создает элемент данных проверяющий состояние блока питания и триггер, который в случае получения значения не NORMAL создаст проблему. Есть более сложные правила обнаружения с вычисляемыми элементами данных. Так как СХД по SNMP не может сообщить % свободного или занятого места в хранилище мы запрашиваем данные в MB и создаем дополнительный элемент для вычисления %. Триггеры привязываем к %. Такой элемент дает нам удобный график.


Видео про Шаблон:https://youtu.be/HVqw0hHJNEk


Тема про Шаблон:https://vk.com/topic-171974497\_42088542



</description><groups><group><name>Templates/Hardware</name></group></groups><applications><application><name>Disk Domain</name></application><application><name>LUN</name></application><application><name>LUN Performance</name></application><application><name>LUN Space</name></application><application><name>Port Performance</name></application><application><name>Storage Pool</name></application><application><name>Вентиляторы</name></application><application><name>Контроллер</name></application><application><name>Питание</name></application><application><name>Система</name></application></applications><items><item><name>Состояние системы</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.1.3.0</snmp_oid><key>status.0</key><history>1d</history><trends>30d</trends><applications><application><name>Система</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><request_method>POST</request_method><triggers><trigger><expression>{nodata(5m)}=1</expression><name>Нет данных от SNMP агента</name><priority>HIGH</priority><description>Проверите доступность snmp агента СХД</description><tags><tag><tag>Доступность</tag></tag></tags></trigger><trigger><expression>{last()}&lt;&gt;1</expression><name>Проблема с СХД</name><priority>HIGH</priority><description>SNMP проверка. В меню &quot;Последние данные&quot; можно проверить последнее значение состояния СХД. Huawei 15-level HEALTH STATUS E.</description><tags><tag><tag>Доступность</tag></tag></tags></trigger></triggers></item></items><discovery_rules><discovery_rule><name>Обнаружение Контроллеров</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#CONLOCATION},1.3.6.1.4.1.34774.4.1.23.5.2.1.5]</snmp_oid><key>hwInfoController</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>Использование CPU контроллера: {#CONLOCATION} в %</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.2.1.8.{#SNMPINDEX}</snmp_oid><key>hwInfoControllerCPUUsage.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>90d</trends><value_type>FLOAT</value_type><units>%</units><applications><application><name>Контроллер</name></application></applications><trigger_prototypes><trigger_prototype><expression>{avg(15m)}&gt;90</expression><name>Контроллер {#CONLOCATION} использует &gt; 90% CPU</name><priority>HIGH</priority><description>Контроллер {#CONLOCATION} использует &gt; 90% производительности CPU в течение 15 минут</description><tags><tag><tag>Производительность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Состояние контроллера: {#CONLOCATION}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.2.1.2.{#SNMPINDEX}</snmp_oid><key>hwInfoControllerHealthStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>Контроллер</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;1</expression><name>Проблема с контроллером: {#CONLOCATION}</name><priority>HIGH</priority><description>SNMP проверка получила состояние Контроллера не Normal</description><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Использование Memory контроллера: {#CONLOCATION} в %</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.2.1.9.{#SNMPINDEX}</snmp_oid><key>hwInfoControllerMemoryUsage.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>90d</trends><value_type>FLOAT</value_type><units>%</units><applications><application><name>Контроллер</name></application></applications><trigger_prototypes><trigger_prototype><expression>{avg(15m)}&gt;95</expression><name>Контроллер {#CONLOCATION} использует &gt; 95% Memory</name><priority>HIGH</priority><description>Контроллер {#CONLOCATION} использует &gt; 95% производительности памяти в течение 15 минут</description><tags><tag><tag>Производительность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение Disk Domain</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#DISKDNAME},1.3.6.1.4.1.34774.4.1.23.4.1.1.2]</snmp_oid><key>hwInfoDiskDomain</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>Состояние Disk Domain: {#DISKDNAME}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.1.1.3.{#SNMPINDEX}</snmp_oid><key>hwInfoDiskDomainHealthStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>Disk Domain</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;1</expression><name>Проблема с Disk Domain: {#DISKDNAME}</name><priority>HIGH</priority><description>SNMP проверка получила состояние не Normal</description><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Running статус Disk Domain: {#DISKDNAME}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.1.1.4.{#SNMPINDEX}</snmp_oid><key>hwInfoDiskDomainRunningStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>Disk Domain</name></application></applications><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;27</expression><name>Проблема с Disk Domain: {#DISKDNAME}</name><priority>WARNING</priority><description>SNMP проверка получила состояние не Online. Проверьте состояние СХД.</description></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение Fan БП</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#FANID},1.3.6.1.4.1.34774.4.1.23.5.4.1.1,{#FANLOCATION},1.3.6.1.4.1.34774.4.1.23.5.4.1.2]</snmp_oid><key>hwinfoFANPower</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>Состояние вентилятора БП: {#FANLOCATION}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.4.1.3.{#SNMPINDEX}</snmp_oid><key>hwInfoFanHealthStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>Вентиляторы</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;1</expression><name>Проблема с Вентилятором БП: {#FANLOCATION}</name><priority>HIGH</priority><description>SNMP проверка получила состояние Вентилятора БП не Normal&#13;
&#13;
ID:{#FANID}&#13;
Location:{#FANLOCATION}</description><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение LUN</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#LUNID},1.3.6.1.4.1.34774.4.1.23.4.8.1.1,{#LUNNAME},1.3.6.1.4.1.34774.4.1.23.4.8.1.2]</snmp_oid><key>hwInfoLun</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>LUN {#LUNNAME} Capacity в байтах</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.8.1.5.{#SNMPINDEX}</snmp_oid><key>hwInfoLunCapacity.[{#SNMPINDEX}]</key><delay>24h</delay><history>1d</history><units>B</units><applications><application><name>LUN Space</name></application></applications><preprocessing><step><type>MULTIPLIER</type><params>1024</params></step><step><type>MULTIPLIER</type><params>1024</params></step></preprocessing></item_prototype><item_prototype><name>LUN {#LUNNAME} Allocated Capacity в %</name><type>CALCULATED</type><key>hwInfoLunCapacityProc.[{#SNMPINDEX}]</key><delay>5m</delay><history>7d</history><trends>180d</trends><value_type>FLOAT</value_type><units>%</units><params>last(&quot;hwInfoLunSubscribedCapacity.[{#SNMPINDEX}]&quot;)/last(&quot;hwInfoLunCapacity.[{#SNMPINDEX}]&quot;)*100</params><applications><application><name>LUN Space</name></application></applications><trigger_prototypes><trigger_prototype><expression>{last()}&gt;85</expression><name>LUN {#LUNNAME} Allocated Capacity &gt; 85%</name><priority>WARNING</priority><dependencies><dependency><name>LUN {#LUNNAME} Allocated Capacity &gt; 95%</name><expression>{Huawei Storage OceanStor 5500 LLD V:hwInfoLunCapacityProc.[{#SNMPINDEX}].last()}&gt;95</expression></dependency></dependencies><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype><trigger_prototype><expression>{last()}&gt;95</expression><name>LUN {#LUNNAME} Allocated Capacity &gt; 95%</name><priority>HIGH</priority><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Состояние LUN {#LUNNAME}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.8.1.9.{#SNMPINDEX}</snmp_oid><key>hwInfoLunHealthStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>LUN</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;1</expression><name>Проблема с LUN {#LUNNAME}</name><priority>HIGH</priority><description>SNMP проверка получила состояние не Normal&#13;
&#13;
ID:{#LUNID}&#13;
LUN NAME:{#LUNNAME}</description><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>LUN {#LUNNAME} Allocated Capacity в байтах</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.8.1.6.{#SNMPINDEX}</snmp_oid><key>hwInfoLunSubscribedCapacity.[{#SNMPINDEX}]</key><delay>5m</delay><history>7d</history><trends>180d</trends><units>B</units><applications><application><name>LUN Space</name></application></applications><preprocessing><step><type>MULTIPLIER</type><params>1024</params></step><step><type>MULTIPLIER</type><params>1024</params></step></preprocessing></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение Storage Pool</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#POOLNAME},1.3.6.1.4.1.34774.4.1.23.4.2.1.2]</snmp_oid><key>hwInfoPool</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>Storage Pool: {#POOLNAME} Allocated Capacity в %</name><type>CALCULATED</type><key>hwInfoStoragePoolCapacityProc.[{#SNMPINDEX}]</key><delay>5m</delay><history>7d</history><trends>180d</trends><value_type>FLOAT</value_type><units>%</units><params>last(&quot;hwInfoStoragePoolUsed.[{#SNMPINDEX}]&quot;)/last(&quot;hwInfoStoragePoolTotal.[{#SNMPINDEX}]&quot;)*100</params><applications><application><name>Storage Pool</name></application></applications><trigger_prototypes><trigger_prototype><expression>{last()}&gt;85</expression><name>{#POOLNAME} Allocated Capacity &gt; 85%</name><priority>WARNING</priority><dependencies><dependency><name>{#POOLNAME} Allocated Capacity &gt; 95%</name><expression>{Huawei Storage OceanStor 5500 LLD V:hwInfoStoragePoolCapacityProc.[{#SNMPINDEX}].last()}&gt;95</expression></dependency></dependencies><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype><trigger_prototype><expression>{last()}&gt;95</expression><name>{#POOLNAME} Allocated Capacity &gt; 95%</name><priority>HIGH</priority><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Состояние Storage Pool: {#POOLNAME}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.2.1.5.{#SNMPINDEX}</snmp_oid><key>hwInfoStoragePoolHealthStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>Storage Pool</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;1</expression><name>Проблема с Storage Pool: {#POOLNAME}</name><priority>HIGH</priority><description>SNMP проверка получила состояние Pool-а не Normal&#13;
В меню &quot;Последние данные&quot; можно проверить состояние pool-а</description><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Storage Pool: {#POOLNAME} Capacity в байтах</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.2.1.7.{#SNMPINDEX}</snmp_oid><key>hwInfoStoragePoolTotal.[{#SNMPINDEX}]</key><delay>24h</delay><history>1d</history><units>B</units><applications><application><name>Storage Pool</name></application></applications><preprocessing><step><type>MULTIPLIER</type><params>1024</params></step><step><type>MULTIPLIER</type><params>1024</params></step></preprocessing></item_prototype><item_prototype><name>Storage Pool: {#POOLNAME} Allocated Capacity в байтах</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.2.1.8.{#SNMPINDEX}</snmp_oid><key>hwInfoStoragePoolUsed.[{#SNMPINDEX}]</key><delay>5m</delay><history>7d</history><trends>180d</trends><units>B</units><applications><application><name>Storage Pool</name></application></applications><preprocessing><step><type>MULTIPLIER</type><params>1024</params></step><step><type>MULTIPLIER</type><params>1024</params></step></preprocessing></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение БП</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#POWERID},1.3.6.1.4.1.34774.4.1.23.5.3.1.1,{#PLOCATION},1.3.6.1.4.1.34774.4.1.23.5.3.1.2,{#PMODEL},1.3.6.1.4.1.34774.4.1.23.5.3.1.7]</snmp_oid><key>hwinfoPower</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>Состояние БП: {#PLOCATION}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.3.1.3.{#SNMPINDEX}</snmp_oid><key>hwInfoPowerHealthStatus.[{#SNMPINDEX}]</key><delay>5m</delay><history>1d</history><trends>30d</trends><applications><application><name>Питание</name></application></applications><valuemap><name>Huawei 15-level HEALTH STATUS E (СХД)</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;1</expression><name>Проблема с БП: {#PLOCATION}</name><priority>HIGH</priority><description>SNMP проверка получила состояние БП не Normal&#13;
&#13;
Модель БП:{#PMODEL}&#13;
ID:{#POWERID}&#13;
Location:{#PLOCATION}</description><tags><tag><tag>Доступность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение Performance LUN</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#LUNPID},1.3.6.1.4.1.34774.4.1.21.4.1.1]</snmp_oid><key>hwPerformanceLun</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>LUN {$LUNID{#LUNPID}} Read IOPS</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.4.{#SNMPINDEX}</snmp_oid><key>hwPerfLunReadIOPS.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>IO/s</units><applications><application><name>LUN Performance</name></application></applications></item_prototype><item_prototype><name>LUN {$LUNID{#LUNPID}} Read bandwidth MB/s</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.7.{#SNMPINDEX}</snmp_oid><key>hwPerfLunReadTraffic.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>MB/s</units><applications><application><name>LUN Performance</name></application></applications></item_prototype><item_prototype><name>LUN {$LUNID{#LUNPID}} Total IOPS</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.3.{#SNMPINDEX}</snmp_oid><key>hwPerfLunTotalIOPS.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>IO/s</units><applications><application><name>LUN Performance</name></application></applications></item_prototype><item_prototype><name>LUN {$LUNID{#LUNPID}} Total bandwidth MB/s</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.6.{#SNMPINDEX}</snmp_oid><key>hwPerfLunTotalTraffic.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>MB/s</units><applications><application><name>LUN Performance</name></application></applications></item_prototype><item_prototype><name>LUN {$LUNID{#LUNPID}} Write IOPS</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.5.{#SNMPINDEX}</snmp_oid><key>hwPerfLunWriteIOPS.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>IO/s</units><applications><application><name>LUN Performance</name></application></applications></item_prototype><item_prototype><name>LUN {$LUNID{#LUNPID}} Write bandwidth MB/s</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.8.{#SNMPINDEX}</snmp_oid><key>hwPerfLunWriteTraffic.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>MB/s</units><applications><application><name>LUN Performance</name></application></applications></item_prototype></item_prototypes></discovery_rule><discovery_rule><name>Обнаружение Performance Port</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#PORTLOCATION},1.3.6.1.4.1.34774.4.1.21.5.1.11]</snmp_oid><key>hwPortPerformance</key><delay>1d</delay><lifetime>7d</lifetime><item_prototypes><item_prototype><name>Port: {#PORTLOCATION} I/O latancy</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.34774.4.1.21.5.1.2.{#SNMPINDEX}</snmp_oid><key>hwPerfPortDelay.[{#SNMPINDEX}]</key><history>7d</history><trends>30d</trends><units>ms</units><applications><application><name>Port Performance</name></application></applications><trigger_prototypes><trigger_prototype><expression>{last()}&gt;40</expression><name>I/O latancy Port: {#PORTLOCATION} &gt; 40 мс</name><priority>AVERAGE</priority><description>Проверьте состояние СХД, возможны проблемы с производительностью.</description><tags><tag><tag>Производительность</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule></discovery_rules><macros><macro><macro>{$SNMPV3_AUTHPASS}</macro><value>пароль</value></macro><macro><macro>{$SNMPV3_PRIVPASS}</macro><value>пароль</value></macro><macro><macro>{$SNMPV3_SECNAME}</macro><value>логин</value></macro></macros></template></templates><value_maps><value_map><name>Huawei 15-level HEALTH STATUS E (СХД)</name><mappings><mapping><value>1</value><newvalue>Normal</newvalue></mapping><mapping><value>2</value><newvalue>Fault</newvalue></mapping><mapping><value>3</value><newvalue>Pre-fail</newvalue></mapping><mapping><value>4</value><newvalue>Partially broken</newvalue></mapping><mapping><value>5</value><newvalue>Degraded</newvalue></mapping><mapping><value>6</value><newvalue>Bad sectors found</newvalue></mapping><mapping><value>7</value><newvalue>Bit errors found</newvalue></mapping><mapping><value>8</value><newvalue>Consistent</newvalue></mapping><mapping><value>9</value><newvalue>Inconsistent</newvalue></mapping><mapping><value>10</value><newvalue>Busy</newvalue></mapping><mapping><value>11</value><newvalue>No input</newvalue></mapping><mapping><value>12</value><newvalue>Low battery</newvalue></mapping><mapping><value>13</value><newvalue>Single link fault</newvalue></mapping><mapping><value>14</value><newvalue>Invalid</newvalue></mapping><mapping><value>15</value><newvalue>Write protect</newvalue></mapping></mappings></value_map></value_maps></zabbix_export>
