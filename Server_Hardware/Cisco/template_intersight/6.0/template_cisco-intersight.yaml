zabbix_export:
  version: '6.2'
  date: '2022-07-05T13:25:56Z'
  template_groups:
    -
      uuid: 763811688ed043bfb25fe1b71c52bfcf
      name: intersight
    -
      uuid: 75af14cc10ae4b269ab1a4e7f7083927
      name: Templates/Intersight
  host_groups:
    -
      uuid: 763811688ed043bfb25fe1b71c52bfcf
      name: intersight
  templates:
    -
      uuid: 4839908406fb41b7aca123ff4b5ee199
      template: 'Cisco Intersight'
      name: 'Cisco Intersight'
      description: |
        This templates connects to Intersight by a single host. 
        LLD discovers Computer (Blade & Rack) but can be expanded to anything Intersight controls
      groups:
        -
          name: Templates/Intersight
      items:
        -
          uuid: d17e89b50f2549d79efe1ed784034d2d
          name: 'Rackunits JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "rackunit"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: 'Used in Discovery rule'
        -
          uuid: e1b9c01a0a09483d90eda22f42f8268c
          name: 'Blade Chassis JSON'
          type: EXTERNAL
          key: 'isctl["get", "equipment", "chassis"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: 'Used in Discovery rule Chassis'
        -
          uuid: 7b3c155c18dd43ed98ec265017b34956
          name: 'Network Elements JSON'
          type: EXTERNAL
          key: 'isctl["get", "network", "element", "--select","''Moid''","--select","''SwitchType''"]'
          delay: 1h
          trends: '0'
          value_type: TEXT
          description: |
            Used for Autodiscover
            
            This ITEM can potentially detect all type of Network Elements, not just Fabric Interconnect. Each Autodiscover rule should filter on SwitchType to match the right Equipment Template.
      discovery_rules:
        -
          uuid: 9467682b9acf46c49083af976f1da84b
          name: 'Cisco Intersight Rack Units'
          type: DEPENDENT
          key: intersight.compute.rackunits
          delay: '0'
          host_prototypes:
            -
              uuid: 7cb1c2c6d0b6479289c8a52face7a801
              host: '{#MOID}'
              name: '{#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              templates:
                -
                  name: 'Cisco Intersight Rackservers'
              tags:
                -
                  tag: ClassId
                  value: intersight.compute.rackUnit
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "compute", "rackunit"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
        -
          uuid: c2c43d28da2e44579e4333163a266f15
          name: 'Cisco Intersight Chassis'
          type: DEPENDENT
          key: intersight.equipment.chassis
          delay: '0'
          host_prototypes:
            -
              uuid: cea293ba1315417982713480686b3354
              host: '{#MOID}'
              name: 'Chassis: {#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              templates:
                -
                  name: 'Cisco Intersight Blade Chassis'
              tags:
                -
                  tag: ClassId
                  value: equipment.Chassis
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "equipment", "chassis"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
        -
          uuid: e896e1b3c43549838c2ef93b34897919
          name: 'Intersight FabricInterconnect'
          type: DEPENDENT
          key: intersight.network.element.fabricinterconnects
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: FabricInterConnect
                formulaid: A
          host_prototypes:
            -
              uuid: 5332ab454c55425cbee36bbf88133895
              host: '{#MOID}'
              name: '{#MOID}'
              group_links:
                -
                  group:
                    name: intersight
              group_prototypes:
                -
                  name: '{#TYPE}'
              templates:
                -
                  name: 'Cisco Intersight Fabric Interconnects'
              tags:
                -
                  tag: ClassId
                  value: network.Element
                -
                  tag: SwitchType
                  value: FabricInterconnect
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "network", "element", "--select","''Moid''","--select","''SwitchType''"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#TYPE}'
              path: $.SwitchType
    -
      uuid: 07287944debb4d97b9b739615cf83629
      template: 'Cisco Intersight Blade Chassis'
      name: 'Cisco Intersight Blade Chassis'
      groups:
        -
          name: Templates/Intersight
      items:
        -
          uuid: 433bcfcc8e5a45ceaaf1c626ff81f89f
          name: ConnectionPath
          type: DEPENDENT
          key: intersight.equipment.chassis.connectionpath
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ConnectionPath
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 33b136b1a51443f597af6bbac08f46fa
          name: ConnectionStatus
          type: DEPENDENT
          key: intersight.equipment.chassis.connectionstatus
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ConnectionStatus
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 9a47dae1fc424ec59f1b0cca34cefcce
          name: ManagementMode
          type: DEPENDENT
          key: intersight.equipment.chassis.managementmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 3275f7110d194f71b1091fb7769cc894
          name: Model
          type: DEPENDENT
          key: intersight.equipment.chassis.model
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: HARDWARE
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Model
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 9ad494f03fbd42b79aabecaec821be3a
          name: PartNumber
          type: DEPENDENT
          key: intersight.equipment.chassis.partnumber
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: HARDWARE_FULL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..PartNumber
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: f184bf67a76147b8a4e1259c0ff5e676
          name: PlatformType
          type: DEPENDENT
          key: intersight.equipment.chassis.platformtype
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..PlatformType
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 7383a518a7684a678a377c1849ccb2fc
          name: Serial
          type: DEPENDENT
          key: intersight.equipment.chassis.serial
          delay: '0'
          history: 1d
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 29c44f1040e74ab8b1767ee9d2cf1df5
          name: Vendor
          type: DEPENDENT
          key: intersight.equipment.chassis.vendor
          delay: '0'
          history: 1d
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 6888cb6f224741d8a3df5c1b75ad489c
          name: 'Chassis JSON'
          type: EXTERNAL
          key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get equipment chassis --filter "Moid eq '5d043f5a6176752d311de58d'" --expand 'Blades($select=Name,Moid)'
            
            Expand Blades, used to get Moid, Name from each Bladeunit, select is used to limit the result
      discovery_rules:
        -
          uuid: 087e450e624c44a4a979c57ec6844ca1
          name: 'Cisco Intersight Blade Servers'
          type: DEPENDENT
          key: intersight.compute.bladeunits
          delay: '0'
          description: 'This LLD Detects installed bladeunits in Chassis'
          host_prototypes:
            -
              uuid: b01ff2d6b144418a8de0ebf5900b03c6
              host: '{#MOID}'
              name: '{#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              templates:
                -
                  name: 'Cisco Intersight Bladeservers'
              tags:
                -
                  tag: ObjectType
                  value: compute.Blade
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Blades']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 62b84138652043f68c83d8a15950b7f5
          name: Fanmodules
          type: DEPENDENT
          key: intersight.compute.chassis.fans
          delay: '0'
          item_prototypes:
            -
              uuid: a205e7212e9e428c84de884f988e4bc1
              name: 'Fan {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "Fansmodule.Moid eq ''[{#MOID}]''"]'
              delay: 15m
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                CLI Command
                
                isctl get cond alarm --filter "Fansmodule.Moid eq '5effb6d86176752d34ab0428'"
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.FanModule
              trigger_prototypes:
                -
                  uuid: b3ad2e68c485483ab873c36d3aac6ea3
                  expression: 'in(last(/Cisco Intersight Blade Chassis/isctl["get", "cond", "alarm", "--filter", "Fansmodule.Moid eq ''[{#MOID}]''"]),"No Active Alarms")=0'
                  name: 'Fan {#ID} - Active Alarms'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#MOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Fanmodules']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 4d4c366a85994669b6446c8712da8707
          name: 'PSU modules'
          type: DEPENDENT
          key: intersight.compute.chassis.psus
          delay: '0'
          item_prototypes:
            -
              uuid: fee615bc6c124de281ddc83e86d3c823
              name: 'PSU {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "Psus.Moid eq ''[{#MOID}]''"]'
              delay: 15m
              history: 1d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.Psu
              trigger_prototypes:
                -
                  uuid: f8df26cdbedc417b8a58911bd12e133a
                  expression: 'in(last(/Cisco Intersight Blade Chassis/isctl["get", "cond", "alarm", "--filter", "Psus.Moid eq ''[{#MOID}]''"]),"No Active Alarms")=0'
                  name: 'PSU {#ID} - Active Alarms'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#MOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Psus']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
    -
      uuid: 14bdaeaac7eb48ca80eda6b4c65b14a8
      template: 'Cisco Intersight Bladeservers'
      name: 'Cisco Intersight Bladeservers'
      templates:
        -
          name: 'Cisco Intersight HCL'
      groups:
        -
          name: intersight
        -
          name: Templates/Intersight
      items:
        -
          uuid: 97908395367e45fd95d56a2c33f6602f
          name: Operability
          type: DEPENDENT
          key: intersight.compute.blade.operability
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Operability
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 326c45a96b8c4130b3914c4c310771cc
          name: OperState
          type: DEPENDENT
          key: intersight.compute.blade.operstate
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperState
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: STR_REPLACE
              parameters:
                - '""'
                - '<empty>'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: d09c7f4ba92b42f4993363f7d03920b1
              expression: 'in(last(/Cisco Intersight Bladeservers/intersight.compute.blade.operstate),"","ok","power-off")=0'
              name: 'OperState was detected as {ITEM.LASTVALUE}'
              opdata: 'OperState is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 72df9deaf1f44cb88ca7bfae71af4d8d
          name: Vendor
          type: DEPENDENT
          key: intersight.compute.blade.vendor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: aebea610f7d74b12b2db946e235969ef
          name: ManagementMode
          type: DEPENDENT
          key: intersight.compute.managementmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: f1db029fede44870b25c08b5e0945bdd
          name: MgmtIpAddress
          type: DEPENDENT
          key: intersight.compute.mgmtipaddress
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_IP
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..MgmtIpAddress
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: ee019dcdfb5a4dbfab9bfbdcfca48378
          name: PowerState
          type: DEPENDENT
          key: intersight.compute.powerstate
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperPowerState
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 460ee04f04df4551a30ff44839bf0c81
              expression: 'in(last(/Cisco Intersight Bladeservers/intersight.compute.powerstate),"on")=0'
              name: 'PowerState is not on'
              priority: INFO
        -
          uuid: 44bec83184614ebf83b7bab38c9f9a96
          name: 'Compute Serial Number'
          type: DEPENDENT
          key: intersight.compute.serialnumber
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: acdb1bc046694da49806d1188b8a6e4f
          name: 'Bladeunit JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get compute blade moid 59a5a5a1103b880001653567
          triggers:
            -
              uuid: 09562ae900144669ae45259d49d03456
              expression: 'in(last(/Cisco Intersight Bladeservers/isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]),"operable")=0'
              name: 'Operability is not detected as operable'
              opdata: 'Operability is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
        -
          uuid: 5573b23a063448cf98b28f3ad19f7cf7
          name: 'Alarms on Compute Unit'
          type: EXTERNAL
          key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]'
          delay: 5m
          trends: '0'
          value_type: LOG
          description: |
            isctl["get", "cond", "alarm", "—filter", "AffectedMoId eq '{HOST.HOST}'"]
            
            Example CLI Commandisctl get cond alarm --filter "AffectedMoId eq '5a2ba72929378e00019e3e8d'"
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Description
              error_handler: CUSTOM_VALUE
              error_handler_params: 'All good'
            -
              type: TRIM
              parameters:
                - '[]"'
          triggers:
            -
              uuid: d397225788b1486887e56a173f67e3b4
              expression: 'in(last(/Cisco Intersight Bladeservers/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]),"All good")=0'
              name: 'Alarms on Compute Unit'
              opdata: 'Alarms on Compute unit is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
      discovery_rules:
        -
          uuid: 4bc63280df31498e9777db4112656447
          name: LocatorLed
          type: DEPENDENT
          key: intersight.compute.blade.locaterled
          delay: '0'
          item_prototypes:
            -
              uuid: a41ba22e9acf4f1ab6bcde7bc2c5bb69
              name: 'Locator Led Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "LocatorLed.Moid eq ''[{#MOID}]''"]'
              delay: 15m
              trends: '0'
              value_type: TEXT
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.LocatorLed.Moid
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: cisco-ucs
    -
      uuid: 9ccf2ee8df0b4031bb13ebcbc06eb1d1
      template: 'Cisco Intersight Fabric Interconnects'
      name: 'Cisco Intersight Fabric Interconnects'
      groups:
        -
          name: Templates/Intersight
    -
      uuid: c10593b45cf449c29678f233dc0aaa4d
      template: 'Cisco Intersight HCL'
      name: 'Cisco Intersight HCL'
      groups:
        -
          name: intersight
        -
          name: Templates/Intersight
      items:
        -
          uuid: 71203c3978e341c6823a72d01675b09d
          name: HardwareStatus
          type: DEPENDENT
          key: intersight.hcl.hardwarestatus
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HardwareStatus
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: 8dbeb7253124442189adf34e662c94c5
              expression: 'find(/Cisco Intersight HCL/intersight.hcl.hardwarestatus,,"like","Validated")=0'
              name: 'HCL Hardwarestatus: {ITEM.LASTVALUE}'
              priority: WARNING
              tags:
                -
                  tag: AlarmType
                  value: HCL
        -
          uuid: d855bc1c34774ff09b55b752627ca9e0
          name: HclModel
          type: DEPENDENT
          key: intersight.hcl.hclmodel
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HclModel
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: f8265ed14cd54fceb12d065de0c9bbab
          name: HclOsVendor
          type: DEPENDENT
          key: intersight.hcl.hclosvendor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OS
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HclOsVendor
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: e6e6b7f42d394336909f782e598ed678
          name: HclProcessor
          type: DEPENDENT
          key: intersight.hcl.hclprocessor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: HW_ARCH
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HclProcessor
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: 0b59ab70afb44d7eb181054eb4bcddcf
          name: InvFirmwareVersion
          type: DEPENDENT
          key: intersight.hcl.invfirmwareversion
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: SOFTWARE
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..InvFirmwareVersion
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: 9c5f97e827824b4f9e588cabf56f420c
          name: InvOsVersion
          type: DEPENDENT
          key: intersight.hcl.invosversion
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OS_FULL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..InvOsVersion
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: 996d59e5646f4fb2a34bf2eecc3d1b7a
          name: ServerReason
          type: DEPENDENT
          key: intersight.hcl.serverreason
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ServerReason
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: 64f9a64f751a4c22a0ad2e83ee67415c
              expression: 'find(/Cisco Intersight HCL/intersight.hcl.serverreason,,"like","Compatible")=0'
              name: 'HCL Reason: {ITEM.LASTVALUE}'
              priority: WARNING
              tags:
                -
                  tag: AlarmType
                  value: HCL
        -
          uuid: 71bd0e82572d4b509fb51f645b645ecc
          name: SoftwareStatus
          type: DEPENDENT
          key: intersight.hcl.softwarestatus
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..SoftwareStatus
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: bc095435c9044260a2c5ea077fdfb01a
              expression: 'in(last(/Cisco Intersight HCL/intersight.hcl.softwarestatus),"Validated")=0'
              name: 'HCL SoftwareStatus not Validated'
              opdata: 'HCL SoftwareStatus is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: e69d02d66d394a04bc3319f386079ec3
          name: Status
          type: DEPENDENT
          key: intersight.hcl.status
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Status
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: a0e5634509384a59a30c1d963f12a5c7
              expression: 'in(last(/Cisco Intersight HCL/intersight.hcl.status),"Validated")=0'
              name: 'HCL Status not validated'
              event_name: 'HCL Status is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 7c258e71bc0a48c28896071340209724
          name: 'HCL Status JSON'
          type: EXTERNAL
          key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          delay: 60m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            CLI Command
            
            isctl get cond hclstatus --filter "ManagedObject.Moid eq '59a5a5a1103b880001653564'"
            
            isctl["get", "compute", "rackunit", "—filter", "Moid eq '59a5a5a1103b880001653567'"]
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: cisco-ucs
    -
      uuid: 3ca4f40d85a64cc69b50d89b72fcc260
      template: 'Cisco Intersight Pure Storage'
      name: 'Cisco Intersight Pure Storage'
      groups:
        -
          name: Templates/Intersight
    -
      uuid: e4383eed3b9b4e87b522031ce0330abb
      template: 'Cisco Intersight Rackservers'
      name: 'Cisco Intersight Rackservers'
      templates:
        -
          name: 'Cisco Intersight HCL'
      groups:
        -
          name: intersight
        -
          name: Templates/Intersight
      items:
        -
          uuid: c297068bee90421ba5b2b8603dc2c805
          name: ManagementMode
          type: DEPENDENT
          key: intersight.compute.managementmode
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: fff790f28b5246be9c095a00a63b5a43
          name: MgmtIpAddress
          type: DEPENDENT
          key: intersight.compute.mgmtipaddress
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_IP
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..MgmtIpAddress
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 88e3f096883547ee8cd98b88151df095
          name: Operability
          type: DEPENDENT
          key: intersight.compute.operability
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Operability
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 16040e47f378450d8d199fb1cfd32467
              expression: 'in(last(/Cisco Intersight Rackservers/intersight.compute.operability),"operable")=0'
              name: 'Operability is not detected as operable'
              opdata: 'Operability is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
        -
          uuid: 2a2f998d60364c3498304604ca839d88
          name: PowerState
          type: DEPENDENT
          key: intersight.compute.powerstate
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperPowerState
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 69e5cde16d2f473589c96d92a314ecd3
              expression: 'in(last(/Cisco Intersight Rackservers/intersight.compute.powerstate),"on")=0'
              name: 'PowerState is not on'
              priority: INFO
        -
          uuid: 0fef43f1656740ab95a18581841b5ae9
          name: OperState
          type: DEPENDENT
          key: intersight.compute.rackunit.operstate
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperState
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 7585368f59854337ae83151bd6b60041
              expression: 'in(last(/Cisco Intersight Rackservers/intersight.compute.rackunit.operstate),"ok","power-off")=0'
              name: 'OperState was detected as {ITEM.LASTVALUE}'
              opdata: 'OperState is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 2415339376c745db95a79643eb094d38
          name: Vendor
          type: DEPENDENT
          key: intersight.compute.rackunit.vendor
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 8e6da14b047b4cbda4d48c7d0a65b2f3
          name: 'Compute Serial number'
          type: DEPENDENT
          key: intersight.compute.serialnumber
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: a347ce22b2b041868f79ec473a8cf6c5
          name: 'Rackunit JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get compute rackunit moid 59a5a5a1103b880001653567
        -
          uuid: 3128404475df491cac3865765391c263
          name: 'Alarms on Compute Unit'
          type: EXTERNAL
          key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]'
          delay: 5m
          trends: '0'
          value_type: LOG
          description: |
            isctl["get", "cond", "alarm", "—filter", "AffectedMoId eq '{HOST.HOST}'"]
            
            Example CLI Commandisctl get cond alarm --filter "AffectedMoId eq '5a2ba72929378e00019e3e8d'"
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Description
              error_handler: CUSTOM_VALUE
              error_handler_params: 'All good'
            -
              type: TRIM
              parameters:
                - '[]"'
          triggers:
            -
              uuid: 4333c645703741999503bc7fc11d3b7f
              expression: 'in(last(/Cisco Intersight Rackservers/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]),"All good")=0'
              name: 'Alarms on Compute Unit'
              opdata: 'Alarms on Compute unit is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
      discovery_rules:
        -
          uuid: f8799743c5d346d7b8e56eaad1effd67
          name: Fanmodules
          type: DEPENDENT
          key: intersight.compute.rackunit.fans
          delay: '0'
          item_prototypes:
            -
              uuid: 1ef501b388804d8c94068de5d01d629d
              name: 'Fan {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "Fansmodule.Moid eq ''[{#MOID}]''"]'
              delay: 15m
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                CLI Command
                
                isctl get cond alarm --filter "Fansmodule.Moid eq '5effb6d86176752d34ab0428'"
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.FanModule
              trigger_prototypes:
                -
                  uuid: 53fbb55ced6b41bf943f707595adc8a1
                  expression: 'in(last(/Cisco Intersight Rackservers/isctl["get", "cond", "alarm", "--filter", "Fansmodule.Moid eq ''[{#MOID}]''"]),"No Active Alarms")=0'
                  name: 'Fan {#ID} - Active Alarms'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#MOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Fanmodules']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 75213b52ac8e499e963d61cd75cd85b7
          name: LocatorLed
          type: DEPENDENT
          key: intersight.compute.rackunit.locaterled
          delay: '0'
          item_prototypes:
            -
              uuid: 4cfafa8a68a14cfa9371ad49ba9975ce
              name: 'Locator Led Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "LocatorLed.Moid eq ''[{#MOID}]''"]'
              delay: 15m
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: TRIM
                  parameters:
                    - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.LocatorLed.Moid
        -
          uuid: aabfbdb8fe5e483b81ae424a395dec8d
          name: 'PSU modules'
          type: DEPENDENT
          key: intersight.compute.rackunit.psus
          delay: '0'
          item_prototypes:
            -
              uuid: 8fef8cead9054bd8b59037e6d0babd56
              name: 'PSU {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "Psus.Moid eq ''[{#MOID}]''"]'
              delay: 15m
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.Psu
              trigger_prototypes:
                -
                  uuid: e20052b0ac7e4591840faed38470b078
                  expression: 'in(last(/Cisco Intersight Rackservers/isctl["get", "cond", "alarm", "--filter", "Psus.Moid eq ''[{#MOID}]''"]),"No Active Alarms")=0'
                  name: 'PSU {#ID} - Active Alarms'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#MOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Psus']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: cisco-ucs
  triggers:
    -
      uuid: f885bbff30be43009e4cb7ea201e900b
      expression: 'last(/Cisco Intersight Blade Chassis/intersight.equipment.chassis.connectionstatus)<>last(/Cisco Intersight Blade Chassis/intersight.equipment.chassis.connectionpath)=1'
      name: 'ConnectionStatus needs investigation'
      priority: WARNING
      description: 'Compare connectionStatus with ConnectionPath, if not equal, something might be wrong'
