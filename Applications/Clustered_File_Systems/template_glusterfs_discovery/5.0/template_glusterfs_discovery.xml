<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:32:10Z</date><groups><group><name>Templates</name></group></groups><templates><template><template>Gluster Storage</template><name>Gluster Storage</name><description>## Overview

 This project was created to monitor Gluster Storage with Zabbix. In this repository there are two files. One python script that calls [gstatus](https://github.com/gluster/gstatus), discovering gluster volumes and print data we want, according to the arguments given. You have to install gstatus [gstatus](https://github.com/gluster/gstatus)


You should save the script in any directory you want, in order to do it executable from zabbix user using sudo. You have to create a file in /etc/zabbix/zabbix\_server.conf.d/ and add UserParameters:


* You should save the script in any directory you want, do it executable from zabbix user using sudo.
* You have to create a file in /etc/zabbix/zabbix\_server.conf.d/ and add UserParameters: ... UserParameter=gluster\_volume\_info[*],sudo /path/gstatus\_discovery.py $1 $2 UserParameter=gluster\_storage\_info[*],sudo /path/gstatus\_discovery.py $1 UserParameter=gluster\_volume\_info,sudo /path/gstatus\_discovery.py
* The last one shoud be import zabbix\_template.xml in zabbix


You can check my [github repository](https://github.com/MrCirca/zabbix-glusterfs)



## Author

MrCirca

</description><groups><group><name>Templates</name></group></groups><items><item><name>Gluster Storage % Free Space</name><type>CALCULATED</type><key>gluster_storage_free_space</key><delay>2m</delay><units>%</units><params>100*((last(&quot;gluster_storage_info[\&quot;usable_capacity\&quot;]&quot;)-last(&quot;gluster_storage_info[\&quot;used_capacity\&quot;]&quot;))/last(&quot;gluster_storage_info[\&quot;usable_capacity\&quot;]&quot;))</params></item><item><name>Gluster Storage Active Nodes</name><key>gluster_storage_info[&quot;nodes_active&quot;]</key><delay>2m</delay></item><item><name>Gluster Storage Nodes</name><key>gluster_storage_info[&quot;node_count&quot;]</key><delay>2m</delay></item><item><name>Gluster Storage raw capacity</name><key>gluster_storage_info[&quot;raw_capacity&quot;]</key><delay>2m</delay><units>b</units></item><item><name>Gluster Storage Self Heal Active</name><key>gluster_storage_info[&quot;sh_active&quot;]</key><delay>2m</delay></item><item><name>Gluster Storage Self Heal Enabled</name><key>gluster_storage_info[&quot;sh_enabled&quot;]</key><delay>2m</delay></item><item><name>Gluster Storage Snapshots</name><key>gluster_storage_info[&quot;snapshot_count&quot;]</key><delay>2m</delay></item><item><name>Gluster Storage status</name><key>gluster_storage_info[&quot;status&quot;]</key><delay>2m</delay><trends>0</trends><value_type>TEXT</value_type><triggers><trigger><expression>{str(healthy)}=0</expression><name>Gluster volume status is Unhealthy</name><priority>WARNING</priority></trigger></triggers></item><item><name>Gluster Storage Total Size</name><key>gluster_storage_info[&quot;usable_capacity&quot;]</key><delay>2m</delay><units>b</units></item><item><name>Gluster Storage Used Size</name><key>gluster_storage_info[&quot;used_capacity&quot;]</key><delay>2m</delay><units>b</units></item><item><name>Gluster Storage Volume Number</name><key>gluster_storage_info[&quot;volume_count&quot;]</key><delay>2m</delay></item></items><discovery_rules><discovery_rule><name>Gluster Volume Names Discovery</name><key>gluster_volume_name.discovery</key><delay>30s</delay><item_prototypes><item_prototype><name>Gluster Volume % Free Space {#VOLUME_NAME}</name><type>CALCULATED</type><key>gluster_volume_free_space[{#VOLUME_NAME}]</key><delay>30s</delay><units>%</units><params>100*((last(&quot;gluster_volume_info[\&quot;usable_capacity\&quot;,{#VOLUME_NAME}]&quot;)-last(&quot;gluster_volume_info[\&quot;used_capacity\&quot;,{#VOLUME_NAME}]&quot;))/last(&quot;gluster_volume_info[\&quot;usable_capacity\&quot;,{#VOLUME_NAME}]&quot;))</params><trigger_prototypes><trigger_prototype><expression>{last(,5m)}&lt;20</expression><name>Gluster Volume Free Space is less than 20%</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Gluster Volume snapshot_count on {#VOLUME_NAME}</name><key>gluster_volume_info[&quot;snapshot_count&quot;,{#VOLUME_NAME}]</key><delay>30s</delay></item_prototype><item_prototype><name>Gluster Volume state on {#VOLUME_NAME}</name><key>gluster_volume_info[&quot;state&quot;,{#VOLUME_NAME}]</key><delay>30s</delay><trends>0</trends><value_type>TEXT</value_type><trigger_prototypes><trigger_prototype><expression>{str(up)}=0</expression><name>Gluster Volume state in {#VOLUME_NAME} is down</name><priority>WARNING</priority></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><name>Gluster Volume Total Size on {#VOLUME_NAME}</name><key>gluster_volume_info[&quot;usable_capacity&quot;,{#VOLUME_NAME}]</key><delay>30s</delay><units>b</units></item_prototype><item_prototype><name>Gluster Volume Used Size on {#VOLUME_NAME}</name><key>gluster_volume_info[&quot;used_capacity&quot;,{#VOLUME_NAME}]</key><delay>30s</delay><units>b</units></item_prototype></item_prototypes></discovery_rule></discovery_rules></template></templates><triggers><trigger><expression>{Gluster Storage:gluster_storage_info[&quot;nodes_active&quot;].last()} &lt; {Gluster Storage:gluster_storage_info[&quot;node_count&quot;].last()}</expression><name>Gluster storage nodes is not online</name><priority>INFO</priority></trigger></triggers></zabbix_export>
