<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T22:02:44Z</date><groups><group><name>User templates</name></group></groups><templates><template><template>ESA-CISCO XML Status</template><name>ESA-CISCO XML Status</name><description>## Overview

Template allows to monitor your CISCO ESA ( IRONPORT ). number of active recipients, number of completed recipietns per minute, number of injected (recieved by esa) messages per minute, number of connections and so on. For now there is no triggers.


Installation:


1. import the template,
2. create read\_only\_operator user in your ESA,
3. create and fill in value macros in zabbix ESA host: {$IRP\_LOGIN} for login and {$IRP\_PASS} for password (both created on step 2)
4. link imported template to ESA host


Default update interval is 5 min. you can chage it in &quot;Get\_Ironport\_xml\_status&quot; item.


Tempalate contains 28 items. &quot;HTTP agent&quot; item (Get\_Ironport\_xml\_status) reads xml status page from ESA (https://{HOST.IP}/xml/status) and 27 dependet items, using preproceccing and XML Path to get items from XML:


* 5xx\_hard\_bounced\_recips
* active\_recips
* completed\_recips
* completed\_recips\_last\_1\_min
* conn\_in
* conn\_out
* deleted\_recips
* delivered\_recips
* delivered\_recips\_last\_1\_min
* dns\_hard\_bounced\_recips
* dropped\_msgs
* expired\_hard\_bounced\_recips
* filter\_hard\_bounced\_recips
* gen\_bounce\_recips
* global\_unsub\_hits
* hard\_bounced\_recips
* hard\_bounced\_recips\_last\_1\_min
* inj\_msgs
* inj\_msgs\_last\_1\_min
* inj\_recips
* inj\_recips\_last\_1\_min
* kbytes\_in\_policy\_virus\_outbreak\_quarantine
* msgs\_in\_policy\_virus\_outbreak\_quarantine
* other\_hard\_bounced\_recips
* rejected\_recips
* soft\_bounced\_evts
* soft\_bounced\_evts\_last\_1\_min


## Author

DK

</description><groups><group><name>User templates</name></group></groups><applications><application><name>counters</name></application><application><name>gauges</name></application><application><name>rates</name></application></applications><items><item><name>5xx_hard_bounced_recips lifetime</name><type>DEPENDENT</type><key>5xx_hard_bounced_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;5xx_hard_bounced_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>active_recips</name><type>DEPENDENT</type><key>active_recips</key><delay>0</delay><applications><application><name>gauges</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/gauges/gauge[@name=&quot;active_recips&quot;]/@current</params></step><step><type>STR_REPLACE</type><params>current=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>completed_recips lifetime</name><type>DEPENDENT</type><key>completed_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;completed_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>completed_recips per 1m</name><type>DEPENDENT</type><key>completed_recips_last_1_min</key><delay>0</delay><applications><application><name>rates</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/rates/rate[@name=&quot;completed_recips&quot;]/@last_1_min</params></step><step><type>STR_REPLACE</type><params>last_1_min=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>conn_in</name><type>DEPENDENT</type><key>conn_in</key><delay>0</delay><applications><application><name>gauges</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/gauges/gauge[@name=&quot;conn_in&quot;]/@current</params></step><step><type>STR_REPLACE</type><params>current=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>conn_out</name><type>DEPENDENT</type><key>conn_out</key><delay>0</delay><applications><application><name>gauges</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/gauges/gauge[@name=&quot;conn_out&quot;]/@current</params></step><step><type>STR_REPLACE</type><params>current=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>deleted_recips  lifetime</name><type>DEPENDENT</type><key>deleted_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;deleted_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>delivered_recips  lifetime</name><type>DEPENDENT</type><key>delivered_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;delivered_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>delivered_recips per 1m</name><type>DEPENDENT</type><key>delivered_recips_last_1_min</key><delay>0</delay><applications><application><name>rates</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/rates/rate[@name=&quot;delivered_recips&quot;]/@last_1_min</params></step><step><type>STR_REPLACE</type><params>last_1_min=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>dns_hard_bounced_recips  lifetime</name><type>DEPENDENT</type><key>dns_hard_bounced_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;dns_hard_bounced_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>dropped_msgs  lifetime</name><type>DEPENDENT</type><key>dropped_msgs</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;dropped_msgs&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>expired_hard_bounced_recips  lifetime</name><type>DEPENDENT</type><key>expired_hard_bounced_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;expired_hard_bounced_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>filter_hard_bounced_recips  lifetime</name><type>DEPENDENT</type><key>filter_hard_bounced_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;filter_hard_bounced_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>gen_bounce_recips  lifetime</name><type>DEPENDENT</type><key>gen_bounce_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;gen_bounce_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>Get_Ironport_xml_status</name><type>HTTP_AGENT</type><key>Get_Ironport_xml_status</key><delay>5m</delay><history>1d</history><trends>0</trends><value_type>TEXT</value_type><authtype>BASIC</authtype><username>{$IRP_LOGIN}</username><password>{$IRP_PASS}</password><timeout>5s</timeout><url>https://{HOST.IP}/xml/status</url></item><item><name>global_unsub_hits  lifetime</name><type>DEPENDENT</type><key>global_unsub_hits</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;global_unsub_hits&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>hard_bounced_recips  lifetime</name><type>DEPENDENT</type><key>hard_bounced_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;hard_bounced_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>hard_bounced_recips per 1m</name><type>DEPENDENT</type><key>hard_bounced_recips_last_1_min</key><delay>0</delay><applications><application><name>rates</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/rates/rate[@name=&quot;hard_bounced_recips&quot;]/@last_1_min</params></step><step><type>STR_REPLACE</type><params>last_1_min=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>inj_msgs  lifetime</name><type>DEPENDENT</type><key>inj_msgs</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;inj_msgs&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>inj_msgs per 1m</name><type>DEPENDENT</type><key>inj_msgs_last_1_min</key><delay>0</delay><applications><application><name>rates</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/rates/rate[@name=&quot;inj_msgs&quot;]/@last_1_min</params></step><step><type>STR_REPLACE</type><params>last_1_min=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>inj_recips  lifetime</name><type>DEPENDENT</type><key>inj_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;inj_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>inj_recips per 1m</name><type>DEPENDENT</type><key>inj_recips_last_1_min</key><delay>0</delay><applications><application><name>rates</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/rates/rate[@name=&quot;inj_recips&quot;]/@last_1_min</params></step><step><type>STR_REPLACE</type><params>last_1_min=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>kbytes_in_policy_virus_outbreak_quarantine</name><type>DEPENDENT</type><key>kbytes_in_policy_virus_outbreak_quarantine</key><delay>0</delay><applications><application><name>gauges</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/gauges/gauge[@name=&quot;kbytes_in_policy_virus_outbreak_quarantine&quot;]/@current</params></step><step><type>STR_REPLACE</type><params>current=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>msgs_in_policy_virus_outbreak_quarantine</name><type>DEPENDENT</type><key>msgs_in_policy_virus_outbreak_quarantine</key><delay>0</delay><applications><application><name>gauges</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/gauges/gauge[@name=&quot;msgs_in_policy_virus_outbreak_quarantine&quot;]/@current</params></step><step><type>STR_REPLACE</type><params>current=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>other_hard_bounced_recips  lifetime</name><type>DEPENDENT</type><key>other_hard_bounced_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;other_hard_bounced_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>rejected_recips  lifetime</name><type>DEPENDENT</type><key>rejected_recips</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;rejected_recips&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>soft_bounced_evts  lifetime</name><type>DEPENDENT</type><key>soft_bounced_evts</key><delay>0</delay><history>7d</history><applications><application><name>counters</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/counters/counter[@name=&quot;soft_bounced_evts&quot;]/@lifetime</params></step><step><type>STR_REPLACE</type><params>lifetime=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item><item><name>soft_bounced_evts per 1m</name><type>DEPENDENT</type><key>soft_bounced_evts_last_1_min</key><delay>0</delay><applications><application><name>rates</name></application></applications><preprocessing><step><type>XMLPATH</type><params>/status/rates/rate[@name=&quot;soft_bounced_evts&quot;]/@last_1_min</params></step><step><type>STR_REPLACE</type><params>last_1_min=&quot;
</params></step><step><type>RTRIM</type><params>&quot;</params></step></preprocessing><master_item><key>Get_Ironport_xml_status</key></master_item></item></items></template></templates><graphs><graph><name>active_recips</name><graph_items><graph_item><sortorder>1</sortorder><color>1A7C11</color><item><host>ESA-CISCO XML Status</host><key>active_recips</key></item></graph_item></graph_items></graph><graph><name>conn_in</name><graph_items><graph_item><sortorder>1</sortorder><color>1A7C11</color><item><host>ESA-CISCO XML Status</host><key>conn_in</key></item></graph_item></graph_items></graph><graph><name>conn_out</name><graph_items><graph_item><sortorder>1</sortorder><color>1A7C11</color><item><host>ESA-CISCO XML Status</host><key>conn_out</key></item></graph_item></graph_items></graph><graph><name>delivered_recips per 1m</name><graph_items><graph_item><sortorder>1</sortorder><color>1A7C11</color><item><host>ESA-CISCO XML Status</host><key>delivered_recips_last_1_min</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
