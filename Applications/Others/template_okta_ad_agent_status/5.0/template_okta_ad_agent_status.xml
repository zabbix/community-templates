<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:57:30Z</date><groups><group><name>OKTA AD Agents</name></group></groups><templates><template><template>OKTA AD Agent Healthcheck</template><name>OKTA AD Agent Healthcheck</name><description>## Overview

Easy to use, just add the template in and link it



## Author

Bilal Habib

</description><groups><group><name>OKTA AD Agents</name></group></groups><applications><application><name>OKTA AD Agent Status</name></application></applications><items><item><name>OKTA AD Agent</name><key>service.info[Okta Active Directory Service]</key><delay>30s</delay><description>OKTA AD Agent status is service.info[Okta Active Directory Service]</description><applications><application><name>OKTA AD Agent Status</name></application></applications><valuemap><name>Windows service state</name></valuemap><triggers><trigger><expression>{min(#3)}&lt;&gt;0</expression><name>OKTA AD Agent State Alert</name><opdata>Current state: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><manual_close>YES</manual_close></trigger></triggers></item></items><discovery_rules><discovery_rule><name>Service Discovery</name><type>ZABBIX_ACTIVE</type><key>service.discovery</key><item_prototypes><item_prototype><name>service.info[{#SERVICE.NAME},state]</name><key>service.info[service,&lt;param&gt;]</key><application_prototypes><application_prototype><name>service.info[{#SERVICE.NAME},state]</name></application_prototype></application_prototypes><valuemap><name>Windows service state</name></valuemap></item_prototype></item_prototypes></discovery_rule></discovery_rules><macros><macro><macro>{$ITEM.STATE}</macro><value>1</value><description>AD Agent Status</description></macro></macros></template></templates><graphs><graph><name>OKTA AD agent runtime</name><graph_items><graph_item><color>F63100</color><item><host>OKTA AD Agent Healthcheck</host><key>service.info[Okta Active Directory Service]</key></item></graph_item></graph_items></graph></graphs><value_maps><value_map><name>Windows service state</name><mappings><mapping><value>0</value><newvalue>Running</newvalue></mapping><mapping><value>1</value><newvalue>Paused</newvalue></mapping><mapping><value>2</value><newvalue>Start pending</newvalue></mapping><mapping><value>3</value><newvalue>Pause pending</newvalue></mapping><mapping><value>4</value><newvalue>Continue pending</newvalue></mapping><mapping><value>5</value><newvalue>Stop pending</newvalue></mapping><mapping><value>6</value><newvalue>Stopped</newvalue></mapping><mapping><value>7</value><newvalue>Unknown</newvalue></mapping><mapping><value>255</value><newvalue>No such service</newvalue></mapping></mappings></value_map></value_maps></zabbix_export>
